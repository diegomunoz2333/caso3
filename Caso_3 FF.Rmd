---
title: "An√°lisis de Componentes Principales y Clusterizaci√≥n de Pa√≠ses"
subtitle: "Aplicaci√≥n de T√©cnicas de Aprendizaje No Supervisado con Datos del Banco Mundial"
author: "Barros Rayo Alejandro (2415837), Mu√±oz Portela Diego Fernando (2415620), Portilla Aguirre Johan Camilo (2422468), Aguirre Aldana Joan Sebastian (2419550)"
date: "`r format(Sys.Date(), '%d de %B de %Y')`"
output: 
  html_document:
    theme: darkly
    highlight: kate
    mathjax: "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: true
    toc_depth: 3
    number_sections: true
    code_folding: show
    df_print: paged
---

```{=html}
<style type="text/css">
/* ========== PALETA DE COLORES CYBER ========== */
:root {
  --bg-black: #000000;
  --bg-dark: #0a0e1a;
  --bg-card: #12161f;
  --bg-sidebar: #0d1117;
  --accent-cyan: #00e5ff;
  --accent-blue: #0084ff;
  --accent-purple: #a259ff;
  --text-white: #ffffff;
  --text-light: #e0e6ed;
  --text-gray: #8b92a0;
  --border-glow: rgba(0, 229, 255, 0.4);
  --sidebar-width: 280px;
  --right-toc-width: 240px;
}

/* ========== RESET ========== */
* {
  box-sizing: border-box !important;
  margin: 0;
  padding: 0;
}

html, body {
  background: var(--bg-black) !important;
  color: var(--text-light) !important;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
  line-height: 1.7 !important;
  overflow-x: hidden !important;
  height: 100% !important;
}

/* ========== ESTRUCTURA PRINCIPAL - SIN HUECOS ========== */
.main-container {
  max-width: 100% !important;
  margin: 0 !important;
  padding: 0 !important;
  padding-left: var(--sidebar-width) !important;
  padding-right: var(--right-toc-width) !important;
  background: var(--bg-black) !important;
  min-height: 100vh !important;
}

/* ========== TOC IZQUIERDO - SIN FONDO GRIS ========== */
#TOC {
  background: transparent !important;
  border-right: 1px solid rgba(0, 229, 255, 0.15) !important;
  padding: 30px 20px 100px 20px !important;
  position: fixed !important;
  left: 0 !important;
  top: 0 !important;
  width: var(--sidebar-width) !important;
  height: 100vh !important;
  overflow-y: auto !important;
  overflow-x: hidden !important;
  z-index: 1000 !important;
  box-shadow: 2px 0 20px rgba(0, 0, 0, 0.5) !important;
}

#TOC::-webkit-scrollbar {
  width: 6px !important;
}

#TOC::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.3) !important;
}

#TOC::-webkit-scrollbar-thumb {
  background: var(--accent-cyan) !important;
  border-radius: 3px !important;
  box-shadow: 0 0 10px rgba(0, 229, 255, 0.5) !important;
}

#TOC::before {
  content: " CONTENIDO" !important;
  display: block !important;
  font-size: 1.1em !important;
  font-weight: 700 !important;
  color: var(--accent-cyan) !important;
  text-transform: uppercase !important;
  letter-spacing: 2px !important;
  padding-bottom: 15px !important;
  margin-bottom: 25px !important;
  border-bottom: 2px solid rgba(0, 229, 255, 0.3) !important;
  text-align: center !important;
  text-shadow: 0 0 15px rgba(0, 229, 255, 0.5) !important;
}

/* ========== ENLACES TOC IZQUIERDO - SIN CUADROS GRISES ========== */
#TOC ul {
  list-style: none !important;
  padding: 0 !important;
  margin: 0 !important;
}

#TOC li {
  margin: 4px 0 !important;
  background: transparent !important;
}

#TOC a {
  color: var(--text-gray) !important;
  text-decoration: none !important;
  font-size: 0.9em !important;
  display: block !important;
  padding: 10px 15px !important;
  border-left: 3px solid transparent !important;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
  background: transparent !important;
  border-radius: 0 !important;
  position: relative !important;
}

/* HOVER - Visible y atractivo */
#TOC a:hover {
  color: var(--accent-cyan) !important;
  border-left: 3px solid var(--accent-cyan) !important;
  background: rgba(0, 229, 255, 0.08) !important;
  padding-left: 20px !important;
  box-shadow: inset 0 0 15px rgba(0, 229, 255, 0.1) !important;
  transform: translateX(3px) !important;
}

/* ACTIVE - Link en secci√≥n actual */
#TOC a.active {
  color: var(--accent-cyan) !important;
  background: rgba(0, 229, 255, 0.12) !important;
  border-left: 4px solid var(--accent-cyan) !important;
  font-weight: 700 !important;
  box-shadow: 
    inset 0 0 20px rgba(0, 229, 255, 0.15),
    0 0 20px rgba(0, 229, 255, 0.2) !important;
  padding-left: 18px !important;
}

/* Efecto glow en active */
#TOC a.active::before {
  content: '' !important;
  position: absolute !important;
  left: 0 !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  width: 4px !important;
  height: 60% !important;
  background: linear-gradient(180deg, 
    transparent, 
    var(--accent-cyan), 
    transparent) !important;
  border-radius: 2px !important;
  box-shadow: 0 0 10px var(--accent-cyan) !important;
}

#TOC ul ul a {
  font-size: 0.85em !important;
  padding: 8px 12px !important;
}

#TOC ul ul a:hover {
  background: rgba(0, 229, 255, 0.06) !important;
  color: var(--accent-cyan) !important;
}

#TOC ul ul a.active {
  color: var(--accent-cyan) !important;
  background: rgba(0, 229, 255, 0.1) !important;
}

#TOC .toc-section-number {
  color: var(--accent-cyan) !important;
  font-weight: 700 !important;
  margin-right: 8px !important;
  display: inline-block !important;
  min-width: 25px !important;
}

#TOC ul ul {
  padding-left: 20px !important;
  margin-top: 6px !important;
  border-left: 1px solid rgba(0, 229, 255, 0.1) !important;
  margin-left: 15px !important;
}

#TOC ul ul a {
  font-size: 0.85em !important;
  padding: 8px 12px !important;
}

/* ========== BOT√ìN CONTROL DE C√ìDIGO - LADO DERECHO ========== */
#global-code-toggle {
  position: fixed !important;
  bottom: 30px !important;
  right: calc(var(--right-toc-width) + 30px) !important;
  z-index: 10000 !important;
  background: linear-gradient(135deg, var(--accent-cyan), var(--accent-blue)) !important;
  color: var(--bg-black) !important;
  border: none !important;
  padding: 14px 28px !important;
  border-radius: 50px !important;
  font-weight: 700 !important;
  font-size: 0.9em !important;
  cursor: pointer !important;
  box-shadow: 0 6px 25px rgba(0, 229, 255, 0.5) !important;
  transition: all 0.3s ease !important;
  text-transform: uppercase !important;
  letter-spacing: 1px !important;
}

#global-code-toggle:hover {
  transform: translateY(-3px) !important;
  box-shadow: 0 8px 35px rgba(0, 229, 255, 0.7) !important;
}

/* ========== MINI-TOC DERECHO ========== */
#right-toc {
  position: fixed !important;
  right: 0 !important;
  top: 0 !important;
  width: var(--right-toc-width) !important;
  height: 100vh !important;
  background: transparent !important;
  border-left: 1px solid rgba(162, 89, 255, 0.15) !important;
  padding: 30px 20px !important;
  overflow-y: auto !important;
  z-index: 999 !important;
  box-shadow: -2px 0 20px rgba(0, 0, 0, 0.5) !important;
}

#right-toc::-webkit-scrollbar {
  width: 4px !important;
}

#right-toc::-webkit-scrollbar-thumb {
  background: var(--accent-purple) !important;
  border-radius: 2px !important;
}

#right-toc-title {
  font-size: 0.8em !important;
  font-weight: 700 !important;
  color: var(--accent-purple) !important;
  text-transform: uppercase !important;
  letter-spacing: 1.5px !important;
  margin-bottom: 15px !important;
  padding-bottom: 10px !important;
  border-bottom: 1px solid rgba(162, 89, 255, 0.3) !important;
  text-shadow: 0 0 10px rgba(162, 89, 255, 0.5) !important;
}

#right-toc-list {
  list-style: none !important;
  padding: 0 !important;
}

#right-toc-list li {
  margin: 6px 0 !important;
}

#right-toc-list a {
  color: var(--text-gray) !important;
  text-decoration: none !important;
  font-size: 0.8em !important;
  display: block !important;
  padding: 6px 10px !important;
  border-left: 2px solid transparent !important;
  transition: all 0.2s ease !important;
  border-radius: 0 4px 4px 0 !important;
}

#right-toc-list a {
  color: var(--text-gray) !important;
  text-decoration: none !important;
  font-size: 0.8em !important;
  display: block !important;
  padding: 8px 12px !important;
  border-left: 2px solid transparent !important;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
  border-radius: 0 4px 4px 0 !important;
  position: relative !important;
}

#right-toc-list a:hover {
  color: var(--accent-purple) !important;
  border-left: 2px solid var(--accent-purple) !important;
  padding-left: 15px !important;
  background: rgba(162, 89, 255, 0.1) !important;
  box-shadow: inset 0 0 12px rgba(162, 89, 255, 0.1) !important;
  transform: translateX(2px) !important;
}

#right-toc-list a.active-section {
  color: var(--accent-purple) !important;
  border-left: 3px solid var(--accent-purple) !important;
  padding-left: 14px !important;
  background: rgba(162, 89, 255, 0.18) !important;
  font-weight: 600 !important;
  box-shadow: 
    inset 0 0 15px rgba(162, 89, 255, 0.2),
    0 0 15px rgba(162, 89, 255, 0.15) !important;
}

#right-toc-list a.active-section::after {
  content: '' !important;
  position: absolute !important;
  left: -2px !important;
  top: 0 !important;
  bottom: 0 !important;
  width: 3px !important;
  background: linear-gradient(180deg,
    transparent,
    var(--accent-purple),
    transparent) !important;
  border-radius: 2px !important;
  box-shadow: 0 0 8px var(--accent-purple) !important;
}

/* ========== CONTENIDO CENTRAL - SIN HUECOS ========== */
.toc-content {
  width: 100% !important;
  max-width: 100% !important;
  margin: 0 !important;
  padding: 40px 60px !important;
  background: var(--bg-black) !important;
  min-height: 100vh !important;
}

/* ========== SECCIONES ========== */
.section.level1 {
  background: var(--bg-card) !important;
  border: 1px solid rgba(0, 229, 255, 0.15) !important;
  border-radius: 12px !important;
  padding: 35px !important;
  margin-bottom: 25px !important;
  box-shadow: 0 8px 40px rgba(0, 0, 0, 0.6) !important;
}

/* ========== T√çTULOS ========== */
h1 {
  color: var(--text-white) !important;
  font-size: 2.3em !important;
  font-weight: 700 !important;
  text-align: center !important;
  padding: 20px 0 !important;
  margin-bottom: 30px !important;
  background: linear-gradient(135deg, var(--accent-cyan), var(--accent-blue)) !important;
  -webkit-background-clip: text !important;
  -webkit-text-fill-color: transparent !important;
  background-clip: text !important;
  position: relative !important;
}

h1::after {
  content: '' !important;
  position: absolute !important;
  bottom: 10px !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  width: 150px !important;
  height: 3px !important;
  background: linear-gradient(90deg, transparent, var(--accent-cyan), transparent) !important;
  box-shadow: 0 0 15px rgba(0, 229, 255, 0.8) !important;
}

h2 {
  color: var(--accent-cyan) !important;
  font-size: 1.8em !important;
  font-weight: 700 !important;
  padding: 15px 20px !important;
  margin-top: 35px !important;
  margin-bottom: 20px !important;
  border-left: 5px solid var(--accent-cyan) !important;
  background: linear-gradient(90deg, rgba(0, 229, 255, 0.1) 0%, transparent 100%) !important;
  border-radius: 0 8px 8px 0 !important;
  text-shadow: 0 0 20px rgba(0, 229, 255, 0.3) !important;
}

h3 {
  color: var(--text-white) !important;
  font-size: 1.5em !important;
  font-weight: 600 !important;
  padding-left: 15px !important;
  margin-top: 25px !important;
  margin-bottom: 15px !important;
  border-left: 4px solid var(--accent-purple) !important;
}

h4 {
  color: var(--text-light) !important;
  font-size: 1.2em !important;
  font-weight: 600 !important;
  margin-top: 20px !important;
  margin-bottom: 12px !important;
  padding-left: 12px !important;
  border-left: 3px solid var(--text-gray) !important;
}

/* ========== CHUNKS DE C√ìDIGO ========== */
.code-chunk {
  margin: 30px 0 !important;
  border: 1px solid rgba(0, 229, 255, 0.2) !important;
  border-radius: 10px !important;
  overflow: hidden !important;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5) !important;
}

.code-header {
  background: linear-gradient(90deg, rgba(0, 229, 255, 0.15), rgba(0, 132, 255, 0.15)) !important;
  color: var(--accent-cyan) !important;
  padding: 12px 20px !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  cursor: pointer !important;
  border-bottom: 1px solid rgba(0, 229, 255, 0.2) !important;
}

.code-header:hover {
  background: linear-gradient(90deg, rgba(0, 229, 255, 0.25), rgba(0, 132, 255, 0.25)) !important;
}

.chunk-title {
  font-weight: 600 !important;
  font-size: 0.95em !important;
}

.toggle-icon {
  font-size: 1.1em !important;
  transition: transform 0.3s ease !important;
}

.toggle-icon.rotated {
  transform: rotate(180deg) !important;
}

.code-content {
  background: var(--bg-dark) !important;
  transition: all 0.3s ease !important;
  overflow: hidden !important;
}

.code-content.collapsed {
  max-height: 0 !important;
  opacity: 0 !important;
}

.code-content.expanded {
  max-height: 5000px !important;
  opacity: 1 !important;
}

.code-content pre {
  margin: 0 !important;
  border: none !important;
  border-radius: 0 !important;
}

/* ========== TABLAS ========== */
table {
  width: 100% !important;
  border-collapse: collapse !important;
  margin: 25px 0 !important;
  background: var(--bg-dark) !important;
  border-radius: 10px !important;
  overflow: hidden !important;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.8) !important;
}

thead {
  background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-cyan) 100%) !important;
}

th {
  color: var(--bg-black) !important;
  padding: 16px 20px !important;
  text-align: left !important;
  font-weight: 700 !important;
  text-transform: uppercase !important;
  letter-spacing: 0.5px !important;
  font-size: 0.9em !important;
}

td {
  padding: 14px 20px !important;
  color: var(--text-light) !important;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05) !important;
}

tr:hover td {
  background: rgba(0, 229, 255, 0.05) !important;
}

/* ========== C√ìDIGO ========== */
pre {
  background: var(--bg-dark) !important;
  border: 1px solid rgba(0, 229, 255, 0.2) !important;
  border-left: 4px solid var(--accent-cyan) !important;
  border-radius: 8px !important;
  padding: 20px !important;
  margin: 25px 0 !important;
  overflow-x: auto !important;
  box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5) !important;
}

code {
  color: var(--accent-cyan) !important;
  background: rgba(0, 229, 255, 0.08) !important;
  padding: 3px 8px !important;
  border-radius: 4px !important;
  font-family: 'Fira Code', 'Consolas', monospace !important;
  font-size: 0.88em !important;
}

pre code {
  background: transparent !important;
  padding: 0 !important;
  color: var(--text-light) !important;
}

/* ========== GR√ÅFICOS ========== */
.figure {
  text-align: center !important;
  margin: 30px 0 !important;
  padding: 25px !important;
  background: var(--bg-card) !important;
  border: 1px solid rgba(0, 229, 255, 0.2) !important;
  border-radius: 10px !important;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5) !important;
}

/* ========== RESPONSIVE ========== */
@media (max-width: 1400px) {
  .main-container {
    padding-right: 0 !important;
  }
  
  #right-toc {
    display: none !important;
  }
  
  #global-code-toggle {
    right: 30px !important;
  }
}

@media (max-width: 1024px) {
  .main-container {
    padding-left: 0 !important;
  }
  
  #TOC {
    position: relative !important;
    width: 100% !important;
    height: auto !important;
    padding: 30px 20px !important;
  }
  
  .toc-content {
    padding: 20px !important;
  }
  
  #global-code-toggle {
    position: relative !important;
    right: 0 !important;
    margin: 20px auto !important;
    display: block !important;
    width: 80% !important;
  }
}

/* ========== SCROLL SUAVE ========== */
html {
  scroll-behavior: smooth !important;
}

/* ========== FOOTER ========== */
.footer {
  text-align: center !important;
  padding: 40px !important;
  margin-top: 60px !important;
  border-top: 2px solid rgba(0, 229, 255, 0.3) !important;
  color: var(--text-gray) !important;
  background: var(--bg-dark) !important;
}
</style>
```

<!-- Mini TOC Derecho -->

:::: {#right-toc}
::: {#right-toc-title}
EN ESTA SECCI√ìN
:::

<ul id="right-toc-list">

</ul>
::::

<!-- Bot√≥n Control de C√≥digo -->

<button id="global-code-toggle">

C√≥digo

</button>

```{=html}
<script>
document.addEventListener('DOMContentLoaded', function() {
  // ========== CONTROL DE C√ìDIGO ==========
  let allCodeVisible = true;
  const toggleButton = document.getElementById('global-code-toggle');
  
  function initializeCodeToggles() {
    const codeChunks = document.querySelectorAll('pre.r, pre.python, div.sourceCode');
    
    codeChunks.forEach((chunk, index) => {
      if (chunk.closest('.code-chunk')) return;
      
      const container = document.createElement('div');
      container.className = 'code-chunk';
      
      const header = document.createElement('div');
      header.className = 'code-header';
      header.innerHTML = `
        <div class="chunk-title">üíª C√≥digo - Chunk ${index + 1}</div>
        <div class="toggle-icon">‚ñº</div>
      `;
      
      const content = document.createElement('div');
      content.className = 'code-content expanded';
      content.appendChild(chunk.cloneNode(true));
      
      chunk.parentNode.replaceChild(container, chunk);
      container.appendChild(header);
      container.appendChild(content);
      
      header.addEventListener('click', function() {
        const isExpanded = content.classList.contains('expanded');
        const icon = this.querySelector('.toggle-icon');
        
        if (isExpanded) {
          content.classList.remove('expanded');
          content.classList.add('collapsed');
          icon.classList.add('rotated');
        } else {
          content.classList.remove('collapsed');
          content.classList.add('expanded');
          icon.classList.remove('rotated');
        }
      });
    });
  }
  
  function toggleAllCode() {
    const codeContents = document.querySelectorAll('.code-content');
    const icons = document.querySelectorAll('.toggle-icon');
    
    if (allCodeVisible) {
      codeContents.forEach(content => {
        content.classList.remove('expanded');
        content.classList.add('collapsed');
      });
      icons.forEach(icon => icon.classList.add('rotated'));
      toggleButton.innerHTML = '‚ö° Mostrar';
      allCodeVisible = false;
    } else {
      codeContents.forEach(content => {
        content.classList.remove('collapsed');
        content.classList.add('expanded');
      });
      icons.forEach(icon => icon.classList.remove('rotated'));
      toggleButton.innerHTML = '‚ö° Ocultar';
      allCodeVisible = true;
    }
  }
  
  setTimeout(initializeCodeToggles, 100);
  if (toggleButton) {
    toggleButton.addEventListener('click', toggleAllCode);
  }
  
  // ========== FUNCIONES MEJORADAS PARA TOC ==========
  
  // Obtener secci√≥n actual con mejor detecci√≥n
  function getCurrentSection() {
    const sections = document.querySelectorAll('.section.level1');
    const scrollPos = window.pageYOffset || document.documentElement.scrollTop;
    const windowHeight = window.innerHeight;
    
    let currentSection = null;
    let minDistance = Infinity;
    
    sections.forEach(section => {
      const rect = section.getBoundingClientRect();
      
      if (rect.top <= windowHeight / 3 && rect.bottom > 0) {
        const distance = Math.abs(rect.top);
        if (distance < minDistance) {
          minDistance = distance;
          currentSection = section;
        }
      }
    });
    
    if (!currentSection) {
      sections.forEach(section => {
        const rect = section.getBoundingClientRect();
        if (rect.top < 0 && rect.bottom > -100) {
          currentSection = section;
        }
      });
    }
    
    if (!currentSection && sections.length > 0) {
      for (let section of sections) {
        const rect = section.getBoundingClientRect();
        if (rect.bottom > 0) {
          currentSection = section;
          break;
        }
      }
    }
    
    return currentSection;
  }
  
  // Actualizar TOC derecho con la secci√≥n actual
  function updateRightToc() {
    const rightTocList = document.getElementById('right-toc-list');
    if (!rightTocList) return;
    
    const activeSection = getCurrentSection();
    
    if (!activeSection) {
      rightTocList.innerHTML = '<li style="color: var(--text-gray); font-style: italic; padding: 10px;">Despl√°zate para ver contenido</li>';
      return;
    }
    
    const headings = activeSection.querySelectorAll('h2, h3, h4');
    rightTocList.innerHTML = '';
    
    if (headings.length === 0) {
      rightTocList.innerHTML = '<li style="color: var(--text-gray); font-style: italic; padding: 10px;">Sin subt√≠tulos en esta secci√≥n</li>';
      return;
    }
    
    headings.forEach((heading, index) => {
      const li = document.createElement('li');
      const a = document.createElement('a');
      
      if (!heading.id) {
        heading.id = 'sub-heading-' + index + '-' + Date.now();
      }
      
      a.href = '#' + heading.id;
      
      let textContent = heading.textContent || heading.innerText;
      textContent = textContent.replace(/^\d+(\.\d+)*\s*/, '').trim();
      
      a.textContent = textContent;
      
      if (heading.tagName === 'H3') {
        a.style.paddingLeft = '20px';
        a.style.fontSize = '0.75em';
      } else if (heading.tagName === 'H4') {
        a.style.paddingLeft = '30px';
        a.style.fontSize = '0.7em';
      }
      
      li.appendChild(a);
      rightTocList.appendChild(li);
      
      // ‚úÖ MEJORADO: Event listener con scroll correcto
      a.addEventListener('click', function(e) {
        e.preventDefault();
        const targetElement = document.getElementById(heading.id);
        if (targetElement) {
          const offsetTop = targetElement.getBoundingClientRect().top + window.pageYOffset - 100;
          window.scrollTo({ 
            top: offsetTop, 
            behavior: 'smooth' 
          });
          
          setTimeout(() => {
            highlightActiveRightToc();
          }, 500);
        }
      });
    });
    
    highlightActiveRightToc();
  }
  
  // ‚úÖ MEJORADO: Resaltar subt√≠tulo activo en TOC derecho
  function highlightActiveRightToc() {
    const activeSection = getCurrentSection();
    if (!activeSection) return;
    
    const headings = Array.from(activeSection.querySelectorAll('h2, h3, h4'));
    const rightTocLinks = document.querySelectorAll('#right-toc-list a');
    
    if (headings.length === 0 || rightTocLinks.length === 0) return;
    
    let activeIndex = -1;
    let minDistance = Infinity;
    const threshold = 150;
    
    headings.forEach((heading, index) => {
      const rect = heading.getBoundingClientRect();
      const distance = Math.abs(rect.top);
      
      if (rect.top <= threshold && distance < minDistance) {
        minDistance = distance;
        activeIndex = index;
      }
    });
    
    // Si no encontramos ninguno en el threshold, tomar el primero visible
    if (activeIndex === -1) {
      headings.forEach((heading, index) => {
        const rect = heading.getBoundingClientRect();
        if (rect.top > 0 && rect.top < window.innerHeight) {
          if (activeIndex === -1) activeIndex = index;
        }
      });
    }
    
    rightTocLinks.forEach((link, index) => {
      if (index === activeIndex) {
        link.classList.add('active-section');
      } else {
        link.classList.remove('active-section');
      }
    });
  }
  
  // ‚úÖ MEJORADO: Resaltar secci√≥n activa en TOC izquierdo CON AUTO-SCROLL
  function highlightActiveTocSection() {
    const sections = document.querySelectorAll('.section.level1');
    const tocContainer = document.getElementById('TOC');
    
    if (!tocContainer) return;
    
    const tocLinks = tocContainer.querySelectorAll('a[href^="#"]');
    const activeSection = getCurrentSection();
    
    if (!activeSection) return;
    
    const activeId = activeSection.id;
    let activeLinkElement = null;
    
    tocLinks.forEach(link => {
      link.classList.remove('active');
      
      const href = link.getAttribute('href');
      if (href) {
        const linkId = href.replace('#', '');
        if (linkId === activeId) {
          link.classList.add('active');
          activeLinkElement = link;
        }
      }
    });
    
    if (activeLinkElement && tocContainer) {
      requestAnimationFrame(() => {
        const linkTop = activeLinkElement.offsetTop;
        const tocScrollTop = tocContainer.scrollTop;
        const tocHeight = tocContainer.clientHeight;
        
        const headerHeight = 100;
        const linkRelativeTop = linkTop - tocScrollTop;
        
        const visibleTop = headerHeight;
        const visibleBottom = tocHeight - 50;
        
        if (linkRelativeTop < visibleTop) {
          tocContainer.scrollTo({
            top: linkTop - headerHeight - 20,
            behavior: 'smooth'
          });
        } else if (linkRelativeTop > visibleBottom) {
          tocContainer.scrollTo({
            top: linkTop - tocHeight + 100,
            behavior: 'smooth'
          });
        }
      });
    }
  }
  
  // ========== EVENT LISTENERS ==========
  
  let scrollTimeout;
  let lastScrollTop = 0;
  
  window.addEventListener('scroll', function() {
    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
    
    if (Math.abs(scrollTop - lastScrollTop) > 10) {
      clearTimeout(scrollTimeout);
      scrollTimeout = setTimeout(function() {
        updateRightToc();
        highlightActiveTocSection();
        highlightActiveRightToc();
        lastScrollTop = scrollTop;
      }, 50);
    }
  }, { passive: true });
  
  // Inicializaci√≥n
  setTimeout(function() {
    updateRightToc();
    highlightActiveTocSection();
    highlightActiveRightToc();
  }, 600);
  
  // MEJORADO: Manejar clicks en enlaces del TOC izquierdo
  document.querySelectorAll('#TOC a').forEach(anchor => {
    anchor.addEventListener('click', function(e) {
      const targetId = this.getAttribute('href');
      if (!targetId || targetId === '#') return;
      
      e.preventDefault();
      const target = document.querySelector(targetId);
      
      if (target) {
        const offsetTop = target.getBoundingClientRect().top + window.pageYOffset - 80;
        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
        
        setTimeout(function() {
          updateRightToc();
          highlightActiveTocSection();
          highlightActiveRightToc();
        }, 500);
      }
    });
  });
  
  // Observer para detectar cambios en el DOM
  const observer = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
      if (mutation.addedNodes.length) {
        setTimeout(function() {
          updateRightToc();
          highlightActiveTocSection();
          highlightActiveRightToc();
        }, 300);
      }
    });
  });
  
  const mainContent = document.querySelector('.toc-content') || document.body;
  observer.observe(mainContent, {
    childList: true,
    subtree: true
  });
});
</script>
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  message = FALSE,
  fig.align = 'center',
  fig.width = 10,
  fig.height = 6
)
library(ggtext)
library(tidyverse)
library(ggplot2)
library(plotly)
library(knitr)
library(kableExtra)
library(FactoMineR)
library(cluster)
library(corrplot)
library(FactoClass)
library(ade4)
library(factoextra)
library(dendextend)
library(ggrepel)
library(readr)
library(dplyr)
library(ggforce)
library(htmlwidgets)
library(DT)
library(leaflet)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)
library(htmltools)
library(gt)
library(dendextend)
library(RColorBrewer)  
library(ellipse)
library(leaflet)
library(ade4)
library(ggdendro)
library(stringr)

cyber_palette <- c(
  primary = "#00e5ff",
  secondary = "#0084ff",
  accent = "#a259ff",
  warning = "#ff1744",
  success = "#00e676",
  gold = "#ffd600"
)

theme_cyber <- function() {
  theme_minimal(base_size = 12) +
    theme(
      plot.background = element_rect(fill = "#000000", color = NA),
      panel.background = element_rect(fill = "#0a0e1a", color = NA),
      panel.grid.major = element_line(color = "#12161f", size = 0.5),
      panel.grid.minor = element_line(color = "#12161f", size = 0.25),
      text = element_text(color = "#e0e6ed", family = "sans", size = 12),
      axis.text = element_text(color = "#8b92a0", size = 10),
      axis.title = element_text(color = "#e0e6ed", face = "bold", size = 13),
      axis.line = element_line(color = "#00e5ff", size = 0.5),
      plot.title = element_text(
        color = "#00e5ff", 
        face = "bold", 
        size = 18, 
        hjust = 0.5,
        margin = margin(b = 10)
      ),
      plot.subtitle = element_text(
        color = "#8b92a0", 
        size = 13, 
        hjust = 0.5,
        margin = margin(b = 15)
      ),
      legend.background = element_rect(fill = "#12161f", color = "#00e5ff", size = 0.5),
      legend.key = element_rect(fill = "#12161f", color = NA),
      legend.text = element_text(color = "#e0e6ed", size = 10),
      legend.title = element_text(color = "#00e5ff", face = "bold", size = 11),
      legend.position = "right",
      strip.background = element_rect(fill = "#12161f", color = "#00e5ff"),
      strip.text = element_text(color = "#00e5ff", face = "bold", size = 11),
      panel.border = element_rect(color = "#00e5ff", fill = NA, size = 0.5),
      plot.margin = margin(20, 20, 20, 20)
    )
}

theme_set(theme_cyber())

tabla_cyber <- function(data, caption = "", col_names = NULL) {
  if (is.null(col_names)) {
    col_names <- names(data)
  }
  
  data %>%
    kbl(
      caption = caption,
      col.names = col_names,
      align = "c"
    ) %>%
    kable_styling(
      bootstrap_options = c("striped", "hover", "condensed"),
      full_width = FALSE,
      font_size = 14,
      position = "center"
    ) %>%
    row_spec(0, background = "#0084ff", color = "black", bold = TRUE) %>%
    row_spec(1:nrow(data), background = "#0a0e1a", color = "#e0e6ed")
}

scale_fill_cyber <- function(...) {
  scale_fill_manual(values = cyber_palette, ...)
}

scale_color_cyber <- function(...) {
  scale_color_manual(values = cyber_palette, ...)
}
```

# Introducci√≥n

En el coraz√≥n de la econom√≠a global existe una paradoja fundamental: mientras que algunos indicadores sugieren una relaci√≥n lineal y predecible entre el desarrollo econ√≥mico y el bienestar social, la realidad es mucho m√°s compleja y matizada. Tomemos un ejemplo: Costa Rica tiene una esperanza de vida comparable a la de pa√≠ses europeos desarrollados, pero con un PIB per c√°pita significativamente menor; Qatar, por su parte, lidera en PIB per c√°pita pero no encabeza necesariamente en todos los indicadores de bienestar social (Shkolnikov et al., 2019). Estas "anomal√≠as" no son excepciones sino revelaciones de una verdad fundamental: el desarrollo no es unidimensional.

El problema central que motiva este trabajo es fundamental: ¬øCu√°les son realmente los "tipos" de desarrollo que caracterizan la econom√≠a mundial cuando se analiza simult√°neamente un conjunto amplio de 17 indicadores econ√≥micos, sociales, tecnol√≥gicos y ambientales? No se trata de responder cu√°l pa√≠s es m√°s "rico", sino algo m√°s profundo: descubrir si existen estructuras ocultas en los datos que agrupen pa√≠ses con perfiles similares m√°s all√° de la geograf√≠a o las clasificaciones convencionales. Espec√≠ficamente, la pregunta es: ¬øColombia y Uruguay podr√≠an compartir m√°s similitudes con algunos pa√≠ses asi√°ticos que con sus propios vecinos latinoamericanos? ¬øExiste realmente un "grupo de pa√≠ses con baja renta pero alto acceso tecnol√≥gico"? ¬øLas caracter√≠sticas ambientales y demogr√°ficas se alinean con la riqueza econ√≥mica o presentan patrones independientes?

Hist√≥ricamente, el desarrollo internacional se ha medido mediante indicadores aislados. El PIB per c√°pita domina los rankings; la esperanza de vida se analiza independientemente; la conectividad digital se observa separadamente. Este enfoque fragmentado es problem√°tico porque el desarrollo no es unidimensional: un pa√≠s puede ser econ√≥micamente exitoso pero fr√°gil en salud p√∫blica, o tener excelente conectividad digital pero vulnerabilidad ambiental cr√≠tica (Jolliffe, 2002; World Bank, 2023). Los datos del a√±o 2022 capturan un momento √∫nico en la historia econ√≥mica global: post-pandemia de COVID-19, con efectos heterog√©neos seg√∫n pa√≠s. Algunos recuperaron r√°pidamente su dinamismo; otros enfrentaron cicatrices estructurales persistentes en empleo, salud y finanzas p√∫blicas (World Bank, 2023).

El Banco Mundial proporciona 17 indicadores reconocidos internacionalmente que miden dimensiones distintas: factores econ√≥micos (PIB per c√°pita, crecimiento del PIB, inversi√≥n extranjera, remesas, industria, comercio), indicadores de salud y bienestar (esperanza de vida, mortalidad infantil, gasto en salud), variables de conectividad tecnol√≥gica (acceso a electricidad, uso de internet, suscripciones m√≥viles) y aspectos ambientales y demogr√°ficos (√°rea boscosa, tierra cultivable, crecimiento poblacional) (World Bank, 2023). Analizar estas 17 variables de forma independiente genera ruido; analizarlas de manera integrada puede revelar patrones coherentes que informan pol√≠ticas p√∫blicas, estrategias de cooperaci√≥n internacional y decisiones de inversi√≥n.

El desaf√≠o es modelar una pregunta sin respuesta predefinida: ¬øQu√© agrupamientos naturales de pa√≠ses emergen cuando se analiza simult√°neamente esta multiplicidad de indicadores? Este es precisamente el rol del aprendizaje no supervisado‚Äîun conjunto de t√©cnicas que descubren patrones en datos sin etiquetas previas, sin clasificaciones arbitrarias impuestas externamente (Charrad et al., 2014; Jolliffe, 2002).

Lo que sigue es una cartograf√≠a multidimensional de la econom√≠a global en el contexto post-pandemia: no solo se responde "¬øen qu√© grupos se dividen los pa√≠ses?", sino, m√°s profundamente, "¬øqu√© revelan estos grupos sobre mecanismos reales del desarrollo, oportunidades compartidas, restricciones comunes y trayectorias viables para diferentes sociedades?" Los resultados no ser√°n una clasificaci√≥n administrativa sino un descubrimiento emp√≠rico basado en lo que los datos de 180 pa√≠ses en 2022 efectivamente revelan.

------------------------------------------------------------------------

# Metodolog√≠a

## Base de datos

La base de datos utilizada en este an√°lisis proviene de la compilaci√≥n World Development Indicators (WDI) del Banco Mundial, considerada la principal fuente internacional de estad√≠sticas comparables sobre desarrollo econ√≥mico y social (World Bank, 2023). Los WDI representan el esfuerzo m√°s comprehensivo del Banco Mundial para consolidar indicadores de desarrollo de fuentes oficialmente reconocidas, incluyendo oficinas nacionales de estad√≠stica, bancos centrales, agencias de las Naciones Unidas, instituciones de investigaci√≥n y contribuyentes del sector privado (World Bank, 2023; Jeanty, 2010).

La base WDI contiene aproximadamente 1,600 indicadores de series temporales para 217 econom√≠as y m√°s de 40 grupos de pa√≠ses, con datos para muchos indicadores que se remontan m√°s de 50 a√±os (World Bank, 2023). Los datos son compilados mediante metodolog√≠as estandarizadas que garantizan comparabilidad internacional, transparencia metodol√≥gica y robustez estad√≠stica (World Bank, 2019). El proceso de selecci√≥n de indicadores del WDI sigue cuatro criterios fundamentales: facilidad de uso (accesibilidad y claridad para usuarios diversos), confiabilidad (reputaci√≥n y credibilidad de la fuente), cobertura (amplitud geogr√°fica y temporal), y calidad (rigor metodol√≥gico y precisi√≥n) (Behar & Mok, 2024).

Para este an√°lisis, se filtro informaci√≥n exclusivamente para pa√≠ses individuales (eliminando bloques regionales o agrupaciones econ√≥micas) del a√±o 2022. El dataset resultante contiene aproximadamente 180-200 pa√≠ses, seg√∫n la disponibilidad de datos completos, donde cada observaci√≥n representa una unidad soberana comparable en un √∫nico punto temporal.

El a√±o 2022 marca un punto de inflexi√≥n cr√≠tico en la econom√≠a global, representa el momento post-pandemia en que las trayectorias de recuperaci√≥n de cada pa√≠s se hacen visibles y diferenciadas. Mientras algunos pa√≠ses desarrollados con capacidad fiscal recuperaron o superaron niveles pre-COVID-19, econom√≠as emergentes enfrentaban cicatrices estructurales persistentes en empleo, inflaci√≥n descontrolada, y aumento de deuda p√∫blica (Banco Mundial, 2022; FMI, 2023; CEPAL, 2023). La desigualdad global se ampli√≥ dr√°sticamente: el crecimiento proyectado para Am√©rica Latina en 2022 era apenas 2.6%, mientras la desigualdad de ingresos aument√≥ significativamente despu√©s de dos d√©cadas de mejoras (BID, 2022).

En este contexto, 2022 funciona como un "revelador" excepcional de vulnerabilidades y fortalezas estructurales subyacentes de los pa√≠ses: aquellos con sistemas de salud robustos, infraestructura tecnol√≥gica consolidada y econom√≠as diversificadas mostraron resiliencia; los que enfrentaban fragilidades estructurales experimentaron impactos persistentes (Banco Mundial, 2022; CIDOB, 2022). Por tanto, 2022 es un a√±o extraordinariamente informativo para identificar perfiles reales de desarrollo, ya que las diferencias entre pa√≠ses se magnificaron visiblemente, permitiendo observar no clasificaciones arbitrarias sino estructuras aut√©nticas de capacidad nacional.

## Descripci√≥n de las variables

El dataset construido para este an√°lisis integra 17 variables cuantitativas que capturan las m√∫ltiples dimensiones del desarrollo contempor√°neo. Estas variables se organizan en cinco √°reas tem√°ticas que, en conjunto, ofrecen una perspectiva comprehensiva del desempe√±o socioecon√≥mico, tecnol√≥gico y ambiental de cada pa√≠s. A continuaci√≥n, se presenta una descripci√≥n detallada de cada variable seg√∫n su √°rea tem√°tica.

### Dimensi√≥n economica

La inclusi√≥n de variables econ√≥micas es fundamental porque el desarrollo ha sido hist√≥ricamente conceptualizado como un proceso de transformaci√≥n estructural impulsado por el crecimiento econ√≥mico (World Bank, 2023; Piketty, 2022). Sin embargo, el crecimiento econ√≥mico no es unidimensional: requiere tanto un nivel absoluto de riqueza (PIB per c√°pita) como dinamismo y expansi√≥n (crecimiento del PIB), diversificaci√≥n productiva (industria), y capacidad de atracci√≥n de inversi√≥n internacional (IED) que transfiera conocimiento y capital (ECB, 2018). Adem√°s, las econom√≠as contempor√°neas est√°n integradas globalmente, por lo que exportaciones, importaciones y remesas son transmisores clave de oportunidades y vulnerabilidades econ√≥micas (World Bank, 2023)., en la tabla 1 las observamos.

```{r Variables economicas}
variables_economicas <- data.frame(
  Variable = c(
    "PIB per c√°pita (US$)",
    "Crecimiento del PIB (% anual)",
    "Inversi√≥n extranjera directa (% PIB)",
    "Remesas recibidas (% PIB)",
    "Industria (% PIB)",
    "Exportaciones (% PIB)",
    "Importaciones (% PIB)"
  ),
  
  Descripci√≥n = c(
    "PIB dividido por poblaci√≥n, en d√≥lares corrientes. Indicador principal del nivel de ingreso y producci√≥n econ√≥mica por persona.",
    "Tasa de variaci√≥n anual del PIB en precios constantes. Refleja la expansi√≥n o contracci√≥n econ√≥mica de un pa√≠s.",
    "Flujos netos de inversi√≥n con inter√©s gerencial duradero. Fuente crucial de financiamiento externo y transferencia tecnol√≥gica.",
    "Transferencias personales de migrantes que trabajan en el extranjero. Flujo financiero clave para muchas econom√≠as en desarrollo.",
    "Valor agregado del sector industrial. Refleja el grado de industrializaci√≥n y la estructura productiva de una econom√≠a.",
    "Valor de bienes y servicios vendidos al exterior. Mide el grado de apertura comercial y oportunidades de crecimiento.",
    "Valor de bienes y servicios comprados al exterior. Indica la dependencia de la econom√≠a respecto al comercio internacional."
  ),
  
  Interpretaci√≥n = c(
    ">20,000 USD: econom√≠a desarrollada\n5,000-20,000 USD: econom√≠a emergente\n<5,000 USD: econom√≠a en desarrollo",
    ">3%: crecimiento robusto\n0-3%: crecimiento moderado\n<0%: recesi√≥n econ√≥mica",
    ">5%: alta atracci√≥n de IED\n2-5%: nivel moderado\n<2%: baja atracci√≥n de inversi√≥n",
    ">10%: alta dependencia\n2-10%: contribuci√≥n significativa\n<2%: impacto limitado",
    ">30%: econom√≠a industrializada\n20-30%: sector industrial s√≥lido\n<20%: base industrial reducida", 
    ">50%: econom√≠a muy abierta\n30-50%: apertura moderada\n<30%: econom√≠a relativamente cerrada",
    ">40%: alta dependencia importaciones\n25-40%: nivel moderado\n<25%: autosuficiencia relativa"
  )
)

tabla_1 <- variables_economicas %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 1**"),
    subtitle = "Variables Macroecon√≥micas y su Interpretaci√≥n"
  ) %>%
  cols_label(
    Variable = md("**Variable**"),
    Descripci√≥n = md("**Descripci√≥n**"),
    Interpretaci√≥n = md("**Interpretaci√≥n**")
  ) %>%
  cols_align(
    align = "left",
    columns = everything()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium", color = "#000000"),
      cell_fill(color = "#00e5ff")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "#00e5ff",
      weight = px(2)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "#00e5ff",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Variable, Descripci√≥n))
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#0a0e1a"),
      cell_text(color = "#e0e6ed")
    ),
    locations = cells_body()
  ) %>%
  tab_style(
    style = cell_text(weight = "bold", color = "#00e5ff"),
    locations = cells_body(columns = Variable)
  ) %>%
  tab_style(
    style = cell_text(size = "small", color = "#e0e6ed"),
    locations = cells_body(columns = c(Descripci√≥n, Interpretaci√≥n))
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff", size = "large")
    ),
    locations = cells_title(groups = "title")
  ) %>%
  tab_style(
    style = list(
      cell_text(color = "#e0e6ed", size = "medium")
    ),
    locations = cells_title(groups = "subtitle")
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "solid",
    column_labels.border.top.color = "#00e5ff",
    column_labels.border.top.width = px(3),
    column_labels.border.bottom.style = "solid",
    column_labels.border.bottom.width = px(3),
    column_labels.border.bottom.color = "#00e5ff",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    table_body.hlines.style = "solid",
    table_body.hlines.color = "#00e5ff",
    table_body.hlines.width = px(1),
    table.background.color = "#0a0e1a",
    data_row.padding = px(10),
    heading.title.font.size = 18,
    heading.subtitle.font.size = 14,
    heading.padding = px(12),
    heading.border.bottom.style = "solid",
    heading.border.bottom.width = px(2),
    heading.border.bottom.color = "#00e5ff",
    footnotes.padding = px(10),
    footnotes.font.size = 13,
    source_notes.font.size = 13,
    source_notes.padding = px(10)
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboraci√≥n propia con base en World Bank (2023), UN (2015), ECB (2018)")
  ) %>%
  tab_footnote(
    footnote = "Los umbrales de interpretaci√≥n son referenciales y pueden variar seg√∫n el contexto regional y temporal",
    locations = cells_title(groups = "subtitle")
  )

tabla_1
```

### Dimension de salud y bienestar

La inclusi√≥n de variables sanitarias responde a que el desarrollo no es puramente econ√≥mico sino que debe reflejarse en mejoras sustantivas en la calidad de vida, particularmente en indicadores de salud poblacional (Sachs et al., 2022; World Bank, 2023). La esperanza de vida es considerada por organismos internacionales como el indicador sint√©tico m√°s robusto de desarrollo humano, capturando tanto el acceso a servicios de salud como condiciones generales de vida (OECD, 2024). La mortalidad infantil es particularmente sensible a la calidad del sistema sanitario, y el gasto en salud refleja el esfuerzo institucional de un pa√≠s por asegurar bienestar poblacional (World Bank, 2023)., en la tabla 2 las observamos.

```{r Variables bienestar}
variables_salud <- data.frame(
  Variable = c(
    "Esperanza de vida al nacer (a√±os)",
    "Mortalidad infantil (por cada 1,000 nacidos vivos)",
    "Gasto en salud (% del PIB)"
  ),
  
  Descripci√≥n = c(
    "N√∫mero promedio de a√±os que se espera que viva un reci√©n nacido si los patrones de mortalidad prevalecientes al momento de su nacimiento permanecen constantes a lo largo de su vida. Es uno de los indicadores m√°s robustos para medir el estado de salud poblacional, reflejando la calidad del sistema sanitario, acceso a servicios m√©dicos, condiciones de vida, nutrici√≥n y factores ambientales.",
    "N√∫mero de muertes de ni√±os menores de un a√±o por cada 1,000 nacimientos vivos. Es un indicador sensible de la calidad de atenci√≥n sanitaria materno-infantil, condiciones sanitarias, acceso a agua potable y nutrici√≥n adecuada, funcionando como proxy de desarrollo social y capacidad institucional del sistema de salud.",
    "Gasto corriente en salud expresado como porcentaje del PIB, incluyendo tanto gasto p√∫blico como privado. Refleja la prioridad presupuestaria que un pa√≠s asigna al sector salud y su capacidad de financiar infraestructura sanitaria, siendo un determinante clave de resultados de salud poblacional."
  ),
  
  Interpretaci√≥n = c(
    ">75 a√±os: salud poblacional avanzada\n70-75 a√±os: nivel medio de desarrollo sanitario\n<70 a√±os: desaf√≠os significativos en salud p√∫blica",
    "<10: excelentes condiciones sanitarias\n10-25: condiciones moderadas\n>25: necesidades cr√≠ticas en salud infantil",
    ">8%: alta prioridad en salud\n5-8%: compromiso moderado\n<5%: recursos sanitarios limitados"
  )
)

tabla_2 <- variables_salud %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 2**"),
    subtitle = "Indicadores de Salud P√∫blica y su Interpretaci√≥n"
  ) %>%
  cols_label(
    Variable = md("**Variable**"),
    Descripci√≥n = md("**Descripci√≥n**"),
    Interpretaci√≥n = md("**Interpretaci√≥n**")
  ) %>%
  cols_align(
    align = "left",
    columns = everything()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium", color = "#000000"),
      cell_fill(color = "#00e5ff")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "#00e5ff",
      weight = px(2)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "#00e5ff",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Variable, Descripci√≥n))
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#0a0e1a"),
      cell_text(color = "#e0e6ed")
    ),
    locations = cells_body()
  ) %>%
  tab_style(
    style = cell_text(weight = "bold", color = "#00e5ff"),
    locations = cells_body(columns = Variable)
  ) %>%
  tab_style(
    style = cell_text(size = "small", color = "#e0e6ed"),
    locations = cells_body(columns = c(Descripci√≥n, Interpretaci√≥n))
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff", size = "large")
    ),
    locations = cells_title(groups = "title")
  ) %>%
  tab_style(
    style = list(
      cell_text(color = "#e0e6ed", size = "medium")
    ),
    locations = cells_title(groups = "subtitle")
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "solid",
    column_labels.border.top.color = "#00e5ff",
    column_labels.border.top.width = px(3),
    column_labels.border.bottom.style = "solid",
    column_labels.border.bottom.width = px(3),
    column_labels.border.bottom.color = "#00e5ff",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    table_body.hlines.style = "solid",
    table_body.hlines.color = "#00e5ff",
    table_body.hlines.width = px(1),
    table.background.color = "#0a0e1a",
    data_row.padding = px(10),
    heading.title.font.size = 18,
    heading.subtitle.font.size = 14,
    heading.padding = px(12),
    heading.border.bottom.style = "solid",
    heading.border.bottom.width = px(2),
    heading.border.bottom.color = "#00e5ff",
    footnotes.padding = px(10),
    footnotes.font.size = 13,
    source_notes.font.size = 13,
    source_notes.padding = px(10)
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboraci√≥n propia con base en WHO (2020), OECD (2024), World Bank (2023)")
  ) %>%
  tab_footnote(
    footnote = "Los umbrales de interpretaci√≥n son referenciales y pueden variar seg√∫n el contexto regional y nivel de desarrollo",
    locations = cells_title(groups = "subtitle")
  )

tabla_2
```

### Dimension tecnologica y de conectividad

La inclusi√≥n de variables tecnol√≥gicas es justificada por la importancia creciente de la transformaci√≥n digital en el desarrollo contempor√°neo (UNCTAD, 2021; World Bank, 2023). La acceso a electricidad, internet y telefon√≠a m√≥vil no son lujos sino infraestructuras esenciales que habilitan participaci√≥n en la econom√≠a del conocimiento, acceso a informaci√≥n, servicios financieros y oportunidades econ√≥micas (UNCTAD, 2021). La brecha digital ha emergido como una nueva dimensi√≥n de desigualdad internacional, donde pa√≠ses con penetraci√≥n digital menor enfrentan desventajas competitivas significativas (World Bank, 2023)., en la tabla 3 las observamos.

```{r Variables tecnologicas}
variables_tecnologia <- data.frame(
  Variable = c(
    "Acceso a electricidad (% de la poblaci√≥n)",
    "Uso de internet (% de la poblaci√≥n)",
    "Suscripciones m√≥viles (por cada 100 personas)"
  ),
  
  Descripci√≥n = c(
    "Porcentaje de la poblaci√≥n con acceso a electricidad. Indicador fundamental de infraestructura energ√©tica b√°sica, condici√≥n necesaria para actividad econ√≥mica moderna, educaci√≥n, salud y conectividad digital.",
    "Porcentaje de individuos que han utilizado internet en los √∫ltimos 3 meses. Proxy de conectividad digital, acceso a informaci√≥n, y participaci√≥n en la econom√≠a del conocimiento, siendo cada vez m√°s relevante para productividad econ√≥mica y reducci√≥n de brechas informativas.",
    "N√∫mero de suscripciones a servicios de telefon√≠a celular m√≥vil por cada 100 habitantes. Refleja la penetraci√≥n de tecnolog√≠a m√≥vil, que ha sido un vector fundamental de inclusi√≥n digital y acceso a servicios financieros en econom√≠as en desarrollo."
  ),
  
  Interpretaci√≥n = c(
    ">95%: cobertura el√©ctrica universal\n80-95%: acceso extendido\n<80%: d√©ficit significativo de infraestructura",
    ">70%: sociedad digitalmente integrada\n30-70%: adopci√≥n media de internet\n<30%: brecha digital significativa",
    ">100: alta penetraci√≥n m√≥vil\n80-100: cobertura adecuada\n<80: oportunidades de expansi√≥n del mercado"
  )
)

tabla_3 <- variables_tecnologia %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 3**"),
    subtitle = "Indicadores de Infraestructura y Tecnolog√≠a"
  ) %>%
  cols_label(
    Variable = md("**Variable**"),
    Descripci√≥n = md("**Descripci√≥n**"),
    Interpretaci√≥n = md("**Interpretaci√≥n**")
  ) %>%
  cols_align(
    align = "left",
    columns = everything()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium", color = "#000000"),
      cell_fill(color = "#00e5ff")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "#00e5ff",
      weight = px(2)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "#00e5ff",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Variable, Descripci√≥n))
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#0a0e1a"),
      cell_text(color = "#e0e6ed")
    ),
    locations = cells_body()
  ) %>%
  tab_style(
    style = cell_text(weight = "bold", color = "#00e5ff"),
    locations = cells_body(columns = Variable)
  ) %>%
  tab_style(
    style = cell_text(size = "small", color = "#e0e6ed"),
    locations = cells_body(columns = c(Descripci√≥n, Interpretaci√≥n))
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff", size = "large")
    ),
    locations = cells_title(groups = "title")
  ) %>%
  tab_style(
    style = list(
      cell_text(color = "#e0e6ed", size = "medium")
    ),
    locations = cells_title(groups = "subtitle")
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "solid",
    column_labels.border.top.color = "#00e5ff",
    column_labels.border.top.width = px(3),
    column_labels.border.bottom.style = "solid",
    column_labels.border.bottom.width = px(3),
    column_labels.border.bottom.color = "#00e5ff",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    table_body.hlines.style = "solid",
    table_body.hlines.color = "#00e5ff",
    table_body.hlines.width = px(1),
    table.background.color = "#0a0e1a",
    data_row.padding = px(10),
    heading.title.font.size = 18,
    heading.subtitle.font.size = 14,
    heading.padding = px(12),
    heading.border.bottom.style = "solid",
    heading.border.bottom.width = px(2),
    heading.border.bottom.color = "#00e5ff",
    footnotes.padding = px(10),
    footnotes.font.size = 13,
    source_notes.font.size = 13,
    source_notes.padding = px(10)
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboraci√≥n propia con base en World Bank (2023)")
  ) %>%
  tab_footnote(
    footnote = "Los valores superiores a 100 en suscripciones m√≥viles indican m√∫ltiples suscripciones por persona",
    locations = cells_body(
      rows = 3,
      columns = Interpretaci√≥n
    )
  ) %>%
  tab_footnote(
    footnote = "Los umbrales de interpretaci√≥n son referenciales y pueden variar seg√∫n el nivel de desarrollo regional",
    locations = cells_title(groups = "subtitle")
  )

tabla_3
```

### Dimension ambiental y de recursos

La inclusi√≥n de variables ambientales responde al creciente reconocimiento de que el desarrollo sostenible debe integrar consideraciones ecol√≥gicas (PNUD, 2023; World Bank, 2023). Aunque el crecimiento econ√≥mico tradicional ha sido alcanzado frecuentemente mediante degradaci√≥n ambiental, la sostenibilidad del desarrollo requiere preservaci√≥n de capital natural, particularmente bosques (para captura de carbono y biodiversidad) y tierra cultivable (para seguridad alimentaria) (PNUD, 2023; World Bank, 2023), en la tabla 4 las vemos.

```{r Variables ambiental}
variables_ambientales <- data.frame(
  Variable = c(
    "√Årea boscosa (% del √°rea terrestre)",
    "Tierra cultivable (% del √°rea terrestre)"
  ),
  
  Descripci√≥n = c(
    "Porcentaje del territorio nacional cubierto por bosques. Es un indicador de conservaci√≥n ambiental, biodiversidad y sostenibilidad, siendo relevante tanto para mitigaci√≥n del cambio clim√°tico como para servicios ecosist√©micos.",
    "Porcentaje de tierra apta para cultivos agr√≠colas. Refleja el potencial agr√≠cola y la base de recursos naturales para producci√≥n de alimentos, siendo particularmente relevante para econom√≠as con sectores agr√≠colas significativos."
  ),
  
  Interpretaci√≥n = c(
    ">30%: alta cobertura forestal\n15-30%: cobertura media\n<15%: deforestaci√≥n significativa",
    ">20%: alta disponibilidad agr√≠cola\n10-20%: capacidad moderada\n<10%: limitaciones para agricultura"
  )
)

tabla_4 <- variables_ambientales %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 4**"),
    subtitle = "Indicadores Ambientales y de Uso de la Tierra"
  ) %>%
  cols_label(
    Variable = md("**Variable**"),
    Descripci√≥n = md("**Descripci√≥n**"),
    Interpretaci√≥n = md("**Interpretaci√≥n**")
  ) %>%
  cols_align(
    align = "left",
    columns = everything()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium", color = "#000000"),
      cell_fill(color = "#00e5ff")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "#00e5ff",
      weight = px(2)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "#00e5ff",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Variable, Descripci√≥n))
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#0a0e1a"),
      cell_text(color = "#e0e6ed")
    ),
    locations = cells_body()
  ) %>%
  tab_style(
    style = cell_text(weight = "bold", color = "#00e5ff"),
    locations = cells_body(columns = Variable)
  ) %>%
  tab_style(
    style = cell_text(size = "small", color = "#e0e6ed"),
    locations = cells_body(columns = c(Descripci√≥n, Interpretaci√≥n))
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff", size = "large")
    ),
    locations = cells_title(groups = "title")
  ) %>%
  tab_style(
    style = list(
      cell_text(color = "#e0e6ed", size = "medium")
    ),
    locations = cells_title(groups = "subtitle")
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "solid",
    column_labels.border.top.color = "#00e5ff",
    column_labels.border.top.width = px(3),
    column_labels.border.bottom.style = "solid",
    column_labels.border.bottom.width = px(3),
    column_labels.border.bottom.color = "#00e5ff",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    table_body.hlines.style = "solid",
    table_body.hlines.color = "#00e5ff",
    table_body.hlines.width = px(1),
    table.background.color = "#0a0e1a",
    data_row.padding = px(10),
    heading.title.font.size = 18,
    heading.subtitle.font.size = 14,
    heading.padding = px(12),
    heading.border.bottom.style = "solid",
    heading.border.bottom.width = px(2),
    heading.border.bottom.color = "#00e5ff",
    footnotes.padding = px(10),
    footnotes.font.size = 13,
    source_notes.font.size = 13,
    source_notes.padding = px(10)
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboraci√≥n propia con base en World Bank (2023)")
  ) %>%
  tab_footnote(
    footnote = "Los servicios ecosist√©micos incluyen regulaci√≥n h√≠drica, conservaci√≥n de biodiversidad y secuestro de carbono",
    locations = cells_body(
      rows = 1,
      columns = Descripci√≥n
    )
  ) %>%
  tab_footnote(
    footnote = "La tierra cultivable incluye tierras arables, cultivos permanentes y pastos permanentes",
    locations = cells_body(
      rows = 2,
      columns = Descripci√≥n
    )
  ) %>%
  tab_footnote(
    footnote = "Los umbrales de interpretaci√≥n pueden variar seg√∫n las caracter√≠sticas geogr√°ficas y ecol√≥gicas de cada regi√≥n",
    locations = cells_title(groups = "subtitle")
  )

tabla_4

```

### Dimension demografica

La inclusi√≥n de variables demogr√°ficas es justificada porque la din√°mica poblacional condiciona fundamentalmente los desaf√≠os y oportunidades de desarrollo: presi√≥n sobre recursos, mercado laboral, demanda por servicios p√∫blicos, y sostenibilidad fiscal (CEPAL, 2023; World Bank, 2023). Pa√≠ses con crecimiento poblacional acelerado enfrentan distintos desaf√≠os que aquellos con envejecimiento poblacional, impactando tasas de ahorro, inversi√≥n, y provisi√≥n de servicios (CEPAL, 2023), vemos las variables en la tabla 5.

```{r Variables demograficas}
variables_demograficas <- data.frame(
  Variable = c(
    "Poblaci√≥n total",
    "Crecimiento poblacional (% anual)"
  ),
  
  Descripci√≥n = c(
    "N√∫mero total de habitantes de un pa√≠s a mitad de a√±o. El tama√±o poblacional determina tanto el mercado interno como la escala de demanda por servicios p√∫blicos y recursos naturales.",
    "Tasa de variaci√≥n porcentual anual de la poblaci√≥n. Refleja la presi√≥n demogr√°fica y sus implicaciones para sostenibilidad, mercados laborales, y provisi√≥n de servicios p√∫blicos."
  ),
  
  Interpretaci√≥n = c(
    ">100M: pa√≠s muy poblado\n10-100M: poblaci√≥n media\n<10M: pa√≠s poco poblado",
    ">2%: crecimiento r√°pido\n0.5-2%: crecimiento moderado\n<0.5%: crecimiento lento"
  )
)

tabla_5 <- variables_demograficas %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 5**"),
    subtitle = "Indicadores Demogr√°ficos B√°sicos"
  ) %>%
  cols_label(
    Variable = md("**Variable**"),
    Descripci√≥n = md("**Descripci√≥n**"),
    Interpretaci√≥n = md("**Interpretaci√≥n**")
  ) %>%
  cols_align(
    align = "left",
    columns = everything()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium", color = "#000000"),
      cell_fill(color = "#00e5ff")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "#00e5ff",
      weight = px(2)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "#00e5ff",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Variable, Descripci√≥n))
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#0a0e1a"),
      cell_text(color = "#e0e6ed")
    ),
    locations = cells_body()
  ) %>%
  tab_style(
    style = cell_text(weight = "bold", color = "#00e5ff"),
    locations = cells_body(columns = Variable)
  ) %>%
  tab_style(
    style = cell_text(size = "small", color = "#e0e6ed"),
    locations = cells_body(columns = c(Descripci√≥n, Interpretaci√≥n))
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff", size = "large")
    ),
    locations = cells_title(groups = "title")
  ) %>%
  tab_style(
    style = list(
      cell_text(color = "#e0e6ed", size = "medium")
    ),
    locations = cells_title(groups = "subtitle")
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "solid",
    column_labels.border.top.color = "#00e5ff",
    column_labels.border.top.width = px(3),
    column_labels.border.bottom.style = "solid",
    column_labels.border.bottom.width = px(3),
    column_labels.border.bottom.color = "#00e5ff",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    table_body.hlines.style = "solid",
    table_body.hlines.color = "#00e5ff",
    table_body.hlines.width = px(1),
    table.background.color = "#0a0e1a",
    data_row.padding = px(10),
    heading.title.font.size = 18,
    heading.subtitle.font.size = 14,
    heading.padding = px(12),
    heading.border.bottom.style = "solid",
    heading.border.bottom.width = px(2),
    heading.border.bottom.color = "#00e5ff",
    footnotes.padding = px(10),
    footnotes.font.size = 13,
    source_notes.font.size = 13,
    source_notes.padding = px(10)
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboraci√≥n propia con base en World Bank (2023)")
  ) %>%
  tab_footnote(
    footnote = "La poblaci√≥n se refiere a residentes totales independientemente de su estatus legal o ciudadan√≠a",
    locations = cells_body(
      rows = 1,
      columns = Descripci√≥n
    )
  ) %>%
  tab_footnote(
    footnote = "El crecimiento poblacional incluye nacimientos, muertes y migraci√≥n neta",
    locations = cells_body(
      rows = 2,
      columns = Descripci√≥n
    )
  ) %>%
  tab_footnote(
    footnote = "Los umbrales de interpretaci√≥n son referenciales y pueden variar seg√∫n el contexto regional y nivel de desarrollo",
    locations = cells_title(groups = "subtitle")
  )

tabla_5
```

## Base de datos del modelo

A continuacion, se muestra la base de datos que se usara para el modelo de aprendizaje no supervisado.

```{r Base de datos, warning=FALSE,message=FALSE}

Base_2022 <- read_csv("f36a5086-3311-4b1a-9f0c-bda5cd4718df_Series - Metadata.csv",
                 show_col_types = FALSE) %>%
  select(
    Pais = `Country Name`,
    Codigo = `Country Code`,
    PIB_per = `GDP per capita (current US$) [NY.GDP.PCAP.CD]`,
    Poblacion = `Population, total [SP.POP.TOTL]`,
    `Esperanza vida` = `Life expectancy at birth, total (years) [SP.DYN.LE00.IN]`,
    `Acceso electricidad` = `Access to electricity (% of population) [EG.ELC.ACCS.ZS]`,
    `Area boscosa` = `Forest area (% of land area) [AG.LND.FRST.ZS]`,
    `Suscripciones movil` = `Mobile cellular subscriptions (per 100 people) [IT.CEL.SETS.P2]`,
    `Crecimiento PIB` = `GDP growth (annual %) [NY.GDP.MKTP.KD.ZG]`,
    `Mortalidad infantil` = `Mortality rate, infant (per 1,000 live births) [SP.DYN.IMRT.IN]`,
    `Inversion extranjera` = `Foreign direct investment, net inflows (% of GDP) [BX.KLT.DINV.WD.GD.ZS]`,
    `Gasto salud` = `Current health expenditure (% of GDP) [SH.XPD.CHEX.GD.ZS]`,
    `Uso internet` = `Individuals using the Internet (% of population) [IT.NET.USER.ZS]`,
    Importaciones = `Imports of goods and services (% of GDP) [NE.IMP.GNFS.ZS]`,
    Exportaciones = `Exports of goods and services (% of GDP) [NE.EXP.GNFS.ZS]`,
    `Tierra cultivable` = `Arable land (% of land area) [AG.LND.ARBL.ZS]`,
    `Crecimiento poblacion` = `Population growth (annual %) [SP.POP.GROW]`,
    Industria = `Industry (including construction), value added (% of GDP) [NV.IND.TOTL.ZS]`,
    Remesas = `Personal remittances, received (% of GDP) [BX.TRF.PWKR.DT.GD.ZS]`
  )%>%
  filter(!Pais %in% c("World", "High income", "Low income", "European Union",
                      "Latin America & Caribbean", "Middle income", "OECD members",
                      "East Asia & Pacific", "Sub-Saharan Africa", "South Asia",
                      "North America", "Euro area", "Arab World", "West Bank and Gaza",
                      "Lower middle income", "Upper middle income", 
                      "Least developed countries: UN classification",
                      "Fragile and conflict affected situations", 
                      "Heavily indebted poor countries (HIPC)",
                      "IDA total", "Low & middle income", "Middle East & North Africa",
                      "Pacific island small states", "Small states", 
                      "Caribbean small states", "Other small states", 
                      "IDA & IBRD total", "IDA only", "IBRD only",
                      "Pre-demographic dividend", "Post-demographic dividend", 
                      "Early-demographic dividend", "Late-demographic dividend")) %>% 
  mutate(across(3:19, as.numeric)) %>% drop_na()%>% 
  filter(Pais != c( "Luxembourg","	Uruguay", "Angola","Jordan","Belize")) %>% 
  filter(Codigo != "BLZ",Codigo!="JOR",Codigo!="URY")

nombres_columnas <- c(
  "Pa√≠s", "C√≥digo", "PIB per c√°pita", "Poblaci√≥n", 
  "Esperanza vida", "Acceso electricidad", "√Årea boscosa",
  "Suscripciones m√≥viles", "Crecimiento PIB", "Mortalidad infantil",
  "Inversi√≥n extranjera", "Gasto salud", "Uso internet", 
  "Importaciones", "Exportaciones", "Tierra cultivable",
  "Crecimiento poblaci√≥n", "Industria", "Remesas"
)

tabla_inicial <- datatable(
  Base_2022,
  extensions = c('Buttons', 'Scroller', 'Responsive'),
  options = list(
    dom = '<"tabla-header"B>frtip',
    buttons = list(
      list(extend = 'copy', text = 'üìã Copiar', className = 'btn-cyber-primary'),
      list(extend = 'csv', text = 'üìä CSV', className = 'btn-cyber-primary'),
      list(extend = 'excel', text = 'üìà Excel', className = 'btn-cyber-primary'),
      list(extend = 'pdf', text = 'üìÑ PDF', className = 'btn-cyber-primary'),
      list(extend = 'print', text = 'üñ®Ô∏è Imprimir', className = 'btn-cyber-primary')
    ),
    pageLength = 12,
    lengthMenu = list(c(8, 12, 20, 50, -1), 
                     c('8', '12', '20', '50', 'Todos')),
    scrollX = TRUE,
    scrollY = "550px",
    scroller = TRUE,
    deferRender = TRUE,
    autoWidth = FALSE,
    responsive = FALSE,
    language = list(
      url = '//cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json',
      search = "üîç Buscar:",
      lengthMenu = "Mostrar _MENU_ registros",
      info = "_START_ - _END_ de _TOTAL_ pa√≠ses",
      paginate = list(
        first = "‚èÆÔ∏è",
        last = "‚è≠Ô∏è",
        `next` = "‚û°Ô∏è",
        previous = "‚¨ÖÔ∏è"
      )
    )
  ),
  rownames = FALSE,
  class = c('display', 'compact', 'hover', 'nowrap'),
  caption = htmltools::HTML(
    '<div style="color: #FFFFFF; font-size: 18px; font-weight: bold; 
    margin-bottom: 20px; text-align: left; text-shadow: 0 0 15px rgba(0, 229, 255, 0.5); 
    text-transform: uppercase; letter-spacing: 2px;">
    Tabla 6: Dataset Completo - Variables de Desarrollo Global 2022
    </div>'
  ),
  colnames = nombres_columnas
) %>%
  formatCurrency(
    columns = 'PIB_per', 
    currency = "$", 
    digits = 0,
    before = TRUE
  ) %>%
  formatRound(
    columns = 'Poblacion', 
    digits = 0,
    mark = ","
  ) %>%
  formatRound(
    columns = c('Esperanza vida', 'Acceso electricidad', 'Area boscosa',
               'Suscripciones movil', 'Crecimiento PIB', 'Inversion extranjera', 
               'Gasto salud', 'Uso internet', 'Importaciones', 'Exportaciones', 
               'Tierra cultivable', 'Crecimiento poblacion', 'Industria', 'Remesas'), 
    digits = 2
  ) %>%
  formatRound(
    columns = 'Mortalidad infantil',
    digits = 1
  ) %>%
  htmlwidgets::onRender("
    function(el, x) {
      
      var wrapper = $(el).find('.dataTables_wrapper');
      wrapper.css({
        'background': 'linear-gradient(135deg, #0a0e1a 0%, #12161f 100%)',
        'border': '2px solid rgba(0, 229, 255, 0.4)',
        'border-radius': '14px',
        'padding': '25px',
        'box-shadow': '0 12px 50px rgba(0, 0, 0, 0.8)',
        'font-family': 'Arial, sans-serif',
        'overflow': 'visible !important',
        'width': '100% !important'
      });
      
      // 
      var btnContainer = $(el).find('.dt-buttons');
      btnContainer.css({
        'padding': '20px 0',
        'margin-bottom': '20px',
        'display': 'flex',
        'gap': '12px',
        'flex-wrap': 'wrap',
        'align-items': 'center',
        'border-bottom': '2px solid rgba(0, 229, 255, 0.3)',
        'padding-bottom': '20px'
      });
      
      // 
      $(el).find('.dt-button').each(function() {
        $(this).css({
          'background': '#00e5ff !important',
          'background-color': '#00e5ff !important',
          'background-image': 'linear-gradient(135deg, #00e5ff 0%, #00b8d4 100%) !important',
          'color': '#000000 !important',
          'border': '3px solid #00ffff !important',
          'border-radius': '10px !important',
          'padding': '14px 24px !important',
          'margin': '0 8px !important',
          'font-size': '14px !important',
          'font-weight': '900 !important',
          'cursor': 'pointer !important',
          'transition': 'all 0.25s ease !important',
          'box-shadow': '0 6px 20px rgba(0, 229, 255, 0.6), inset 0 0 15px rgba(255, 255, 255, 0.3) !important',
          'text-transform': 'uppercase',
          'letter-spacing': '1.5px',
          'text-shadow': '0 1px 3px rgba(0, 0, 0, 0.3)',
          'display': 'inline-block !important',
          'opacity': '1 !important',
          'visibility': 'visible !important'
        });
      }).hover(
        function() {
          $(this).css({
            'transform': 'translateY(-4px) scale(1.05) !important',
            'background': '#00ffff !important',
            'background-color': '#00ffff !important',
            'box-shadow': '0 12px 35px rgba(0, 255, 255, 1), inset 0 0 25px rgba(255, 255, 255, 0.4) !important'
          });
        },
        function() {
          $(this).css({
            'transform': 'translateY(0) scale(1) !important',
            'background': '#00e5ff !important',
            'background-color': '#00e5ff !important',
            'box-shadow': '0 6px 20px rgba(0, 229, 255, 0.6), inset 0 0 15px rgba(255, 255, 255, 0.3) !important'
          });
        }
      );
      
      // 
      setTimeout(function() {
        $(el).find('a.dt-button, button.dt-button, .btn-cyber-primary, .buttons-copy, .buttons-csv, .buttons-excel, .buttons-pdf, .buttons-print').css({
          'background': '#00e5ff !important',
          'background-color': '#00e5ff !important',
          'color': '#000000 !important',
          'opacity': '1 !important',
          'visibility': 'visible !important',
          'border': '3px solid #00ffff !important'
        });
      }, 100);
      
      // 
      $(el).find('.dataTables_scroll').css({
        'overflow-x': 'auto !important',
        'width': '100% !important'
      });
      
      $(el).find('.dataTables_scrollHead').css({
        'overflow': 'visible !important',
        'width': '100% !important'
      });
      
      $(el).find('.dataTables_scrollBody').css({
        'overflow-x': 'auto !important',
        'overflow-y': 'auto !important',
        'width': '100% !important',
        'background': '#0a0e1a',
        'border': '1px solid rgba(0, 229, 255, 0.2)',
        'border-radius': '8px'
      });
      
      $(el).find('table').css({
        'width': '100% !important',
        'table-layout': 'auto !important'
      });
      
      // 
      var thead = $(el).find('thead');
      thead.css({
        'background': 'linear-gradient(135deg, #00e5ff 0%, #0084ff 100%)',
        'box-shadow': '0 0 30px rgba(0, 229, 255, 0.7)'
      });
      
      $(el).find('thead th').css({
        'background': 'linear-gradient(135deg, #00e5ff 0%, #0084ff 100%) !important',
        'color': '#000000 !important',
        'font-weight': 'bold !important',
        'font-size': '14px !important',
        'padding': '16px 12px !important',
        'text-align': 'center',
        'border': '3px solid #0084ff !important',
        'white-space': 'nowrap !important',
        'text-transform': 'uppercase',
        'letter-spacing': '1px',
        'box-shadow': 'inset 0 0 20px rgba(0, 0, 0, 0.2), 0 0 15px rgba(0, 229, 255, 0.3)',
        'font-family': 'Arial, sans-serif',
        'min-width': '120px'
      });
      
      // 
      $(el).find('tbody tr').css({
        'background-color': '#0a0e1a !important',
        'border-bottom': '2px solid #12161f !important',
        'transition': 'all 0.2s ease'
      });
      
      // 
      $(el).find('tbody tr td:first-child').css({
        'background-color': '#12161f !important',
        'color': '#00e5ff !important',
        'font-weight': 'bold !important',
        'font-size': '14px !important',
        'border-left': '4px solid #00e5ff !important',
        'border-right': '3px solid #00e5ff !important',
        'padding': '14px 10px !important',
        'text-shadow': '0 0 10px rgba(0, 229, 255, 0.4)',
        'white-space': 'nowrap !important',
        'min-width': '150px'
      });
      
      // 
      $(el).find('tbody td').not(':first-child').css({
        'padding': '14px 10px !important',
        'border-right': '1px solid rgba(0, 229, 255, 0.2) !important',
        'text-align': 'center',
        'font-size': '13px',
        'color': '#e0e6ed !important',
        'background-color': '#0a0e1a !important',
        'white-space': 'nowrap !important',
        'min-width': '100px'
      });
      
      // 
      $(el).find('tbody tr').hover(
        function() {
          $(this).css({
            'background-color': '#12161f !important',
            'box-shadow': 'inset 0 0 25px rgba(0, 229, 255, 0.2), 0 0 15px rgba(0, 229, 255, 0.3) !important',
            'border-left': '4px solid #00e5ff !important'
          });
          $(this).find('td').css({
            'color': '#00e5ff !important',
            'text-shadow': '0 0 8px rgba(0, 229, 255, 0.4)'
          });
          $(this).find('td:first-child').css('color', '#00ffff !important');
        },
        function() {
          $(this).css({
            'background-color': '#0a0e1a !important',
            'box-shadow': 'none !important',
            'border-left': 'none !important'
          });
          $(this).find('td').css({
            'color': '#e0e6ed',
            'text-shadow': 'none'
          });
          $(this).find('td:first-child').css('color', '#00e5ff');
        }
      );
      
      //
      var searchLabel = $(el).find('label:has([type=search])');
      searchLabel.css({
        'color': '#e0e6ed !important',
        'font-weight': 'bold',
        'font-size': '14px',
        'display': 'flex',
        'align-items': 'center',
        'gap': '10px',
        'margin-bottom': '15px'
      });
      
      var searchBox = $(el).find('input[type=search]');
      searchBox.css({
        'background-color': '#12161f !important',
        'color': '#e0e6ed !important',
        'border': '2px solid #00e5ff !important',
        'border-radius': '8px !important',
        'padding': '12px 15px !important',
        'font-size': '14px !important',
        'width': '300px !important',
        'box-shadow': '0 0 20px rgba(0, 229, 255, 0.2) inset',
        'transition': 'all 0.3s ease'
      }).focus(function() {
        $(this).css({
          'box-shadow': '0 0 30px rgba(0, 229, 255, 0.6) inset, 0 0 20px rgba(0, 229, 255, 0.4)',
          'border-color': '#00ffff !important'
        });
      }).blur(function() {
        $(this).css({
          'box-shadow': '0 0 20px rgba(0, 229, 255, 0.2) inset'
        });
      });
      
      //
      var lengthLabel = $(el).find('label:has(select)');
      lengthLabel.css({
        'color': '#e0e6ed',
        'font-size': '13px',
        'display': 'flex',
        'align-items': 'center',
        'gap': '8px'
      });
      
      $(el).find('select').css({
        'background-color': '#12161f !important',
        'color': '#e0e6ed !important',
        'border': '2px solid #00e5ff !important',
        'border-radius': '6px !important',
        'padding': '8px 10px !important',
        'font-size': '13px !important',
        'cursor': 'pointer',
        'box-shadow': '0 0 15px rgba(0, 229, 255, 0.2) inset'
      });
      
      // 
      $(el).find('.dataTables_paginate').css({
        'margin-top': '20px',
        'padding-top': '15px',
        'border-top': '2px solid rgba(0, 229, 255, 0.3)'
      });
      
      $(el).find('.paginate_button').css({
        'background-color': '#12161f !important',
        'color': '#e0e6ed !important',
        'border': '2px solid #00e5ff !important',
        'padding': '10px 14px !important',
        'margin': '3px 3px !important',
        'border-radius': '6px !important',
        'font-size': '13px !important',
        'font-weight': 'bold',
        'cursor': 'pointer',
        'transition': 'all 0.2s ease',
        'box-shadow': '0 0 10px rgba(0, 229, 255, 0.2)'
      }).hover(
        function() {
          if (!$(this).hasClass('disabled')) {
            $(this).css({
              'background-color': '#00e5ff !important',
              'color': '#000000 !important',
              'box-shadow': '0 0 20px rgba(0, 229, 255, 0.8)',
              'transform': 'scale(1.08)'
            });
          }
        },
        function() {
          if (!$(this).hasClass('disabled')) {
            $(this).css({
              'background-color': '#12161f !important',
              'color': '#e0e6ed !important',
              'box-shadow': '0 0 10px rgba(0, 229, 255, 0.2)',
              'transform': 'scale(1)'
            });
          }
        }
      );
      
      $(el).find('.paginate_button.current').css({
        'background-color': '#00e5ff !important',
        'color': '#000000 !important',
        'border-color': '#00ffff !important',
        'font-weight': '900',
        'box-shadow': '0 0 30px rgba(0, 229, 255, 0.9), inset 0 0 15px rgba(255, 255, 255, 0.2)'
      });
      
      $(el).find('.paginate_button.disabled').css({
        'opacity': '0.4 !important',
        'cursor': 'not-allowed !important'
      });
      
      // 
      $(el).find('.dataTables_info').css({
        'color': '#00e5ff !important',
        'font-size': '14px !important',
        'font-weight': 'bold',
        'padding': '15px 0',
        'border-top': '2px solid rgba(0, 229, 255, 0.3)',
        'text-shadow': '0 0 10px rgba(0, 229, 255, 0.3)'
      });
      
      // 
      var style = document.createElement('style');
      style.textContent = `
        .dataTables_scrollBody::-webkit-scrollbar {
          width: 12px;
          height: 12px;
        }
        .dataTables_scrollBody::-webkit-scrollbar-track {
          background: #0a0e1a;
          border-radius: 6px;
          border: 1px solid rgba(0, 229, 255, 0.2);
        }
        .dataTables_scrollBody::-webkit-scrollbar-thumb {
          background: linear-gradient(135deg, #00e5ff, #0084ff);
          border-radius: 6px;
          box-shadow: 0 0 10px rgba(0, 229, 255, 0.5);
        }
        .dataTables_scrollBody::-webkit-scrollbar-thumb:hover {
          background: linear-gradient(135deg, #00ffff, #00e5ff);
          box-shadow: 0 0 20px rgba(0, 229, 255, 0.8);
        }
        .dataTables_scrollBody::-webkit-scrollbar-corner {
          background: #0a0e1a;
        }
        .dataTables_scroll {
          overflow-x: auto !important;
        }
      `;
      document.head.appendChild(style);
    }
  ")

tabla_inicial

```

## Descripci√≥n del modelo

La implementaci√≥n del an√°lisis se estructura en cuatro etapas secuenciales, cada una construida sobre los resultados de la anterior, garantizando que la informaci√≥n y patrones descubiertos se preserven y amplifiquen a trav√©s del pipeline de an√°lisis.

### Preparaci√≥n y Estandarizaci√≥n de Datos

Previo a cualquier an√°lisis multivariado, es fundamental estandarizar las variables originales para garantizar que todas contribuyan en igualdad de condiciones al c√°lculo de componentes principales (KeepCoding, 2025). La estandarizaci√≥n se realiz√≥ mediante la transformaci√≥n z-score: $Z_i = \frac{X_i - \mu_i}{\sigma_i}$ donde $Z_i$ es la variable estandarizada, $X_i$ la variable original, $\mu_i$ la media y $\sigma_i$ la desviaci√≥n est√°ndar.

Esta estandarizaci√≥n es cr√≠tica porque el an√°lisis de componentes principales se fundamenta en la varianza de los datos: sin estandarizar, variables con escalas num√©ricas mayores (como poblaci√≥n total en millones) dominar√≠an el c√°lculo de componentes, distorsionando la interpretaci√≥n y otorgando influencia desproporcionada a magnitudes en lugar de patrones (LinkedIn, 2023; Ciencia de Datos, 2016). Adicionalmente, la estandarizaci√≥n garantiza que el an√°lisis capture relaciones entre variables y no simplemente diferencias en escala.

### An√°lisis de Componentes Principales (ACP)

Con las 17 variables estandarizadas, se aplica el An√°lisis de Componentes Principales para transformar el conjunto de variables originales, potencialmente correlacionadas, en un conjunto menor de componentes principales ortogonales (Jolliffe, 2002; OpenWebinars, 2025). El ACP identifica las direcciones en el espacio de datos donde la varianza es m√°xima, creando nuevas dimensiones (componentes) que son combinaciones lineales ponderadas de las variables originales (Jolliffe, 2002; KeepCoding, 2025).

Matem√°ticamente, el ACP comienza construyendo la matriz de covarianza $C$ de las variables estandarizadas, cuyas entradas representan c√≥mo var√≠an conjuntamente pares de variables (KeepCoding, 2025). Los vectores propios de esta matriz de covarianza definen las direcciones principales (componentes), ordenados seg√∫n sus correspondientes valores propios, que representan la cantidad de varianza explicada en cada direcci√≥n (Jolliffe, 2002). El primer componente principal captura la m√°xima varianza; el segundo, la m√°xima varianza restante sujeto a ortogonalidad respecto al primero; y as√≠ sucesivamente (Jolliffe, 2002).

El objetivo es identificar cu√°ntos componentes son necesarios para capturar la mayor parte de la varianza total de los datos‚Äît√≠picamente entre 70-90% seg√∫n el contexto (OpenWebinars, 2025). Esto permite reducir significativamente la dimensionalidad: en lugar de trabajar con 17 variables potencialmente redundantes, se trabaja con un n√∫mero reducido de componentes sint√©ticos que capturan la esencia de la heterogeneidad internacional (Jolliffe, 2002).

### C√°lculo de Distancias Euclidianas

Una vez obtenidos los componentes principales, se utiliza la distancia euclidiana como m√©trica de disimilaridad entre pa√≠ses. Para cada par de pa√≠ses, la distancia euclidiana se calcula como:

$$ d_{ij} = \sqrt{\sum_{k=1}^{p} (PC_{ik} - PC_{jk})^2} $$ Donde:

-   $d_{ij}$ = Distancia euclidiana entre los pa√≠ses $i$ y $j$
-   $p$ = N√∫mero de componentes principales utilizados
-   $PC_{ik}$ = Valor del $k$-√©simo componente principal para el pa√≠s $i$
-   $PC_{jk}$ = Valor del $k$-√©simo componente principal para el pa√≠s $j$

Esta distancia mide la proximidad multidimensional entre pa√≠ses: distancias peque√±as indican perfiles similares, distancias grandes indican disimilaridad (Universidad de Granada, 2016; ArcGIS, 2024).

La distancia euclidiana es particularmente apropiada para el m√©todo de Ward porque, en su implementaci√≥n aglomerativa, se utiliza el cuadrado de la distancia euclidiana‚Äîformalmente conocida como "distancia euclidiana semicuadrada"‚Äîcomo medida de disimilaridad (Ward, 1963; Wikipedia, 2013; TIBCO, 2024).

### Clusterizaci√≥n Jer√°rquica Aglomerativa con M√©todo de Ward

El m√©todo de Ward es un algoritmo jer√°rquico aglomerativo que opera iterativamente sobre el conjunto de pa√≠ses para formar una jerarqu√≠a de clusters (Ward, 1963). El procedimiento inicia considerando cada pa√≠s como un cluster individual independiente, creando n grupos iniciales. En cada iteraci√≥n subsecuente, se identifican los dos clusters m√°s pr√≥ximos seg√∫n el criterio de Ward y se fusionan en un √∫nico cluster m√°s grande (Ward, 1963; Universidad de Granada, 2016; ICESI, 2025).

El criterio de Ward minimiza espec√≠ficamente la suma total de cuadrados dentro de los clusters (within-cluster sum of squares, WCSS). Matem√°ticamente, en cada paso, Ward selecciona el par de clusters cuya fusi√≥n produce el incremento m√≠nimo en la varianza total intra-cluster (Ward, 1963; Wikipedia, 2013).

El algoritmo se ejecuta recursivamente hasta que todos los pa√≠ses quedan englobados en un √∫nico cluster. El resultado es un dendrograma‚Äîdiagrama en forma de √°rbol invertido‚Äîque visualiza el proceso completo de fusi√≥n: cada rama representa un pa√≠s individual, cada nodo de fusi√≥n representa la uni√≥n de dos clusters, y la altura de cada nodo indica el nivel de disimilaridad en el cual ocurri√≥ la fusi√≥n (Universidad de Granada, 2016; ICESI, 2025). El dendrograma permite identificar visualmente el n√∫mero √≥ptimo de clusters "cortando" el √°rbol a un nivel espec√≠fico de altura, determinando as√≠ cu√°ntos grupos finales son m√°s interpretables y √∫tiles (Ward, 1963; Universidad de Granada, 2016).

En s√≠ntesis, el modelo integra: (1) estandarizaci√≥n para igualar contribuciones relativas, (2) reducci√≥n de dimensionalidad mediante ACP para simplificar sin perder informaci√≥n, (3) c√°lculo de distancias euclidianas para cuantificar disimilaridad, y (4) clusterizaci√≥n jer√°rquica Ward para crear una taxonom√≠a multidimensional de desarrollo. Esta arquitectura metodol√≥gica asegura que los agrupamientos emergentes sean producto exclusivamente de los datos y no de imposiciones externas, permitiendo descubrimientos genuinos sobre la estructura del desarrollo internacional (Jolliffe, 2002; Charrad et al., 2014).

------------------------------------------------------------------------

# An√°lisis Descriptivo

Antes de aplicar la reducci√≥n dimensional mediante An√°lisis de Componentes Principales y revelar agrupamientos multidimensionales de pa√≠ses, es fundamental explorar c√≥mo se distribuyen y relacionan los indicadores individuales en el espacio observable. El an√°lisis descriptivo identifica relaciones preliminares, heterogeneidades sistem√°ticas y anomal√≠as en cada dimensi√≥n del desarrollo‚Äîinformaci√≥n que prepara conceptualmente para el descubrimiento de clusters coherentes. En esencia: mientras que el ACP responder√° "¬øqu√© estructura latente subyace en los datos?", el an√°lisis descriptivo responde "¬øqu√© patrones visibles anticipan esa estructura?" Las cinco dimensiones tem√°ticas‚Äîecon√≥mica, de salud, tecnol√≥gica, ambiental y demogr√°fica‚Äîse examinan secuencialmente a trav√©s de visualizaciones interactivas que revelan l√≠deres y rezagados en cada indicador, patrones de asociaci√≥n entre variables dentro de dimensiones, y diferencias regionales que anticipan los agrupamientos posteriores. Este enfoque dimensional permite reconocer que el "desarrollo" no es una variable √∫nica sino un fen√≥meno multifac√©tico donde pa√≠ses pueden destacar en algunas √°reas mientras quedan rezagados en otras‚Äîprecisamente la complejidad que justifica un an√°lisis multivariado integrado.

## Explorador Interactivo de Indicadores

Con el prop√≥sito de facilitar el an√°lisis exploratorio de cada una de las 17 variables de desarrollo de forma individual, se ha desarrollado un explorador interactivo que permite examinar din√°micamente la distribuci√≥n, dispersi√≥n y rankings de cada indicador. Esta herramienta opera sobre todo el dataset y proporciona tres niveles de informaci√≥n complementarios: (1) estad√≠sticas globales que resumen la concentraci√≥n y dispersi√≥n de cada variable (media, mediana, desviaci√≥n est√°ndar, percentiles), (2) ranking de los 10 pa√≠ses l√≠deres en cada indicador, y (3) variabilidad porcentual respecto a la media, que cuantifica cu√°nto cada pa√≠s se desv√≠a del patr√≥n global.

El explorador funciona mediante un sistema de pesta√±as interactivas: selecciona cualquier variable haciendo click en sus botonespara visualizar simult√°neamente las estad√≠sticas agregadas y el top 10 de desempe√±o. Esta estructura permite identificar patrones preliminares de concentraci√≥n, identificar outliers extremos, y reconocer diferenciaciones regionales antes de proceder al an√°lisis multidimensional integrado. A continuaci√≥n se presentan dos ejemplos ilustrativos que ejemplifican la heterogeneidad fundamental del desarrollo global.

```{r preparar-datos-unificados}

variables_numericas <- names(Base_2022)[3:ncol(Base_2022)]

crear_tabla_unificada <- function(data, variable) {
  valores <- data[[variable]]
  
  total_paises <- sum(!is.na(valores))
  media <- round(mean(valores, na.rm = TRUE), 2)
  mediana <- round(median(valores, na.rm = TRUE), 2)
  desv_est <- round(sd(valores, na.rm = TRUE), 2)
  q1 <- round(quantile(valores, 0.25, na.rm = TRUE), 2)
  q3 <- round(quantile(valores, 0.75, na.rm = TRUE), 2)
  minimo <- round(min(valores, na.rm = TRUE), 2)
  maximo <- round(max(valores, na.rm = TRUE), 2)
  
  top10 <- data %>%
    select(Pais, Valor = all_of(variable)) %>%
    arrange(desc(Valor)) %>%
    head(10) %>%
    mutate(
      Ranking = row_number(),
      Pct_vs_Media = round((Valor / media - 1) * 100, 1)
    )
  
  estadisticas <- data.frame(
    M√©trica = c("Total Pa√≠ses", "Media", "Mediana", "Desv. Est.", 
                "Q1", "Q3", "M√≠nimo", "M√°ximo"),
    Valor = c(total_paises, media, mediana, desv_est, q1, q3, minimo, maximo)
  )
  
  top10_tabla <- top10 %>%
    mutate(
      Pct_Display = paste0(ifelse(Pct_vs_Media >= 0, "+", ""), Pct_vs_Media, "%"),
      Pct_Color = ifelse(Pct_vs_Media >= 0, "#00e676", "#ff1744")
    ) %>%
    select(Ranking, Pa√≠s = Pais, Valor, Pct_Display, Pct_Color)
  
  list(estadisticas = estadisticas, top10 = top10_tabla)
}
```

```{=html}
<style>
/* O */
.section-number {
  display: none !important;
}

#TOC .toc-section-number {
  display: none !important;
}

h4 .header-section-number {
  display: none !important;
}

/* C */
.nav-pills {
  display: flex !important;
  flex-wrap: wrap !important;
  gap: 12px !important;
  padding: 25px !important;
  background: linear-gradient(135deg, #0a0e1a 0%, #12161f 100%) !important;
  border-radius: 15px !important;
  border: 2px solid rgba(0, 229, 255, 0.3) !important;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6) !important;
  margin-bottom: 30px !important;
}

.nav-pills > li {
  margin: 0 !important;
  list-style: none !important;
}

.nav-pills > li > a {
  background: linear-gradient(135deg, #12161f 0%, #0d1117 100%) !important;
  color: #e0e6ed !important;
  border: 2px solid #00e5ff !important;
  border-radius: 10px !important;
  padding: 14px 22px !important;
  font-size: 14px !important;
  font-weight: 600 !important;
  text-align: center !important;
  min-width: 160px !important;
  transition: all 0.3s ease !important;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5) !important;
  text-decoration: none !important;
  display: block !important;
}

.nav-pills > li > a:hover {
  background: linear-gradient(135deg, #00e5ff 0%, #0084ff 100%) !important;
  color: #000 !important;
  border-color: #00ffff !important;
  transform: translateY(-4px) !important;
  box-shadow: 0 8px 25px rgba(0, 229, 255, 0.6) !important;
}

.nav-pills > li.active > a,
.nav-pills > li.active > a:hover,
.nav-pills > li.active > a:focus {
  background: linear-gradient(135deg, #00e5ff 0%, #0084ff 100%) !important;
  color: #000 !important;
  border-color: #00ffff !important;
  box-shadow: 0 0 30px rgba(0, 229, 255, 0.8) !important;
  font-weight: 700 !important;
}

/* L */
.two-column-layout {
  display: grid;
  grid-template-columns: 48% 48%;
  gap: 30px;
  margin-top: 25px;
  justify-content: center;
}

@media (max-width: 1200px) {
  .two-column-layout {
    grid-template-columns: 1fr;
  }
}

/* C */
.table-container {
  background: linear-gradient(135deg, #0a0e1a 0%, #0d1117 100%);
  border: 2px solid rgba(0, 229, 255, 0.3);
  border-radius: 12px;
  padding: 25px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.7);
}

.section-title {
  color: #00e5ff;
  font-size: 1.3em;
  font-weight: 700;
  margin-bottom: 20px;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  text-align: center;
  text-shadow: 0 0 15px rgba(0, 229, 255, 0.5);
  padding-bottom: 12px;
  border-bottom: 2px solid rgba(0, 229, 255, 0.3);
}
</style>
```

### Tabla 7: Selecciona una Variable {.tabset .tabset-pills .unnumbered}

```{r tablas-layout, results='asis'}
for (variable in variables_numericas) {
  cat(sprintf('\n\n#### %s {.unnumbered}\n\n', variable))
  
  datos <- crear_tabla_unificada(Base_2022, variable)
  
  cat('<div class="two-column-layout">\n\n')
  
  cat('<div class="table-container">\n\n')
  
  cat('<p class="section-title"> Estad√≠sticas Globales</p>\n\n')
  
  tabla_stats <- datos$estadisticas %>%
    kbl(
      align = c('l', 'r'), 
      escape = FALSE,
      col.names = c("M√©trica", "Valor")
    ) %>%
    kable_styling(
      bootstrap_options = c("striped", "hover"),
      full_width = TRUE,
      font_size = 13
    ) %>%
    row_spec(0, background = "#00e5ff", color = "#000", bold = TRUE, font_size = 14) %>%
    row_spec(1, background = "#12161f", color = "#00e5ff", bold = TRUE, font_size = 14) %>%
    row_spec(2:8, background = "#0d1117", color = "#e0e6ed") %>%
    column_spec(1, width = "14em", bold = TRUE, color = "#e0e6ed") %>%
    column_spec(2, width = "10em", color = "#00e5ff", bold = TRUE)
  
  print(tabla_stats)
  
  cat('\n\n</div>\n\n')
  
  cat('<div class="table-container">\n\n')
  
  cat('<p class="section-title"> Top 10 Pa√≠ses</p>\n\n')
  
  tabla_top10_data <- datos$top10 %>%
    mutate(
      Pct_Display_Colored = cell_spec(
        Pct_Display,
        "html",
        color = Pct_Color,
        bold = TRUE
      )
    ) %>%
    select(`#` = Ranking, Pa√≠s, Valor, `% vs Media` = Pct_Display_Colored)
  
  tabla_top10 <- tabla_top10_data %>%
    kbl(
      align = c('c', 'l', 'r', 'c'), 
      escape = FALSE
    ) %>%
    kable_styling(
      bootstrap_options = c("striped", "hover"),
      full_width = TRUE,
      font_size = 13
    ) %>%
    row_spec(0, background = "#0084ff", color = "#000", bold = TRUE, font_size = 14) %>%
    row_spec(1:10, background = "#0d1117", color = "#e0e6ed") %>%
    column_spec(1, width = "3em", bold = TRUE, color = "#000", background = "#00e5ff") %>%
    column_spec(2, width = "13em", bold = TRUE) %>%
    column_spec(3, width = "9em", color = "#00e5ff", bold = TRUE)
  
  print(tabla_top10)
  
  cat('\n\n</div>\n\n')
  
  cat('</div>\n\n')
}
```

El an√°lisis del conjunto de los indicadores revela una caracter√≠stica fundamental: la desigualdad internacional no es uniforme sino espec√≠fica a cada dimensi√≥n de desarrollo. Mientras que el PIB per c√°pita muestra una concentraci√≥n extrema (media \$17,045.36 vs. mediana \$6,705.15, indicando que el 50% de pa√≠ses est√° por debajo de apenas \$6,705), la poblaci√≥n exhibe un patr√≥n radicalmente distinto de concentraci√≥n geogr√°fica en gigantes asi√°ticos (media 49.6 millones vs. mediana 10.4 millones). Esta variabilidad espec√≠fica a cada variable es precisamente lo que genera la complejidad multidimensional del desarrollo: pa√≠ses pueden sobresalir en algunas √°reas (por ejemplo, esperanza de vida alta pero PIB bajo, como Costa Rica) mientras quedan rezagados en otras (por ejemplo, PIB alto pero vulnerabilidad ambiental, como algunos productores de petr√≥leo). El explorador revela estas heterogeneidades al visualizar que en algunas variables existe concentraci√≥n extrema (desv. est. \> 3x la media), mientras que en otras la dispersi√≥n es m√°s moderada, lo que puede indicar que el ACP identificar√° dimensiones donde la varianza es m√°xima y donde se concentra realmente la diferencia internacional.

## An√°lisis por Dimensiones

### Dimensi√≥n Econ√≥mica

A continuaci√≥n se examinan siete indicadores econ√≥micos complementarios mediante un explorador interactivo que permite visualizar din√°micamente los top 15 pa√≠ses en cada m√©trica. Haz click en cualquier bot√≥n de variable (PIB per c√°pita, Crecimiento PIB, Inversi√≥n Extranjera, Remesas, Industria, Exportaciones, Importaciones) para cambiar el ranking y observar c√≥mo la composici√≥n del liderazgo econ√≥mico global cambia radicalmente seg√∫n la dimensi√≥n analizada. Esta variabilidad espec√≠fica a cada variable econ√≥mica anticipa que el An√°lisis de Componentes Principales identificar√° factores latentes que sintetizan estas dimensiones de forma coherente, revelando la verdadera estructura de la diferenciaci√≥n econ√≥mica internacional.

Al seleccionar diferentes indicadores mediante los botones de variable, se modifica el orden de los pa√≠ses en el ranking. Este comportamiento evidencia que la posici√≥n relativa de cada pa√≠s var√≠a seg√∫n la m√©trica considerada, lo que refleja que el concepto de una ‚Äúeconom√≠a fuerte‚Äù puede adoptar significados distintos dependiendo del criterio de evaluaci√≥n utilizado.

```{r economia-top15-interactivo-MEJORADO, fig.height=7, fig.width=30, out.width="100%"}

preparar_top15 <- function(data, variable, nombre_var) {
  resultado <- data %>%
    filter(!is.na(!!sym(variable)) & !!sym(variable) > 0) %>%
    arrange(desc(!!sym(variable))) %>%
    slice_head(n = 15) %>%
    arrange(!!sym(variable)) %>%
    mutate(
      Pais_label = Pais,
      Valor = !!sym(variable),
      Nombre_Variable = nombre_var
    ) %>%
    select(Pais_label, Valor, Nombre_Variable)
  
  return(resultado)
}

vars_config <- list(
  list(var = "PIB_per", nombre = "PIB per c√°pita (US$)", color = "#00e676"),
  list(var = "Crecimiento PIB", nombre = "Crecimiento PIB (% anual)", color = "#0084ff"),
  list(var = "Inversion extranjera", nombre = "Inversi√≥n Extranjera Directa (% PIB)", color = "#ffd600"),
  list(var = "Remesas", nombre = "Remesas recibidas (% PIB)", color = "#a259ff"),
  list(var = "Industria", nombre = "Industria (% PIB)", color = "#ff6b00"),
  list(var = "Exportaciones", nombre = "Exportaciones (% PIB)", color = "#00e5ff"),
  list(var = "Importaciones", nombre = "Importaciones (% PIB)", color = "#ff1744")
)

datasets <- lapply(seq_along(vars_config), function(i) {
  config <- vars_config[[i]]
  preparar_top15(Base_2022, config$var, config$nombre)
})

p <- plot_ly()

for (i in seq_along(vars_config)) {
  config <- vars_config[[i]]
  
  if(nrow(datasets[[i]]) > 0) {
    p <- p %>%
      add_trace(
        x = datasets[[i]]$Valor,
        y = datasets[[i]]$Pais_label,
        type = 'bar',
        orientation = 'h',
        marker = list(
          color = config$color, 
          line = list(color = '#ffffff', width = 1.5)
        ),
        text = format(round(datasets[[i]]$Valor, 2), big.mark = ",", scientific = FALSE),
        textposition = 'outside',
        textfont = list(color = '#00e5ff', size = 13, family = "Arial"),
        customdata = datasets[[i]]$Nombre_Variable,
        hovertemplate = paste0(
          "<b style='color:#000000; font-size:14px; background-color:#ffffff; padding:5px; border-radius:3px;'>%{y}</b><br>",
          "<span style='color:#1a1a1a;'><b>%{customdata}:</b></span><br>",
          "<b style='color:#b35900; font-size:16px;'>%{x:.2f}</b>",
          "<extra></extra>"
        ),
        name = config$nombre,
        visible = (i == 1),
        showlegend = FALSE
      )
  }
}

p %>%
  layout(
    title = list(
      text = paste0(
        "<b style='color:#00e5ff; font-size:24px;'>Figura 1: Top 15 Pa√≠ses - ", 
        vars_config[[1]]$nombre, 
        "</b><br>",
        "<span style='color:#8b92a0; font-size:14px;'>A√±o 2022 | Selecciona una variable para cambiar</span>"
      ),
      x = 0.5,
      xanchor = 'center',
      y = 0.95
    ),
    xaxis = list(
      title = paste0("<b style='font-size:16px;'>", vars_config[[1]]$nombre, "</b>"),
      gridcolor = '#12161f',
      showgrid = TRUE,
      zeroline = TRUE,
      zerolinewidth = 2,
      zerolinecolor = "rgba(0, 229, 255, 0.5)",
      tickfont = list(color = '#8b92a0', size = 13),
      titlefont = list(color = '#e0e6ed', size = 16),
      range = c(0, max(datasets[[1]]$Valor) * 1.15)
    ),
    
    yaxis = list(
      title = "<b style='font-size:16px;'>Pa√≠s</b>",
      tickfont = list(color = '#e0e6ed', size = 13),
      titlefont = list(color = '#e0e6ed', size = 16),
      categoryorder = "array",
      categoryarray = rev(datasets[[1]]$Pais_label),
      automargin = TRUE
    ),
    plot_bgcolor = '#000000',
    paper_bgcolor = '#0a0e1a',
    font = list(family = "Arial, sans-serif", color = '#e0e6ed', size = 13),
    margin = list(l = 180, r = 50, b = 80, t = 120),
    hovermode = 'closest',
    hoverlabel = list(
      bgcolor = "#ffffff",
      bordercolor = "#00e5ff",
      font = list(color = "#000000", size = 13, family = "Arial")
    ),
    
    updatemenus = list(
      list(
        buttons = lapply(seq_along(vars_config), function(i) {
          config <- vars_config[[i]]
          
          visible <- rep(FALSE, length(vars_config))
          visible[i] <- TRUE
          
          list(
            label = strsplit(config$nombre, " \\(")[[1]][1],
            method = "update",
            args = list(
              list(visible = visible),
              list(
                title = paste0(
                  "<b style='color:#00e5ff; font-size:24px;'>Figura 1: top 15 Pa√≠ses - ", 
                  config$nombre, 
                  "</b><br>",
                  "<span style='color:#8b92a0; font-size:14px;'>A√±o 2022 | Selecciona una variable para cambiar</span>"
                ),
                "xaxis.title" = paste0("<b style='font-size:16px;'>", config$nombre, "</b>"),
                "xaxis.range" = c(0, max(datasets[[i]]$Valor) * 1.15),
                "yaxis.categoryarray" = rev(datasets[[i]]$Pais_label)
              )
            )
          )
        }),
        
        direction = "down",
        pad = list(r = 10, t = 10),
        showactive = TRUE,
        x = 0.02,
        xanchor = "left",
        y = 1.02,
        yanchor = "bottom",
        bgcolor = "rgba(162, 89, 255, 0.25)",
        bordercolor = "#a259ff",
        borderwidth = 2,
        font = list(size = 12, color = "#a259ff", family = "Arial")
      )
    )
  ) %>%
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "top15_economia_2022",
      width = 1600,
      height = 900
    )
  )
```

El an√°lisis de los distintos indicadores revela una marcada heterogeneidad entre pa√≠ses. Aquellos que lideran en una m√©trica no necesariamente mantienen posiciones similares en otras. Por ejemplo, Noruega encabeza el PIB per c√°pita, mientras que el crecimiento econ√≥mico destaca en pa√≠ses distintos; Malta sobresale en inversi√≥n extranjera y Nepal en remesas.

Las econom√≠as europeas dominan en PIB per c√°pita, pero en crecimiento, inversi√≥n o remesas surgen pa√≠ses de otras regiones. Adem√°s, las magnitudes y dispersiones difieren entre variables, lo que sugiere que cada indicador refleja dimensiones particulares del desempe√±o econ√≥mico nacional.

### Dimensi√≥n Salud y Bienestar

La Figura 2 presenta la relaci√≥n bidimensional entre esperanza de vida al nacer y mortalidad infantil, dos indicadores fundamentales del desempe√±o sanitario global. Estos indicadores capturan realidades complementarias: mientras la esperanza de vida refleja el resultado acumulado de mejoras en salud a lo largo de toda la vida, la mortalidad infantil es particularmente sensible a la calidad inmediata de la atenci√≥n materno-infantil, acceso a saneamiento e infraestructura b√°sica (WHO, 2020).

El gr√°fico interactivo es especialmente informativo: al pasar el cursor sobre cada punto (pa√≠s), se despliegan simult√°neamente tres dimensiones de salud‚Äîesperanza de vida, mortalidad infantil y gasto p√∫blico en salud‚Äîpermitiendo identificar si los pa√≠ses con mejor desempe√±o en longevidad genuinamente invierten recursos en su sistema de salud o si tienen patrones an√≥malos.

```{r ev-mi-animado, fig.height=8, fig.width=28, out.width="100%"}

asignar_continentes <- function(data) {
  continentes_map <- c(
    "Argentina" = "Americas", "Bahamas, The" = "Americas", "Barbados" = "Americas",
    "Belize" = "Americas", "Bolivia" = "Americas", "Brazil" = "Americas",
    "Canada" = "Americas", "Chile" = "Americas", "Colombia" = "Americas",
    "Costa Rica" = "Americas", "Cuba" = "Americas", "Dominica" = "Americas",
    "Dominican Republic" = "Americas", "Ecuador" = "Americas", "El Salvador" = "Americas",
    "Grenada" = "Americas", "Guatemala" = "Americas", "Guyana" = "Americas",
    "Haiti" = "Americas", "Honduras" = "Americas", "Jamaica" = "Americas",
    "Mexico" = "Americas", "Nicaragua" = "Americas", "Panama" = "Americas",
    "Paraguay" = "Americas", "Peru" = "Americas", "St. Kitts and Nevis" = "Americas",
    "St. Lucia" = "Americas", "St. Vincent and the Grenadines" = "Americas",
    "Suriname" = "Americas", "Trinidad and Tobago" = "Americas", "United States" = "Americas",
    "Uruguay" = "Americas", "Venezuela, RB" = "Americas", "Antigua and Barbuda" = "Americas",
    
    "Albania" = "Europe", "Austria" = "Europe", "Belarus" = "Europe",
    "Belgium" = "Europe", "Bosnia and Herzegovina" = "Europe", "Bulgaria" = "Europe",
    "Croatia" = "Europe", "Cyprus" = "Europe", "Czech Republic" = "Europe",
    "Czechia" = "Europe", "Denmark" = "Europe", "Estonia" = "Europe",
    "Finland" = "Europe", "France" = "Europe", "Germany" = "Europe",
    "Greece" = "Europe", "Hungary" = "Europe", "Iceland" = "Europe",
    "Ireland" = "Europe", "Italy" = "Europe", "Kosovo" = "Europe",
    "Latvia" = "Europe", "Lithuania" = "Europe", "Luxembourg" = "Europe",
    "Malta" = "Europe", "Montenegro" = "Europe", "Netherlands" = "Europe",
    "North Macedonia" = "Europe", "Norway" = "Europe", "Poland" = "Europe",
    "Portugal" = "Europe", "Russian Federation" = "Europe", "Serbia" = "Europe",
    "Slovak Republic" = "Europe", "Slovakia" = "Europe", "Slovenia" = "Europe",
    "Spain" = "Europe", "Sweden" = "Europe", "Switzerland" = "Europe",
    "Turkey" = "Europe", "Turkiye" = "Europe", "Ukraine" = "Europe",
    "United Kingdom" = "Europe", "Armenia" = "Europe", "Azerbaijan" = "Europe",
    "Georgia" = "Europe", "Moldova" = "Europe", "Romania" = "Europe",
    "San Marino" = "Europe",
    
    "Afghanistan" = "Asia", "Bahrain" = "Asia", "Bangladesh" = "Asia",
    "Bhutan" = "Asia", "Brunei Darussalam" = "Asia", "Cambodia" = "Asia",
    "China" = "Asia", "Hong Kong SAR, China" = "Asia", "India" = "Asia",
    "Indonesia" = "Asia", "Iran, Islamic Rep." = "Asia", "Iraq" = "Asia",
    "Israel" = "Asia", "Japan" = "Asia", "Jordan" = "Asia",
    "Kazakhstan" = "Asia", "Korea, Dem. People's rep." = "Asia", "Korea, Rep." = "Asia",
    "Kuwait" = "Asia", "Kyrgyz Republic" = "Asia", "Lao PDR" = "Asia",
    "Lebanon" = "Asia", "Macao SAR, China" = "Asia", "Malaysia" = "Asia",
    "Maldives" = "Asia", "Mongolia" = "Asia", "Myanmar" = "Asia",
    "Nepal" = "Asia", "Oman" = "Asia", "Pakistan" = "Asia",
    "Philippines" = "Asia", "Qatar" = "Asia", "Saudi Arabia" = "Asia",
    "Singapore" = "Asia", "Sri Lanka" = "Asia", "Syrian Arab Republic" = "Asia",
    "Taiwan" = "Asia", "Tajikistan" = "Asia", "Thailand" = "Asia",
    "Timor-Leste" = "Asia", "Turkmenistan" = "Asia", "United Arab Emirates" = "Asia",
    "Uzbekistan" = "Asia", "Vietnam" = "Asia", "Viet Nam" = "Asia",
    "West Bank and Gaza" = "Asia", "Yemen, Rep." = "Asia",
    
    "Algeria" = "Africa", "Angola" = "Africa", "Benin" = "Africa",
    "Botswana" = "Africa", "Burkina Faso" = "Africa", "Burundi" = "Africa",
    "Cabo Verde" = "Africa", "Cameroon" = "Africa", "Central African Republic" = "Africa",
    "Chad" = "Africa", "Comoros" = "Africa", "Congo, Dem. Rep." = "Africa",
    "Congo, Rep." = "Africa", "Cote d'Ivoire" = "Africa", "Djibouti" = "Africa",
    "Egypt, Arab Rep." = "Africa", "Equatorial Guinea" = "Africa", "Eritrea" = "Africa",
    "Eswatini" = "Africa", "Ethiopia" = "Africa", "Gabon" = "Africa",
    "Gambia, The" = "Africa", "Ghana" = "Africa", "Guinea" = "Africa",
    "Guinea-Bissau" = "Africa", "Kenya" = "Africa", "Lesotho" = "Africa",
    "Liberia" = "Africa", "Libya" = "Africa", "Madagascar" = "Africa",
    "Malawi" = "Africa", "Mali" = "Africa", "Mauritania" = "Africa",
    "Mauritius" = "Africa", "Morocco" = "Africa", "Mozambique" = "Africa",
    "Namibia" = "Africa", "Niger" = "Africa", "Nigeria" = "Africa",
    "Rwanda" = "Africa", "Senegal" = "Africa", "Sierra Leone" = "Africa",
    "Somnia" = "Africa", "South Africa" = "Africa", "South Sudan" = "Africa",
    "Sudan" = "Africa", "Tanzania" = "Africa", "Togo" = "Africa",
    "Tunisia" = "Africa", "Uganda" = "Africa", "Zambia" = "Africa",
    "Zimbabwe" = "Africa",
    
    "Australia" = "Oceania", "Fiji" = "Oceania", "Kiribati" = "Oceania",
    "Marshall Islands" = "Oceania", "Micronesia, Fed. Sts." = "Oceania",
    "New Zealand" = "Oceania", "Palau" = "Oceania", "Samoa" = "Oceania",
    "Solomon Islands" = "Oceania", "Tonga" = "Oceania", "Vanuatu" = "Oceania"
  )
  
  data %>%
    mutate(Continente = ifelse(Pais %in% names(continentes_map),
                                continentes_map[Pais], NA))
}

datos_ev_mi <- Base_2022 %>%
  asignar_continentes() %>%
  filter(!is.na(`Esperanza vida`) & 
         !is.na(`Mortalidad infantil`) & 
         !is.na(`Gasto salud`) &
         !is.na(Continente)) %>%
  select(Pais, Continente, `Esperanza vida`, `Mortalidad infantil`, `Gasto salud`) %>%
  mutate(
    tooltip = paste0(
      "<b style='font-size:14px; color:#00e5ff;'>", Pais, "</b><br>",
      "<span style='color:#a259ff; font-size:11px;'>", Continente, "</span><br><br>",
      "<b style='color:#ffd600;'> INDICADORES DE SALUD:</b><br>",
      "‚îú‚îÄ Esperanza de vida: <b style='color:#00e676;'>", 
      round(`Esperanza vida`, 1), " a√±os</b><br>",
      "‚îú‚îÄ Mortalidad infantil: <b style='color:#ff1744;'>", 
      round(`Mortalidad infantil`, 1), "/1,000</b><br>",
      "‚îî‚îÄ Gasto en salud: <b style='color:#ffd600;'>", 
      round(`Gasto salud`, 2), "% PIB</b>"
    )
  )

p <- plot_ly(
  data = datos_ev_mi,
  x = ~`Esperanza vida`,
  y = ~`Mortalidad infantil`,
  color = ~Continente,
  colors = c(
    "Americas" = "green",
    "Europe" = "#0084ff",
    "Asia" = "#ffd600",
    "Africa" = "#ff1744",
    "Oceania" = "#a259ff"
  ),
  type = 'scatter',
  mode = 'markers',
  customdata = ~tooltip,
  hovertemplate = "%{customdata}<extra></extra>",
  marker = list(
    size = 14,
    opacity = 0.9,
    line = list(color = '#ffffff', width = 2)
  ),
  showlegend = TRUE
) %>%
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:24px;'>Figura 2: Esperanza de Vida vs Mortalidad Infantil</b><br>
               <span style='color:#8b92a0; font-size:14px;'>A√±o 2022 | Relaci√≥n inversa: mejor salud = mayor EV y menor MI</span>",
      x = 0.5,
      xanchor = 'center',
      y = 0.95
    ),
    
    xaxis = list(
      title = "<b style='font-size:16px;'>Esperanza de vida al nacer (a√±os)</b>",
      gridcolor = '#12161f',
      showgrid = TRUE,
      zeroline = FALSE,
      range = c(40, 90),  # Rango m√°s amplio
      tickfont = list(color = '#8b92a0', size = 13),
      titlefont = list(color = '#e0e6ed', size = 16)
    ),
    
    yaxis = list(
      title = "<b style='font-size:16px;'>Mortalidad infantil (por 1,000 nacidos vivos)</b>",
      gridcolor = '#12161f',
      showgrid = TRUE,
      zeroline = FALSE,
      range = c(0, 110),
      tickfont = list(color = '#8b92a0', size = 13),
      titlefont = list(color = '#e0e6ed', size = 16)
    ),
    
    plot_bgcolor = '#000000',
    paper_bgcolor = '#0a0e1a',
    font = list(family = "Arial, sans-serif", color = '#e0e6ed', size = 13),
    
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 12, family = "Arial")
    ),
    
    legend = list(
      title = list(text = "<b style='font-size:14px;'>Continente</b>", font = list(size = 14, color = "#00e5ff")),
      bgcolor = 'rgba(10,14,26,0.95)',
      bordercolor = '#00e5ff',
      borderwidth = 2,
      x = 0.99,  
      y = 0.99,  
      xanchor = "right",
      yanchor = "top",
      font = list(size = 13, color = "#e0e6ed")
    ),
    
    margin = list(l = 80, r = 120, b = 60, t = 100),  
    
    hovermode = 'closest',
    

    shapes = list(

      list(
        type = "rect",
        x0 = 75, x1 = 90,
        y0 = 0, y1 = 15,
        xref = "x", yref = "y",
        fillcolor = "rgba(0, 230, 118, 0.15)",
        line = list(color = "rgba(0, 230, 118, 0.7)", width = 2.5, dash = "dot"),
        layer = "below"
      ),
      
      list(
        type = "rect",
        x0 = 40, x1 = 65,
        y0 = 40, y1 = 110,
        xref = "x", yref = "y",
        fillcolor = "rgba(255, 23, 68, 0.15)",
        line = list(color = "rgba(255, 23, 68, 0.7)", width = 2.5, dash = "dot"),
        layer = "below"
      )
    ),
    
    annotations = list(
      list(
        x = 82.5, 
        y = 25,  
        text = "<b style='color:#00e676; font-size:13px;'>‚úì ZONA √ìPTIMA</b><br><span style='color:#00e676; font-size:11px;'>Alta EV + Baja MI</span>",
        showarrow = FALSE,
        bgcolor = "rgba(0, 230, 118, 0.25)",
        bordercolor = "#00e676",
        borderwidth = 2,
        borderpad = 8,
        font = list(size = 11),
        xanchor = "center"
      ),
      
      list(
        x = 52.5, 
        y = 95, 
        text = "<b style='color:#ff1744; font-size:13px;'>‚ö† ZONA CR√çTICA</b><br><span style='color:#ff1744; font-size:11px;'>Baja EV + Alta MI</span>",
        showarrow = FALSE,
        bgcolor = "rgba(255, 23, 68, 0.25)",
        bordercolor = "#ff1744",
        borderwidth = 2,
        borderpad = 8,
        font = list(size = 11),
        xanchor = "center"
      ),
      
      list(
        x = 0.02,
        y = -0.12,
        text = "<span style='color:#8b92a0; font-size:11px;'>Cada punto representa un pa√≠s | Arrastra para zoom | Doble click para resetear</span>",
        showarrow = FALSE,
        xref = "paper",
        yref = "paper",
        xanchor = "left"
      ),
      
      list(
        x = 0.98,
        y = -0.12,
        text = "<span style='color:#8b92a0; font-size:11px;'>Correlaci√≥n inversa fuerte: r = ~ -0.85</span>",
        showarrow = FALSE,
        xref = "paper",
        yref = "paper",
        xanchor = "right"
      )
    )
  ) %>%
  
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "salud_poblacional_2022",
      width = 1800,  # Mayor resoluci√≥n
      height = 1000
    )
  )

p
```

La gr√°fica evidencia una segregaci√≥n geogr√°fica pronunciada: los paises Europa y Ocean√≠a se concentran casi completamente en la zona √≥ptima, formando un grupo de alta longevidad y baja mortalidad infantil. En contraste, muchos paises de √Åfrica ocupan predominantemente la zona cr√≠tica, con esperanza de vida entre 50-65 a√±os y mortalidad infantil superior a 30 por mil nacidos vivos. Los paises de Am√©rica exhiben una distribuci√≥n intermedia con variabilidad interna significativa: mientras algunos pa√≠ses rondan los 75 a√±os de EV, otros permanecen por debajo de 70. Los Asiaticos destacan por su extrema heterogeneidad: naciones desarrolladas se ubican en la zona √≥ptima, mientras casos como Pakistan ilustran c√≥mo pa√≠ses asi√°ticos pueden enfrentar desaf√≠os sanitarios comparables a contextos africanos, a pesar de perfiles econ√≥micos distintos.

La marcada relaci√≥n inversa evidencia que los sistemas de salud m√°s robustos logran simult√°neamente aumentar longevidad y reducir mortalidad infantil, se√±alando que ambas variables capturan la misma realidad subyacente: la calidad y accesibilidad de servicios sanitarios fundamentales.

### Dimensi√≥n Tecnol√≥gica y de Conectividad

La conectividad digital es un mecanismo contempor√°neo fundamental de inclusi√≥n econ√≥mica, pero no es unidimensional: requiere infraestructura energ√©tica (acceso a electricidad), conectividad inform√°tica (uso de internet) y penetraci√≥n m√≥vil (suscripciones por habitante). Estas variables son complementarias pero pueden desacoplarse‚Äîun pa√≠s puede tener electricidad universal pero baja adopci√≥n de internet, o inversamente, penetraci√≥n m√≥vil extraordinaria sin acceso el√©ctrico generalizado.

La Figura 3 desagrega estos indicadores en cinco paneles geogr√°ficos, donde el eje horizontal representa acceso a electricidad, el eje vertical uso de internet, y el tama√±o de cada burbuja codifica suscripciones m√≥viles. Una l√≠nea diagonal de referencia act√∫a como benchmark: pa√≠ses sobre ella tienen penetraci√≥n digital que compensa acceso el√©ctrico limitado; pa√≠ses bajo ella exhiben brechas donde energ√≠a no se traduce en conectividad inform√°tica. Al pasar el cursor sobre cada burbuja, se despliegan los tres indicadores de conectividad espec√≠ficos del pa√≠s y continente.

```{r scatter-facetado-tecnologia, fig.height=10, fig.width=14, out.width="90%"}

datos_scatter_gg <- Base_2022 %>%
  asignar_continentes() %>%
  filter(
    !is.na(`Acceso electricidad`) & 
    !is.na(`Uso internet`) & 
    !is.na(`Suscripciones movil`) &
    !is.na(Continente) &
    Continente != "Otros"
  ) %>%
  mutate(
    Electricidad = `Acceso electricidad`,
    Internet = `Uso internet`,
    Movil = `Suscripciones movil`,
    Continente = factor(Continente, 
      levels = c("Africa", "Americas", "Asia", "Europe", "Oceania"))
  ) %>%
  arrange(Continente)

p_gg <- ggplot(datos_scatter_gg, aes(x = Electricidad, y = Internet)) +
  geom_abline(
    intercept = 0, 
    slope = 1, 
    linetype = "dashed",
    color = "#00e5ff",
    linewidth = 1,
    alpha = 0.3
  ) +
  geom_point(
    aes(
      fill = Continente,
      size = Movil,
      text = paste0(
        "<b style='font-size:14px;'>", Pais, "</b><br>",
        "<span style='color:#a259ff; font-size:11px;'>", Continente, "</span><br><br>",
        "<b style='color:#ffd600;'> INDICADORES</b><br>",
        "‚îú‚îÄ üîå Electricidad: <b style='color:#00e676;'>", 
        round(Electricidad, 1), "%</b><br>",
        "‚îú‚îÄ üåê Internet: <b style='color:#00e5ff;'>", 
        round(Internet, 1), "%</b><br>",
        "‚îî‚îÄ üì± M√≥viles: <b style='color:#ffd600;'>", 
        round(Movil, 1), "/100 hab.</b>"
      )
    ),
    alpha = 0.78,
    shape = 19,
    color = NA
  ) +
  scale_size_continuous(
    name = "Suscripciones M√≥viles\n(por 100 hab.)",
    range = c(2, 10),
    breaks = c(20, 50, 100, 150),
    labels = c("20", "50", "100", "150+")
  ) +
  geom_text_repel(
    aes(label = Pais),
    size = 2.8,
    color = "#e0e6ed",
    max.overlaps = 20,
    segment.color = "#00e5ff",
    segment.alpha = 0.3,
    segment.size = 0.3
  ) +
  facet_wrap(~Continente, ncol = 3) +
  scale_fill_manual(
    name = "Continente",
    values = c(
      "Africa" = "#ff1744",
      "Americas" = "#00e676",
      "Asia" = "#ffd600",
      "Europe" = "#0084ff",
      "Oceania" = "#a259ff"
    )
  ) +
  scale_x_continuous(limits = c(0, 105), breaks = seq(0, 100, 20)) +
  scale_y_continuous(limits = c(0, 105), breaks = seq(0, 100, 20)) +
  labs(
    title = " Figura 3: Infraestructura Digital",
    subtitle = "A√±o 2022 | Tama√±o de burbuja = Suscripciones M√≥viles (por 100 hab)",
    x = "Acceso a Electricidad (% poblaci√≥n)",
    y = "Uso de Internet (% poblaci√≥n)"
  ) +
  theme_minimal(base_size = 11) +
  theme(
    plot.background = element_rect(fill = "#000000", color = NA),
    panel.background = element_rect(fill = "#0a0e1a", color = NA),
    panel.grid.major = element_line(color = "#12161f", linewidth = 0.3),
    panel.grid.minor = element_line(color = "#12161f", linewidth = 0.2),
    
    plot.title = element_text(
      color = "#00e5ff",
      face = "bold",
      size = 16,
      hjust = 0.5,
      margin = margin(b = 8)
    ),
    plot.subtitle = element_text(
      color = "#8b92a0",
      size = 11,
      hjust = 0.5,
      margin = margin(b = 15),
      lineheight = 1.2,
      face = "italic"
    ),
    
    axis.title = element_text(
      color = "#e0e6ed",
      face = "bold",
      size = 11
    ),
    axis.text = element_text(color = "#8b92a0", size = 10),
    axis.line = element_line(color = "#00e5ff", linewidth = 0.4),
    
    strip.text = element_text(
      color = "#00e5ff",
      face = "bold",
      size = 12,
      margin = margin(b = 8)
    ),
    strip.background = element_rect(
      fill = "#1a1a3e",
      color = "#00e5ff",
      linewidth = 1.2
    ),
    
    legend.background = element_rect(
      fill = "#0a0e1a",
      color = "#00e5ff",
      linewidth = 1.2
    ),
    legend.text = element_text(color = "#e0e6ed", size = 11),
    legend.title = element_text(color = "#00e5ff", face = "bold", size = 12),
    legend.key = element_rect(fill = "#0a0e1a", color = NA),
    legend.key.size = unit(0.8, "cm"),
    legend.position = "right",
    legend.box = "vertical",
    legend.spacing.y = unit(0.5, "cm"),
    legend.margin = margin(10, 10, 10, 10),
    
    plot.margin = margin(15, 15, 15, 15)
  )

plotly_plot <- ggplotly(p_gg, tooltip = "text") %>%
  layout(
    legend = list(
      title = list(text = "<b>Continente</b>"),
      font = list(color = "#e0e6ed", size = 11),
      bgcolor = "rgba(10, 14, 26, 0.9)",
      bordercolor = "#00e5ff",
      borderwidth = 1,
      x = 1.05,
      y = 0.8,
      traceorder = "normal"
    ),
    annotations = list(
      list(
        x = 1.05,
        y = 0.45,
        xref = "paper",
        yref = "paper",
        text = "<b style='color:#00e5ff; font-size:12px;'>Suscripciones M√≥viles</b>",
        showarrow = FALSE,
        xanchor = "left",
        yanchor = "middle",
        font = list(size = 12, color = "#00e5ff")
      ),
      list(
        x = 1.02,
        y = 0.4,
        xref = "paper",
        yref = "paper",
        text = "‚óè",
        showarrow = FALSE,
        xanchor = "center",
        yanchor = "middle",
        font = list(size = 15, color = "#8b92a0")
      ),
      list(
        x = 1.08,
        y = 0.4,
        xref = "paper",
        yref = "paper",
        text = "20",
        showarrow = FALSE,
        xanchor = "left",
        yanchor = "middle",
        font = list(size = 10, color = "#e0e6ed")
      ),
      list(
        x = 1.02,
        y = 0.35,
        xref = "paper",
        yref = "paper",
        text = "‚óè",
        showarrow = FALSE,
        xanchor = "center",
        yanchor = "middle",
        font = list(size = 20, color = "#8b92a0")
      ),
      list(
        x = 1.08,
        y = 0.35,
        xref = "paper",
        yref = "paper",
        text = "50",
        showarrow = FALSE,
        xanchor = "left",
        yanchor = "middle",
        font = list(size = 10, color = "#e0e6ed")
      ),
      list(
        x = 1.02,
        y = 0.3,
        xref = "paper",
        yref = "paper",
        text = "‚óè",
        showarrow = FALSE,
        xanchor = "center",
        yanchor = "middle",
        font = list(size = 25, color = "#8b92a0")
      ),
      list(
        x = 1.08,
        y = 0.3,
        xref = "paper",
        yref = "paper",
        text = "100",
        showarrow = FALSE,
        xanchor = "left",
        yanchor = "middle",
        font = list(size = 10, color = "#e0e6ed")
      ),
      list(
        x = 1.02,
        y = 0.25,
        xref = "paper",
        yref = "paper",
        text = "‚óè",
        showarrow = FALSE,
        xanchor = "center",
        yanchor = "middle",
        font = list(size = 30, color = "#8b92a0")
      ),
      list(
        x = 1.08,
        y = 0.25,
        xref = "paper",
        yref = "paper",
        text = "150+",
        showarrow = FALSE,
        xanchor = "left",
        yanchor = "middle",
        font = list(size = 10, color = "#e0e6ed")
      ),
      list(
        x = 1.05,
        y = 0.18,
        xref = "paper",
        yref = "paper",
        text = "<span style='color:#8b92a0; font-size:10px;'>(por 100 habitantes)</span>",
        showarrow = FALSE,
        xanchor = "left",
        yanchor = "middle"
      )
    ),
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 12, family = "Arial")
    ),
    font = list(family = "Arial", color = "#e0e6ed"),
    margin = list(l = 50, r = 200, b = 50, t = 100)
  ) %>%
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "infraestructura_digital_final",
      width = 1200,
      height = 800
    )
  )

plotly_plot <- plotly_plot %>%
  style(showlegend = FALSE, traces = c(2:6))

plotly_plot
```

En √Åfrica, pa√≠ses como N√≠ger y Mali se concentran en el cuadrante inferior izquierdo (20-40% electricidad, 10-30% internet), aunque Marruecos emerge como outlier con 100% acceso el√©ctrico y 89.9% internet, demostrando que la universalizaci√≥n es viable. En Europa, Suecia y Noruega ocupan la esquina superior derecha con universalizaci√≥n el√©ctrica, internet penetrante (95-100%) y saturaci√≥n m√≥vil (100+ suscripciones/100 hab.). Am√©rica presenta electricidad generalizada (80-95%) pero internet variable (50-80%), indicando que infraestructura energ√©tica no garantiza autom√°ticamente adopci√≥n digital sin inversi√≥n espec√≠fica en telecomunicaciones. Asia destaca por su extrema heterogeneidad: mientras Jap√≥n y Singapur se alinean con econom√≠as desarrolladas, Bangladesh y Pakist√°n enfrentan limitaciones m√°s severas. Notablemente, pa√≠ses asi√°ticos como India y Filipinas exhiben penetraci√≥n m√≥vil extraordinaria (120-140 suscripciones/100 hab.) a pesar de acceso el√©ctrico limitado, evidenciando que la telefon√≠a m√≥vil ha permitido saltos tecnol√≥gicos sin requerir infraestructura fija completa.

### Dimension ambiental y de recursos

La Figura 4 muestra c√≥mo los pa√≠ses distribuyen su territorio entre bosques y tierras cultivables, dos recursos fundamentales para conservaci√≥n ambiental y seguridad alimentaria. El eje horizontal mide cobertura boscosa, el eje vertical tierra cultivable, y el gr√°fico divide el espacio en cuatro zonas: conservaci√≥n (muchos bosques, poca agricultura), agr√≠cola (mucha agricultura, pocos bosques), balance (ambas moderadas), y cr√≠tica (ambas limitadas). Al pasar el cursor sobre cada punto, aparece informaci√≥n del pa√≠s: porcentaje de cobertura boscosa, porcentaje de tierra cultivable, el balance total entre ambas, y tama√±o de poblaci√≥n. Esto permite ver c√≥mo el uso de tierra var√≠a seg√∫n demograf√≠a: India concentra alta agricultura (51.8% tierra cultivable) y baja cobertura boscosa, reflejando presi√≥n por alimentar su enorme poblaci√≥n. Brasil y Bolivia se ubican en zona de balance con mayor cobertura forestal. Mauritania y Eritrea ocupan la zona cr√≠tica, con recursos limitados tanto para bosques como para agricultura. En la leyenda al hacer clic en un continente, el gr√°fico se filtra mostrando solo los pa√≠ses de esa regi√≥n, permitiendo comparar patrones ambientales dentro de cada geograf√≠a. Esta visualizaci√≥n anticipa si la conservaci√≥n ambiental es un lujo de pa√≠ses ricos o una estrategia viable en todos los contextos.

```{r ambiental-scatter, fig.height=8, fig.width=25, out.width="100%"}

asignar_continentes <- function(data) {
  continentes_map <- c(
    "Argentina" = "Americas", "Bahamas, The" = "Americas", "Barbados" = "Americas",
    "Belize" = "Americas", "Bolivia" = "Americas", "Brazil" = "Americas",
    "Canada" = "Americas", "Chile" = "Americas", "Colombia" = "Americas",
    "Costa Rica" = "Americas", "Cuba" = "Americas", "Dominica" = "Americas",
    "Dominican Republic" = "Americas", "Ecuador" = "Americas", "El Salvador" = "Americas",
    "Grenada" = "Americas", "Guatemala" = "Americas", "Guyana" = "Americas",
    "Haiti" = "Americas", "Honduras" = "Americas", "Jamaica" = "Americas",
    "Mexico" = "Americas", "Nicaragua" = "Americas", "Panama" = "Americas",
    "Paraguay" = "Americas", "Peru" = "Americas", "St. Kitts and Nevis" = "Americas",
    "St. Lucia" = "Americas", "St. Vincent and the Grenadines" = "Americas",
    "Suriname" = "Americas", "Trinidad and Tobago" = "Americas", "United States" = "Americas",
    "Uruguay" = "Americas", "Venezuela, RB" = "Americas", "Antigua and Barbuda" = "Americas",
    
    "Albania" = "Europe", "Austria" = "Europe", "Belarus" = "Europe",
    "Belgium" = "Europe", "Bosnia and Herzegovina" = "Europe", "Bulgaria" = "Europe",
    "Croatia" = "Europe", "Cyprus" = "Europe", "Czech Republic" = "Europe",
    "Czechia" = "Europe", "Denmark" = "Europe", "Estonia" = "Europe",
    "Finland" = "Europe", "France" = "Europe", "Germany" = "Europe",
    "Greece" = "Europe", "Hungary" = "Europe", "Iceland" = "Europe",
    "Ireland" = "Europe", "Italy" = "Europe", "Kosovo" = "Europe",
    "Latvia" = "Europe", "Lithuania" = "Europe", "Luxembourg" = "Europe",
    "Malta" = "Europe", "Montenegro" = "Europe", "Netherlands" = "Europe",
    "North Macedonia" = "Europe", "Norway" = "Europe", "Poland" = "Europe",
    "Portugal" = "Europe", "Russian Federation" = "Europe", "Serbia" = "Europe",
    "Slovak Republic" = "Europe", "Slovakia" = "Europe", "Slovenia" = "Europe",
    "Spain" = "Europe", "Sweden" = "Europe", "Switzerland" = "Europe",
    "Turkey" = "Europe", "Turkiye" = "Europe", "Ukraine" = "Europe",
    "United Kingdom" = "Europe", "Armenia" = "Europe", "Azerbaijan" = "Europe",
    "Georgia" = "Europe", "Moldova" = "Europe", "Romania" = "Europe",
    "San Marino" = "Europe",
    
    "Afghanistan" = "Asia", "Bahrain" = "Asia", "Bangladesh" = "Asia",
    "Bhutan" = "Asia", "Brunei Darussalam" = "Asia", "Cambodia" = "Asia",
    "China" = "Asia", "Hong Kong SAR, China" = "Asia", "India" = "Asia",
    "Indonesia" = "Asia", "Iran, Islamic Rep." = "Asia", "Iraq" = "Asia",
    "Israel" = "Asia", "Japan" = "Asia", "Jordan" = "Asia",
    "Kazakhstan" = "Asia", "Korea, Dem. People's rep." = "Asia", "Korea, Rep." = "Asia",
    "Kuwait" = "Asia", "Kyrgyz Republic" = "Asia", "Lao PDR" = "Asia",
    "Lebanon" = "Asia", "Macao SAR, China" = "Asia", "Malaysia" = "Asia",
    "Maldives" = "Asia", "Mongolia" = "Asia", "Myanmar" = "Asia",
    "Nepal" = "Asia", "Oman" = "Asia", "Pakistan" = "Asia",
    "Philippines" = "Asia", "Qatar" = "Asia", "Saudi Arabia" = "Asia",
    "Singapore" = "Asia", "Sri Lanka" = "Asia", "Syrian Arab Republic" = "Asia",
    "Taiwan" = "Asia", "Tajikistan" = "Asia", "Thailand" = "Asia",
    "Timor-Leste" = "Asia", "Turkmenistan" = "Asia", "United Arab Emirates" = "Asia",
    "Uzbekistan" = "Asia", "Vietnam" = "Asia", "Viet Nam" = "Asia",
    "West Bank and Gaza" = "Asia", "Yemen, Rep." = "Asia",
    
    "Algeria" = "Africa", "Angola" = "Africa", "Benin" = "Africa",
    "Botswana" = "Africa", "Burkina Faso" = "Africa", "Burundi" = "Africa",
    "Cabo Verde" = "Africa", "Cameroon" = "Africa", "Central African Republic" = "Africa",
    "Chad" = "Africa", "Comoros" = "Africa", "Congo, Dem. Rep." = "Africa",
    "Congo, Rep." = "Africa", "Cote d'Ivoire" = "Africa", "Djibouti" = "Africa",
    "Egypt, Arab Rep." = "Africa", "Equatorial Guinea" = "Africa", "Eritrea" = "Africa",
    "Eswatini" = "Africa", "Ethiopia" = "Africa", "Gabon" = "Africa",
    "Gambia, The" = "Africa", "Ghana" = "Africa", "Guinea" = "Africa",
    "Guinea-Bissau" = "Africa", "Kenya" = "Africa", "Lesotho" = "Africa",
    "Liberia" = "Africa", "Libya" = "Africa", "Madagascar" = "Africa",
    "Malawi" = "Africa", "Mali" = "Africa", "Mauritania" = "Africa",
    "Mauritius" = "Africa", "Morocco" = "Africa", "Mozambique" = "Africa",
    "Namibia" = "Africa", "Niger" = "Africa", "Nigeria" = "Africa",
    "Rwanda" = "Africa", "Senegal" = "Africa", "Sierra Leone" = "Africa",
    "Somalia" = "Africa", "South Africa" = "Africa", "South Sudan" = "Africa",
    "Sudan" = "Africa", "Tanzania" = "Africa", "Togo" = "Africa",
    "Tunisia" = "Africa", "Uganda" = "Africa", "Zambia" = "Africa",
    "Zimbabwe" = "Africa",
    
    "Australia" = "Oceania", "Fiji" = "Oceania", "Kiribati" = "Oceania",
    "Marshall Islands" = "Oceania", "Micronesia, Fed. Sts." = "Oceania",
    "New Zealand" = "Oceania", "Palau" = "Oceania", "Samoa" = "Oceania",
    "Solomon Islands" = "Oceania", "Tonga" = "Oceania", "Vanuatu" = "Oceania"
  )
  
  data %>%
    mutate(Continente = ifelse(Pais %in% names(continentes_map),
                                continentes_map[Pais], NA))
}

datos_ambiental <- Base_2022 %>%
  asignar_continentes() %>%
  filter(
    !is.na(`Area boscosa`) & 
    !is.na(`Tierra cultivable`) & 
    !is.na(Poblacion) &
    !is.na(Continente)
  ) %>%
  select(
    Pais, Continente,
    `Area boscosa`,
    `Tierra cultivable`,
    Poblacion
  ) %>%
  mutate(
    tooltip = paste0(
      "<b style='font-size:14px; color:#00e5ff;'>", Pais, "</b><br>",
      "<span style='color:#a259ff; font-size:11px;'>", Continente, "</span><br><br>",
      "<b style='color:#ffd600;'> USO DE TIERRA:</b><br>",
      "‚îú‚îÄ √Årea Boscosa: <b style='color:#00e676;'>", 
      round(`Area boscosa`, 1), "%</b><br>",
      "‚îú‚îÄ Tierra Cultivable: <b style='color:#ffd600;'>", 
      round(`Tierra cultivable`, 1), "%</b><br>",
      "‚îú‚îÄ Balance: <b style='color:#00e5ff;'>", 
      round(`Area boscosa` + `Tierra cultivable`, 1), "% (bosque + cultivo)</b><br>",
      "‚îî‚îÄ Poblaci√≥n: <b style='color:#ff1744;'>", 
      format(round(Poblacion/1e6, 1), big.mark = ",", trim = TRUE), " M</b>"
    )
  )

color_map <- c(
  "Africa" = "#ff1744",
  "Americas" = "#00e676",
  "Asia" = "#ffd600",
  "Europe" = "#0084ff",
  "Oceania" = "#a259ff"
)

p <- plot_ly() %>%
  add_trace(
    data = datos_ambiental,
    x = ~`Area boscosa`,
    y = ~`Tierra cultivable`,
    color = ~Continente,
    colors = color_map,
    type = "scatter",
    mode = "markers",
    customdata = ~tooltip,
    hovertemplate = "%{customdata}<extra></extra>",
    marker = list(
      size = 12,  
      opacity = 0.8,
      line = list(
        color = "#ffffff", 
        width = 1.5   
      )
    ),
    showlegend = TRUE
  ) %>%
  
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:24px;'>Figura 4: Uso de la Tierra</b><br>
               <span style='color:#8b92a0; font-size:14px;'>A√±o 2022 | Balance entre conservaci√≥n y agricultura</span>",
      x = 0.5,
      xanchor = 'center',
      y = 0.95
    ),
    
    xaxis = list(
      title = "<b style='font-size:16px;'>√Årea Boscosa (% de tierra)</b>",
      gridcolor = '#12161f',
      showgrid = TRUE,
      zeroline = FALSE,
      tickfont = list(color = '#8b92a0', size = 13),
      titlefont = list(color = '#e0e6ed', size = 16),
      range = c(0, 100)
    ),
    
    yaxis = list(
      title = "<b style='font-size:16px;'>Tierra Cultivable (% de tierra)</b>",
      gridcolor = '#12161f',
      showgrid = TRUE,
      zeroline = FALSE,
      tickfont = list(color = '#8b92a0', size = 13),
      titlefont = list(color = '#e0e6ed', size = 16),
      range = c(0, 70)
    ),
    
    plot_bgcolor = '#000000',
    paper_bgcolor = '#0a0e1a',
    font = list(family = "Arial, sans-serif", color = '#e0e6ed', size = 13),
    
    legend = list(
      title = list(text = "<b style='font-size:14px;'>Continente</b>", font = list(size = 14, color = "#00e5ff")),
      bgcolor = 'rgba(10,14,26,0.95)',
      bordercolor = '#00e5ff',
      borderwidth = 1.5,
      x = 0.98, 
      y = 0.98,  
      xanchor = "right",
      yanchor = "top",
      font = list(size = 12, color = "#e0e6ed")
    ),
    
    margin = list(l = 100, r = 50, b = 120, t = 120),
    hovermode = 'closest',
    
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 12, family = "Arial")
    ),
    
    shapes = list(
      list(
        type = "rect",
        x0 = 60, x1 = 100,
        y0 = 0, y1 = 20,
        xref = "x", yref = "y",
        fillcolor = "rgba(0, 230, 118, 0.1)",
        line = list(color = "rgba(0, 230, 118, 0.6)", width = 2, dash = "dot"),
        layer = "below"
      ),
      list(
        type = "rect",
        x0 = 0, x1 = 30,
        y0 = 40, y1 = 70,
        xref = "x", yref = "y",
        fillcolor = "rgba(255, 214, 0, 0.1)",
        line = list(color = "rgba(255, 214, 0, 0.6)", width = 2, dash = "dot"),
        layer = "below"
      ),
      list(
        type = "rect",
        x0 = 30, x1 = 60,
        y0 = 20, y1 = 40,
        xref = "x", yref = "y",
        fillcolor = "rgba(0, 132, 255, 0.1)",
        line = list(color = "rgba(0, 132, 255, 0.6)", width = 2, dash = "dot"),
        layer = "below"
      ),
      list(
        type = "rect",
        x0 = 0, x1 = 30,
        y0 = 0, y1 = 20,
        xref = "x", yref = "y",
        fillcolor = "rgba(255, 23, 68, 0.1)",
        line = list(color = "rgba(255, 23, 68, 0.6)", width = 2, dash = "dot"),
        layer = "below"
      )
    ),
    
    annotations = list(
      list(
        x = 88, y = 10,
        text = "<b style='color:#00e676; font-size:12px;'>üå≤ CONSERVACI√ìN</b>",
        showarrow = FALSE,
        bgcolor = "rgba(0, 230, 118, 0.2)",
        bordercolor = "#00e676",
        borderwidth = 1.5,
        borderpad = 6,
        font = list(size = 11)
      ),
      list(
        x = 30, y = 65,
        text = "<b style='color:#ffd600; font-size:12px;'>üåæ AGR√çCOLA</b>",
        showarrow = FALSE,
        bgcolor = "rgba(255, 214, 0, 0.2)",
        bordercolor = "#ffd600",
        borderwidth = 1.5,
        borderpad = 6,
        font = list(size = 11)
      ),
      list(
        x = 60, y = 40,
        text = "<b style='color:#0084ff; font-size:12px;'>‚öñÔ∏è BALANCE</b>",
        showarrow = FALSE,
        bgcolor = "rgba(0, 132, 255, 0.2)",
        bordercolor = "#0084ff",
        borderwidth = 1.5,
        borderpad = 6,
        font = list(size = 11)
      ),
      list(
        x = 15, y = 20,
        text = "<b style='color:#ff1744; font-size:12px;'>‚ö†Ô∏è CR√çTICA</b>",
        showarrow = FALSE,
        bgcolor = "rgba(255, 23, 68, 0.2)",
        bordercolor = "#ff1744",
        borderwidth = 1.5,
        borderpad = 6,
        font = list(size = 10)
      ),
      
      list(
        x = 0.5, y = -0.15,
        xref = "paper", yref = "paper",
        text = "<span style='color:#8b92a0; font-size:12px;'>Verde = alta cobertura boscosa. Amarillo = alta agricultura. Equilibrio = desarrollo sostenible.</span>",
        showarrow = FALSE,
        xanchor = "center",
        yanchor = "top",
        font = list(size = 11, color = "#8b92a0")
      )
    )
  ) %>%
  
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "sostenibilidad_ambiental_2022",
      width = 1600,
      height = 1000
    )
  )

p

```

El gr√°fico revela una clara segregaci√≥n geogr√°fica en el uso de tierra: algunos pa√≠ses concentran la zona agr√≠cola con alta tierra cultivable pero baja cobertura boscosa, mientras otros ocupan la zona de balance manteniendo ambas variables moderadas. Europa tiende a distribuirse en la zona media-superior con mayor cobertura forestal, mientras que muchos pa√≠ses africanos se concentran en la zona cr√≠tica donde ambos recursos son limitados. La dispersi√≥n dentro de cada continente muestra variabilidad significativa, indicando que el uso de tierra no sigue un patr√≥n √∫nico sino que responde a din√°micas regionales espec√≠ficas. Esta visualizaci√≥n permite identificar que la presi√≥n ambiental‚Äîreflejada en el balance entre conservaci√≥n y agricultura‚Äîopera de formas distintas seg√∫n geograf√≠a, informaci√≥n que el an√°lisis multivariado posteriormente contextualizar√° dentro de la estructura general del desarrollo.

### Dimensi√≥n Demogr√°fica

La din√°mica poblacional condiciona fundamentalmente los desaf√≠os de desarrollo: presi√≥n sobre recursos, mercado laboral, demanda por servicios p√∫blicos y sostenibilidad fiscal. Esta figura examina simult√°neamente poblaci√≥n y crecimiento poblacional en los 60 pa√≠ses m√°s grandes, permitiendo visualizar si el crecimiento demogr√°fico genera oportunidades (dividendo demogr√°fico) o presiones cr√≠ticas (declive o sobrepoblaci√≥n).

Estructura del Gr√°fico: Cada rect√°ngulo representa un pa√≠s donde el tama√±o codifica poblaci√≥n total. El color codifica crecimiento poblacional anual: verde indica crecimiento alto (2%+, potencial dividendo demogr√°fico), amarillo transici√≥n moderada (0.5-2%), naranja-rojo crecimiento bajo o negativo (riesgo de declive poblacional). Al pasar el cursor sobre cada pa√≠s, aparecen simult√°neamente cinco indicadores demogr√°ficos y algunos de desarrollo para complementar: poblaci√≥n en millones, tasa de crecimiento anual, esperanza de vida, mortalidad infantil, y PIB per c√°pita. Tambi√©n se muestra la clasificaci√≥n demogr√°fica del pa√≠s (Dividendo Demogr√°fico, Madurez Estable o Declive Poblacional).

```{r treemap-oportunidades-riesgos, fig.height=9, fig.width=25, out.width="100%"}

asignar_continentes <- function(data) {
  continentes_map <- c(
    "Argentina" = "Americas", "Bahamas, The" = "Americas", "Barbados" = "Americas",
    "Belize" = "Americas", "Bolivia" = "Americas", "Brazil" = "Americas",
    "Canada" = "Americas", "Chile" = "Americas", "Colombia" = "Americas",
    "Costa Rica" = "Americas", "Cuba" = "Americas", "Dominica" = "Americas",
    "Dominican Republic" = "Americas", "Ecuador" = "Americas", "El Salvador" = "Americas",
    "Grenada" = "Americas", "Guatemala" = "Americas", "Guyana" = "Americas",
    "Haiti" = "Americas", "Honduras" = "Americas", "Jamaica" = "Americas",
    "Mexico" = "Americas", "Nicaragua" = "Americas", "Panama" = "Americas",
    "Paraguay" = "Americas", "Peru" = "Americas", "St. Kitts and Nevis" = "Americas",
    "St. Lucia" = "Americas", "St. Vincent and the Grenadines" = "Americas",
    "Suriname" = "Americas", "Trinidad and Tobago" = "Americas", "United States" = "Americas",
    "Uruguay" = "Americas", "Venezuela, RB" = "Americas", "Antigua and Barbuda" = "Americas",
    
    "Albania" = "Europe", "Austria" = "Europe", "Belarus" = "Europe",
    "Belgium" = "Europe", "Bosnia and Herzegovina" = "Europe", "Bulgaria" = "Europe",
    "Croatia" = "Europe", "Cyprus" = "Europe", "Czech Republic" = "Europe",
    "Czechia" = "Europe", "Denmark" = "Europe", "Estonia" = "Europe",
    "Finland" = "Europe", "France" = "Europe", "Germany" = "Europe",
    "Greece" = "Europe", "Hungary" = "Europe", "Iceland" = "Europe",
    "Ireland" = "Europe", "Italy" = "Europe", "Kosovo" = "Europe",
    "Latvia" = "Europe", "Lithuania" = "Europe", "Luxembourg" = "Europe",
    "Malta" = "Europe", "Montenegro" = "Europe", "Netherlands" = "Europe",
    "North Macedonia" = "Europe", "Norway" = "Europe", "Poland" = "Europe",
    "Portugal" = "Europe", "Russian Federation" = "Europe", "Serbia" = "Europe",
    "Slovak Republic" = "Europe", "Slovakia" = "Europe", "Slovenia" = "Europe",
    "Spain" = "Europe", "Sweden" = "Europe", "Switzerland" = "Europe",
    "Turkey" = "Europe", "Turkiye" = "Europe", "Ukraine" = "Europe",
    "United Kingdom" = "Europe", "Armenia" = "Europe", "Azerbaijan" = "Europe",
    "Georgia" = "Europe", "Moldova" = "Europe", "Romania" = "Europe",
    "San Marino" = "Europe",
    
    "Afghanistan" = "Asia", "Bahrain" = "Asia", "Bangladesh" = "Asia",
    "Bhutan" = "Asia", "Brunei Darussalam" = "Asia", "Cambodia" = "Asia",
    "China" = "Asia", "Hong Kong SAR, China" = "Asia", "India" = "Asia",
    "Indonesia" = "Asia", "Iran, Islamic Rep." = "Asia", "Iraq" = "Asia",
    "Israel" = "Asia", "Japan" = "Asia", "Jordan" = "Asia",
    "Kazakhstan" = "Asia", "Korea, Dem. People's rep." = "Asia", "Korea, Rep." = "Asia",
    "Kuwait" = "Asia", "Kyrgyz Republic" = "Asia", "Lao PDR" = "Asia",
    "Lebanon" = "Asia", "Macao SAR, China" = "Asia", "Malaysia" = "Asia",
    "Maldives" = "Asia", "Mongolia" = "Asia", "Myanmar" = "Asia",
    "Nepal" = "Asia", "Oman" = "Asia", "Pakistan" = "Asia",
    "Philippines" = "Asia", "Qatar" = "Asia", "Saudi Arabia" = "Asia",
    "Singapore" = "Asia", "Sri Lanka" = "Asia", "Syrian Arab Republic" = "Asia",
    "Taiwan" = "Asia", "Tajikistan" = "Asia", "Thailand" = "Asia",
    "Timor-Leste" = "Asia", "Turkmenistan" = "Asia", "United Arab Emirates" = "Asia",
    "Uzbekistan" = "Asia", "Vietnam" = "Asia", "Viet Nam" = "Asia",
    "West Bank and Gaza" = "Asia", "Yemen, Rep." = "Asia",
    
    "Algeria" = "Africa", "Angola" = "Africa", "Benin" = "Africa",
    "Botswana" = "Africa", "Burkina Faso" = "Africa", "Burundi" = "Africa",
    "Cabo Verde" = "Africa", "Cameroon" = "Africa", "Central African Republic" = "Africa",
    "Chad" = "Africa", "Comoros" = "Africa", "Congo, Dem. Rep." = "Africa",
    "Congo, Rep." = "Africa", "Cote d'Ivoire" = "Africa", "Djibouti" = "Africa",
    "Egypt, Arab Rep." = "Africa", "Equatorial Guinea" = "Africa", "Eritrea" = "Africa",
    "Eswatini" = "Africa", "Ethiopia" = "Africa", "Gabon" = "Africa",
    "Gambia, The" = "Africa", "Ghana" = "Africa", "Guinea" = "Africa",
    "Guinea-Bissau" = "Africa", "Kenya" = "Africa", "Lesotho" = "Africa",
    "Liberia" = "Africa", "Libya" = "Africa", "Madagascar" = "Africa",
    "Malawi" = "Africa", "Mali" = "Africa", "Mauritania" = "Africa",
    "Mauritius" = "Africa", "Morocco" = "Africa", "Mozambique" = "Africa",
    "Namibia" = "Africa", "Niger" = "Africa", "Nigeria" = "Africa",
    "Rwanda" = "Africa", "Senegal" = "Africa", "Sierra Leone" = "Africa",
    "Somalia" = "Africa", "South Africa" = "Africa", "South Sudan" = "Africa",
    "Sudan" = "Africa", "Tanzania" = "Africa", "Togo" = "Africa",
    "Tunisia" = "Africa", "Uganda" = "Africa", "Zambia" = "Africa",
    "Zimbabwe" = "Africa",
    
    "Australia" = "Oceania", "Fiji" = "Oceania", "Kiribati" = "Oceania",
    "Marshall Islands" = "Oceania", "Micronesia, Fed. Sts." = "Oceania",
    "New Zealand" = "Oceania", "Palau" = "Oceania", "Samoa" = "Oceania",
    "Solomon Islands" = "Oceania", "Tonga" = "Oceania", "Vanuatu" = "Oceania"
  )
  
  data %>%
    mutate(Continente = ifelse(Pais %in% names(continentes_map),
                                continentes_map[Pais], NA))
}

datos_riesgos <- Base_2022 %>%
  asignar_continentes() %>%
  filter(
    !is.na(`Crecimiento poblacion`) & 
    !is.na(Poblacion) &
    !is.na(Continente) &
    Poblacion > 0
  ) %>%
  select(
    Pais, Continente, 
    Poblacion, 
    `Crecimiento poblacion`,
    `Mortalidad infantil`,
    `Esperanza vida`,
    PIB_per
  ) %>%
  arrange(desc(Poblacion)) %>%
  slice_head(n = 60) %>%
  mutate(
    Poblacion_millones = Poblacion / 1e6,
    Clasificacion = case_when(
      `Crecimiento poblacion` > 2 ~ "Dividendo Demogr√°fico",
      `Crecimiento poblacion` >= 0.5 & `Crecimiento poblacion` <= 2 ~ "Madurez Estable", 
      `Crecimiento poblacion` < 0.5 ~ "Declive Poblacional",
      TRUE ~ "Sin Clasificar"
    ),
    tooltip = paste0(
      "<b style='font-size:14px; color:#00e5ff;'>", Pais, "</b><br>",
      "<span style='color:#a259ff; font-size:11px;'>", Continente, "</span><br><br>",
      "<b style='color:#ffd600;'> INDICADORES DEMOGR√ÅFICOS:</b><br>",
      "‚îú‚îÄ Poblaci√≥n: <b style='color:#ffd600;'>", 
      format(round(Poblacion_millones, 1), big.mark = ",", decimal.mark = ".", trim = TRUE), " M</b><br>",
      "‚îú‚îÄ Crecimiento: <b style='color:#00e676;'>", 
      round(`Crecimiento poblacion`, 2), "%</b><br>",
      "‚îú‚îÄ Esperanza Vida: <b style='color:#00e5ff;'>", 
      round(`Esperanza vida`, 1), " a√±os</b><br>",
      "‚îú‚îÄ Mortalidad Infantil: <b style='color:#ff1744;'>", 
      round(`Mortalidad infantil`, 1), "/1000</b><br>",
      "‚îî‚îÄ PIB per c√°pita: <b style='color:#a259ff;'>$", 
      format(round(PIB_per), big.mark = ","), "</b><br>",
      "<br><b>Clasificaci√≥n:</b> <span style='color:#00e676;'>", Clasificacion, "</span>"
    )
  )

fig_treemap <- plot_ly(
  data = datos_riesgos,
  type = "treemap",
  labels = ~Pais,
  parents = ~"",
  values = ~Poblacion,
  branchvalues = "total",
  marker = list(
    colors = ~`Crecimiento poblacion`,
    colorscale = list(
      c(0, "#ff1744"),    
      c(0.3, "#ff6b00"),  
      c(0.5, "#fdd835"),    
      c(0.7, "#76ff03"),  
      c(1, "#00e676")      
    ),
    cmin = -2,
    cmax = 4,
    showscale = TRUE,
    colorbar = list(
      title = list(
        text = "<b>Crecimiento<br>Anual (%)</b>",
        font = list(size = 12, color = "#e0e6ed")
      ),
      tickvals = c(-2, -1, 0, 1, 2, 3, 4),
      ticktext = c("-2%", "-1%", "0%", "1%", "2%", "3%", "4%"),
      thickness = 20,
      len = 0.8,
      x = 1.05,  
      y = 0.5,
      tickfont = list(size = 11, color = "#8b92a0")
    ),
    line = list(color = "#0a0e1a", width = 2),
    opacity = 0.9
  ),
  textinfo = "label+value",
  texttemplate = "<b>%{label}</b><br>%{value:.0f}M",
  textposition = "middle center", 
  textfont = list(
    size = 14,
    color = "white",
    family = "Arial"
  ),
  customdata = ~tooltip,
  hovertemplate = "%{customdata}<extra></extra>",
  showlegend = FALSE
)

fig_treemap <- fig_treemap %>%
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:24px;'>Figura 5: Oportunidades y Riesgos Demogr√°ficos Globales</b><br>
             <span style='color:#8b92a0; font-size:14px;'>Top 60 pa√≠ses | Tama√±o = Poblaci√≥n | Color = Crecimiento Anual (2022)</span>",
      x = 0.5,
      xanchor = 'center', 
      y = 0.95
    ),
    plot_bgcolor = '#000000',
    paper_bgcolor = '#0a0e1a',
    font = list(family = "Arial, sans-serif", color = '#e0e6ed', size = 12),
    
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 12, family = "Arial")
    ),
    
    margin = list(l = 10, r = 150, b = 100, t = 120),
    annotations = list(
      list(
        x = 0.5, 
        y = -0.08,
        xref = "paper", 
        yref = "paper",
        text = "<span style='color:#e0e6ed; font-size:12px;'><b>üìä LECTURA:</b> 
               <span style='color:#00e676;'>Verde (alto crecimiento) = Oportunidades demogr√°ficas</span> | 
               <span style='color:#ff1744;'>Rojo (bajo/negativo) = Riesgos de declive</span> | 
               <span style='color:#fdd835;'>Amarillo = Transici√≥n estable</span></span>",
        showarrow = FALSE,
        xanchor = "center",
        align = "center"
      )
    )
  ) %>%
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png", 
      filename = "oportunidades_riesgos_demograficos",
      width = 1600,
      height = 1000
    )
  )

fig_treemap
```

India y China dominan por volumen (rect√°ngulos enormes), pero con din√°micas opuestas: India en amarillo-verde (crecimiento 1-2%) versus China en naranja-rojo (crecimiento bajo). Estados Unidos, Indonesia y Brasil exhiben colores intermedios, reflejando transiciones demogr√°ficas distintas. Pa√≠ses africanos como Congo Democr√°tico, Nigeria y Uganda aparecen en verde brillante, indicando crecimiento r√°pido (oportunidades de dividendo demogr√°fico pero tambi√©n presi√≥n sobre servicios). Europeos como Alemania y Espa√±a muestran tonos rojos-naranjas, evidenciando declive poblacional y envejecimiento. Esta distribuci√≥n muestra que presiones demogr√°ficas operan en direcciones opuestas seg√∫n regi√≥n, informaci√≥n que contextualizar√° el an√°lisis multivariado posterior.

## Distribuci√≥n de Indicadores por continente

Mientras que el an√°lisis dimensional anterior examina indicadores de forma global, es fundamental entender c√≥mo var√≠a la heterogeneidad DENTRO de cada continente. Dos preguntas clave emergen: ¬øSon los continentes entidades homog√©neas o existen disparidades profundas dentro de cada regi√≥n? ¬øQu√© pa√≠ses act√∫an como outliers casos at√≠picos que desaf√≠an el patr√≥n regional y qu√© factores espec√≠ficos explican sus desviaciones?

La siguiente visualizaci√≥n interactiva explora la distribuci√≥n por regi√≥n de 10 indicadores estrat√©gicos seleccionados de las cinco dimensiones del desarrollo. Para cada indicador y continente, se visualizan: (1) el boxplot que resume la distribuci√≥n central (mediana, cuartiles, rango intercuartil), (2) los puntos normales que representan pa√≠ses dentro del rango esperado, y (3) los outliers que identifican casos an√≥malos.

Al pasar el cursor sobre cualquier punto, se desplegan simult√°neamente el nombre del pa√≠s, su valor espec√≠fico, su continente y clasificaci√≥n (normal u outlier). Esta visualizaci√≥n interactiva permite explorar din√°micamente qu√© pa√≠ses rompen los patrones regionales esperados, informaci√≥n crucial para identificar posteriormente qu√© caracter√≠sticas espec√≠ficas crean estas anomal√≠as‚Äîrevelaci√≥n que el An√°lisis de Componentes Principales posteriormente contextualizar√° dentro de la estructura multidimensional del desarrollo.

Selecciona cualquier indicador con el men√∫ desplegable para explorar c√≥mo var√≠an las disparidades regionales seg√∫n la dimensi√≥n analizada.

```{r box plot,  fig.height=7.2, fig.width=25, out.width="100%"}

asignar_continentes <- function(data) {
  continentes_map <- c(
    "Argentina" = "Americas", "Bahamas, The" = "Americas", "Barbados" = "Americas",
    "Belize" = "Americas", "Bolivia" = "Americas", "Brazil" = "Americas",
    "Canada" = "Americas", "Chile" = "Americas", "Colombia" = "Americas",
    "Costa Rica" = "Americas", "Cuba" = "Americas", "Dominica" = "Americas",
    "Dominican Republic" = "Americas", "Ecuador" = "Americas", "El Salvador" = "Americas",
    "Grenada" = "Americas", "Guatemala" = "Americas", "Guyana" = "Americas",
    "Haiti" = "Americas", "Honduras" = "Americas", "Jamaica" = "Americas",
    "Mexico" = "Americas", "Nicaragua" = "Americas", "Panama" = "Americas",
    "Paraguay" = "Americas", "Peru" = "Americas", "St. Kitts and Nevis" = "Americas",
    "St. Lucia" = "Americas", "St. Vincent and the Grenadines" = "Americas",
    "Suriname" = "Americas", "Trinidad and Tobago" = "Americas", "United States" = "Americas",
    "Uruguay" = "Americas", "Venezuela, RB" = "Americas", "Antigua and Barbuda" = "Americas",
    
    "Albania" = "Europe", "Austria" = "Europe", "Belarus" = "Europe",
    "Belgium" = "Europe", "Bosnia and Herzegovina" = "Europe", "Bulgaria" = "Europe",
    "Croatia" = "Europe", "Cyprus" = "Europe", "Czech Republic" = "Europe",
    "Czechia" = "Europe", "Denmark" = "Europe", "Estonia" = "Europe",
    "Finland" = "Europe", "France" = "Europe", "Germany" = "Europe",
    "Greece" = "Europe", "Hungary" = "Europe", "Iceland" = "Europe",
    "Ireland" = "Europe", "Italy" = "Europe", "Kosovo" = "Europe",
    "Latvia" = "Europe", "Lithuania" = "Europe", "Luxembourg" = "Europe",
    "Malta" = "Europe", "Montenegro" = "Europe", "Netherlands" = "Europe",
    "North Macedonia" = "Europe", "Norway" = "Europe", "Poland" = "Europe",
    "Portugal" = "Europe", "Russian Federation" = "Europe", "Serbia" = "Europe",
    "Slovak Republic" = "Europe", "Slovakia" = "Europe", "Slovenia" = "Europe",
    "Spain" = "Europe", "Sweden" = "Europe", "Switzerland" = "Europe",
    "Turkey" = "Europe", "Turkiye" = "Europe", "Ukraine" = "Europe",
    "United Kingdom" = "Europe", "Armenia" = "Europe", "Azerbaijan" = "Europe",
    "Georgia" = "Europe", "Moldova" = "Europe", "Romania" = "Europe",
    "San Marino" = "Europe",
    
    "Afghanistan" = "Asia", "Bahrain" = "Asia", "Bangladesh" = "Asia",
    "Bhutan" = "Asia", "Brunei Darussalam" = "Asia", "Cambodia" = "Asia",
    "China" = "Asia", "Hong Kong SAR, China" = "Asia", "India" = "Asia",
    "Indonesia" = "Asia", "Iran, Islamic Rep." = "Asia", "Iraq" = "Asia",
    "Israel" = "Asia", "Japan" = "Asia", "Jordan" = "Asia",
    "Kazakhstan" = "Asia", "Korea, Dem. People's rep." = "Asia", "Korea, Rep." = "Asia",
    "Kuwait" = "Asia", "Kyrgyz Republic" = "Asia", "Lao PDR" = "Asia",
    "Lebanon" = "Asia", "Macao SAR, China" = "Asia", "Malaysia" = "Asia",
    "Maldives" = "Asia", "Mongolia" = "Asia", "Myanmar" = "Asia",
    "Nepal" = "Asia", "Oman" = "Asia", "Pakistan" = "Asia",
    "Philippines" = "Asia", "Qatar" = "Asia", "Saudi Arabia" = "Asia",
    "Singapore" = "Asia", "Sri Lanka" = "Asia", "Syrian Arab Republic" = "Asia",
    "Taiwan" = "Asia", "Tajikistan" = "Asia", "Thailand" = "Asia",
    "Timor-Leste" = "Asia", "Turkmenistan" = "Asia", "United Arab Emirates" = "Asia",
    "Uzbekistan" = "Asia", "Vietnam" = "Asia", "Viet Nam" = "Asia",
    "West Bank and Gaza" = "Asia", "Yemen, Rep." = "Asia",
    
    "Algeria" = "Africa", "Angola" = "Africa", "Benin" = "Africa",
    "Botswana" = "Africa", "Burkina Faso" = "Africa", "Burundi" = "Africa",
    "Cabo Verde" = "Africa", "Cameroon" = "Africa", "Central African Republic" = "Africa",
    "Chad" = "Africa", "Comoros" = "Africa", "Congo, Dem. Rep." = "Africa",
    "Congo, Rep." = "Africa", "Cote d'Ivoire" = "Africa", "Djibouti" = "Africa",
    "Egypt, Arab Rep." = "Africa", "Equatorial Guinea" = "Africa", "Eritrea" = "Africa",
    "Eswatini" = "Africa", "Ethiopia" = "Africa", "Gabon" = "Africa",
    "Gambia, The" = "Africa", "Ghana" = "Africa", "Guinea" = "Africa",
    "Guinea-Bissau" = "Africa", "Kenya" = "Africa", "Lesotho" = "Africa",
    "Liberia" = "Africa", "Libya" = "Africa", "Madagascar" = "Africa",
    "Malawi" = "Africa", "Mali" = "Africa", "Mauritania" = "Africa",
    "Mauritius" = "Africa", "Morocco" = "Africa", "Mozambique" = "Africa",
    "Namibia" = "Africa", "Niger" = "Africa", "Nigeria" = "Africa",
    "Rwanda" = "Africa", "Senegal" = "Africa", "Sierra Leone" = "Africa",
    "Somalia" = "Africa", "South Africa" = "Africa", "South Sudan" = "Africa",
    "Sudan" = "Africa", "Tanzania" = "Africa", "Togo" = "Africa",
    "Tunisia" = "Africa", "Uganda" = "Africa", "Zambia" = "Africa",
    "Zimbabwe" = "Africa",
    
    "Australia" = "Oceania", "Fiji" = "Oceania", "Kiribati" = "Oceania",
    "Marshall Islands" = "Oceania", "Micronesia, Fed. Sts." = "Oceania",
    "New Zealand" = "Oceania", "Palau" = "Oceania", "Samoa" = "Oceania",
    "Solomon Islands" = "Oceania", "Tonga" = "Oceania", "Vanuatu" = "Oceania"
  )
  
  data %>%
    mutate(Continente = ifelse(Pais %in% names(continentes_map),
                                continentes_map[Pais], NA))
}

detectar_outliers <- function(data, var, grupo_col) {
  data %>%
    group_by(!!sym(grupo_col)) %>%
    mutate(
      Q1 = quantile(!!sym(var), 0.25, na.rm = TRUE),
      Q3 = quantile(!!sym(var), 0.75, na.rm = TRUE),
      IQR = Q3 - Q1,
      limite_inferior = Q1 - 1.5 * IQR,
      limite_superior = Q3 + 1.5 * IQR,
      es_outlier = !!sym(var) < limite_inferior | !!sym(var) > limite_superior,
      posicion_relativa = case_when(
        !!sym(var) < limite_inferior ~ "Bajo",
        !!sym(var) > limite_superior ~ "Alto",
        TRUE ~ "Normal"
      )
    ) %>%
    ungroup()
}

datos_box <- Base_2022 %>%
  asignar_continentes() %>%
  filter(!is.na(Continente)) %>%
  select(
    Pais, Continente,
    PIB_per, `Crecimiento PIB`, `Esperanza vida`,
    `Mortalidad infantil`, `Acceso electricidad`, `Uso internet`,
    `Inversion extranjera`, `Crecimiento poblacion`, `Gasto salud`, `Area boscosa`
  )

vars_boxplot <- list(
  list(var = "PIB_per", 
       nombre = "PIB per c√°pita (US$)", 
       color = "#00ff00"),
  
  list(var = "Crecimiento PIB", 
       nombre = "Crecimiento PIB (% anual)", 
       color = "#00d4ff"),
  
  list(var = "Esperanza vida", 
       nombre = "Esperanza de vida (a√±os)", 
       color = "#ff00ff"),
  
  list(var = "Mortalidad infantil", 
       nombre = "Mortalidad infantil (por 1,000)", 
       color = "#ff3333"),
  
  list(var = "Acceso electricidad", 
       nombre = "Acceso a electricidad (%)", 
       color = "#00ffff"),
  
  list(var = "Uso internet", 
       nombre = "Uso de internet (%)", 
       color = "#ffff00"),
  
  list(var = "Inversion extranjera", 
       nombre = "Inversi√≥n Extranjera (% PIB)", 
       color = "#ff9900"),
  
  list(var = "Crecimiento poblacion", 
       nombre = "Crecimiento poblacional (% anual)", 
       color = "#ff00ff"),
  
  list(var = "Gasto salud", 
       nombre = "Gasto en salud (% PIB)", 
       color = "#00ff88"),
  
  list(var = "Area boscosa", 
       nombre = "√Årea boscosa (% tierra)", 
       color = "#00ff00")
)

p <- plot_ly()

for (i in seq_along(vars_boxplot)) {
  config <- vars_boxplot[[i]]
  var_name <- config$var
  nombre_variable <- config$nombre  
  color_variable <- config$color    
  
  datos_con_outliers <- detectar_outliers(datos_box, var_name, "Continente")
  
  p <- p %>%
    add_boxplot(
      data = datos_con_outliers,
      x = ~Continente,
      y = as.formula(paste0("~`", var_name, "`")),
      name = "Distribuci√≥n",
      marker = list(
        color = color_variable,
        opacity = 0.7,
        size = 4
      ),
      line = list(color = color_variable, width = 2),
      boxmean = FALSE,
      visible = (i == 1),
      showlegend = (i == 1),
      hoverinfo = "y",
      group = var_name,
      quartilemethod = "inclusive"
    )
  
  datos_todos <- datos_con_outliers
  
  datos_todos$valor_actual <- datos_todos[[var_name]]
  datos_todos$nombre_var <- nombre_variable
  datos_todos$color_var <- color_variable
  
  p <- p %>%
    add_trace(
      data = datos_todos,
      x = ~Continente,
      y = as.formula(paste0("~`", var_name, "`")),
      mode = "markers",
      type = "scatter",
      marker = list(
        color = color_variable,
        size = ifelse(datos_todos$es_outlier, 10, 4),
        opacity = ifelse(datos_todos$es_outlier, 0.9, 0.25),
        symbol = ifelse(datos_todos$es_outlier, "diamond", "circle"),
        line = list(
          color = ifelse(datos_todos$es_outlier, "#ffffff", "rgba(255,255,255,0)"),
          width = ifelse(datos_todos$es_outlier, 1, 0)
        )
      ),
      text = paste0(
        "<b style='font-size:13px; color:#00e5ff;'>", datos_todos$Pais, "</b><br>",
        "<span style='color:#8b92a0; font-size:11px;'>", datos_todos$Continente, "</span><br><br>",
        "<b style='color:#e0e6ed;'>", datos_todos$nombre_var, ":</b><br>",
        "<span style='color:", datos_todos$color_var, "; font-size:13px; font-weight:bold;'>",
        round(datos_todos$valor_actual, 2),
        "</span><br>",
        ifelse(
          datos_todos$es_outlier,
          paste0("<span style='color:#ffff00; font-size:11px;'>‚ö† OUTLIER (", datos_todos$posicion_relativa, ")</span>"),
          "<span style='color:#a259ff; font-size:10px;'>‚úì Normal</span>"
        )
      ),
      hovertemplate = "%{text}<extra></extra>",
      showlegend = FALSE,
      visible = (i == 1),
      group = var_name
    )
}

p %>%
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:20px;'>Figura 6: Distribuci√≥n de Indicadores por Regi√≥n</b><br>
               <span style='color:#8b92a0; font-size:12px;'>PIB per c√°pita (US$) | A√±o 2022 | ‚óá Diamantes = Outliers | Pasa el cursor para detalles</span>",
      x = 0.5,
      xanchor = 'center',
      y = 0.96
    ),
    
    xaxis = list(
      title = "<b style='font-size:13px; color:#00e5ff;'>Continente</b>",
      tickfont = list(color = '#e0e6ed', size = 12),
      titlefont = list(color = '#00e5ff', size = 13),
      showgrid = FALSE,
      showline = TRUE,
      linewidth = 0.8,
      linecolor = '#00e5ff',
      categoryorder = "array",
      categoryarray = c("Africa", "Americas", "Asia", "Europe", "Oceania")
    ),
    
    yaxis = list(
      title = "<b style='font-size:13px; color:#00e5ff;'>PIB per c√°pita (US$)</b>",
      tickfont = list(color = '#8b92a0', size = 10),
      titlefont = list(color = '#00e5ff', size = 13),
      gridcolor = '#1a1a3e',
      showgrid = TRUE,
      gridwidth = 0.4,
      zeroline = FALSE
    ),
    
    plot_bgcolor = '#000000',
    paper_bgcolor = '#0a0e1a',
    font = list(family = "Arial, sans-serif", color = '#e0e6ed', size = 11),
    
    legend = list(
      bgcolor = 'rgba(10,14,26,0.95)',
      bordercolor = '#00e5ff',
      borderwidth = 1.5,
      x = 0.02,
      y = 0.98,
      font = list(size = 11, color = "#00e5ff"),
      orientation = "v"
    ),
    
    margin = list(l = 80, r = 50, b = 80, t = 130),
    hovermode = 'closest',
    
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.98)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 11, family = "Arial"),
      align = "left",
      namelength = -1
    ),
    
    updatemenus = list(
      list(
        buttons = lapply(seq_along(vars_boxplot), function(i) {
          config <- vars_boxplot[[i]]
          var_name <- config$var
          
          n_vars <- length(vars_boxplot)
          visible_list <- rep(FALSE, n_vars * 2)
          
          visible_list[(i-1)*2 + 1] <- TRUE
          visible_list[(i-1)*2 + 2] <- TRUE
          
          list(
            label = strsplit(config$nombre, " \\(")[[1]][1],
            method = "update",
            args = list(
              list(visible = visible_list),
              list(
                title = list(
                  text = paste0(
                    "<b style='color:#00e5ff; font-size:20px;'>Figura 6: Distribuci√≥n de Indicadores por Regi√≥n</b><br>",
                    "<span style='color:#8b92a0; font-size:12px;'>",
                    config$nombre,
                    " | A√±o 2022 | ‚óá Diamantes = Outliers | Pasa el cursor para detalles</span>"
                  ),
                  x = 0.5,
                  xanchor = 'center',
                  y = 0.96
                ),
                "yaxis.title" = paste0("<b style='font-size:13px; color:#00e5ff;'>", config$nombre, "</b>")
              )
            )
          )
        }),
        
        direction = "down",
        pad = list(r = 10, t = 10),
        showactive = TRUE,
        x = 0.01,
        xanchor = "left",
        y = 1.10,
        yanchor = "top",
        bgcolor = "rgba(162, 89, 255, 0.25)",
        bordercolor = "#a259ff",
        borderwidth = 1.5,
        font = list(size = 10, color = "#a259ff", family = "Arial"),
        active = 0
      )
    ),
    
    annotations = list(
      list(
        x = 0.01,
        y = 1.15,
        xref = "paper",
        yref = "paper",
        text = "<b style='color:#00e5ff; font-size:11px; text-transform:uppercase; letter-spacing:1px;'>üìä Selecciona indicador:</b>",
        showarrow = FALSE,
        xanchor = "left",
        yanchor = "top",
        font = list(size = 11)
      ),
      list(
        x = 0.5,
        y = -0.14,
        xref = "paper",
        yref = "paper",
        text = "<span style='color:#8b92a0; font-size:10px;'>
                 <b>‚îÅ</b> Caja (Q1-Q3) = 50% central | 
                 <b>‚îÄ</b> L√≠neas = Rango esperado | 
                 <b>‚óè</b> Puntos = Pa√≠ses dentro del rango | 
                 <b>‚óá</b> Diamantes = Valores at√≠picos (outliers)
               </span>",
        showarrow = FALSE,
        xanchor = "center",
        yanchor = "top",
        align = "center"
      )
    )
  ) %>%
  
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "figura_6_distribucion_continentes_2022",
      width = 1600,
      height = 900
    )
  )

```

La Figura 6 revela cierta heterogeneidad dentro de cada continente. En Africa, la dispersi√≥n es particularmente amplia en indicadores de salud: mientras algunos pa√≠ses aproximan est√°ndares europeos en esperanza de vida, otros enfrentan desaf√≠os cr√≠ticos en mortalidad infantil. Americas muestra un patr√≥n variado donde algunos pa√≠ses desarrollados contrastan dram√°ticamente con econom√≠as emergentes, ejemplo: Bolivia registra esperanza de vida por debajo del promedio regional. En Asia, la heterogeneidad es extrema, Qatar emerge como outlier en crecimiento poblacional (5.91% anual, reflejo de inmigraci√≥n laboral), mientras otros pa√≠ses asi√°ticos presentan din√°micas demogr√°ficas moderadas. Europe mantiene relativa homogeneidad en indicadores de bienestar, aunque Malta destaca como outlier extremo en inversi√≥n extranjera directa (126% del PIB, caracter√≠stico de econom√≠as muy peque√±as y financieras). En Oceania, la dispersi√≥n limitada contrasta con puntos aislados como Solomon Islands, con cobertura forestal excepcional. Estos patrones evidencian que el desarrollo no se distribuye geogr√°ficamente de forma uniforme sino que responde a factores estructurales, institucionales y geopol√≠ticos espec√≠ficos, informaci√≥n que el an√°lisis multidimensional posterior contextualizar√° dentro de constructos sint√©ticos mediante componentes principales.

## Visualizaci√≥n Geoespacial

La visualizaci√≥n geoespacial complementa el an√°lisis dimensional ofreciendo una perspectiva geogr√°fica integrada que revela c√≥mo las din√°micas de desarrollo se distribuyen espacialmente en el planeta. Esta secci√≥n presenta un mapa interactivo mundial donde cada territorio se colorea seg√∫n el indicador seleccionado, permitiendo identificar patrones de concentraci√≥n geogr√°fica, grupos regionales y anomal√≠as que anticipan la estructura latente del desarrollo global.

El mapa ofrece tres variables seleccionables mediante controles en la esquina superior izquierda: (1) Crecimiento PIB, (2) Acceso a Electricidad, y (3) Crecimiento Poblacional. Cada variable posee su propia paleta de colores. Una leyenda din√°mica en la esquina inferior derecha se actualiza autom√°ticamente al cambiar de variable, mostrando la escala espec√≠fica.

Al pasar el cursor sobre cualquier pa√≠s, emerge informac√≥n con nombre del pa√≠s, variable seleccionada y valor espec√≠fico, permitiendo consultar informaci√≥n precise sin interrumpir la visualizaci√≥n general.

```{r crear-datos-mapa}

variables_mapa <- list(
  "Crecimiento PIB" = "Crecimiento PIB",
  "Acceso electricidad" = "Acceso electricidad",  
  "Crecimiento poblacion" = "Crecimiento poblacion"  
)

world <- ne_countries(scale = "medium", returnclass = "sf")

mapeo_paises <- c(
  "United States of America" = "United States",
  "Russia" = "Russian Federation",
  "South Korea" = "Korea, Rep.",
  "North Korea" = "Korea, Dem. People's Rep.",
  "Egypt" = "Egypt, Arab Rep.",
  "Democratic Republic of the Congo" = "Congo, Dem. Rep.",
  "Republic of the Congo" = "Congo, Rep.",
  "Laos" = "Lao PDR",
  "Syria" = "Syrian Arab Republic",
  "Venezuela" = "Venezuela, RB",
  "Iran" = "Iran, Islamic Rep.",
  "Czech Republic" = "Czechia",
  "Slovakia" = "Slovak Republic",
  "Kyrgyzstan" = "Kyrgyz Republic",
  "Yemen" = "Yemen, Rep.",
  "Turkey" = "Turkiye",
  "Gambia" = "Gambia, The",
  "Bahamas" = "Bahamas, The",
  "Ivory Coast" = "Cote d'Ivoire",
  "Brunei" = "Brunei Darussalam",
  "Cape Verde" = "Cabo Verde",
  "Hong Kong" = "Hong Kong SAR, China",
  "Macao" = "Macao SAR, China",
  "Macedonia" = "North Macedonia",
  "Saint Lucia" = "St. Lucia",
  "Saint Vincent and the Grenadines" = "St. Vincent and the Grenadines",
  "Saint Kitts and Nevis" = "St. Kitts and Nevis",
  "Myanmar" = "Myanmar",
  "Bolivia" = "Bolivia",
  "Libya" = "Libya",
  "Tanzania" = "Tanzania",
  "Eswatini" = "Eswatini",
  "Timor-Leste" = "Timor-Leste"
)

mapeo_df <- data.frame(
  name_world = names(mapeo_paises),
  name_data = unname(mapeo_paises),
  stringsAsFactors = FALSE
)

world_data <- world %>%
  left_join(mapeo_df, by = c("name" = "name_world")) %>%
  left_join(
    Base_2022 %>% select(Pais, all_of(unlist(variables_mapa))),
    by = c("name_data" = "Pais")
  ) %>%
  mutate(
    across(
      all_of(unlist(variables_mapa)),
      ~ifelse(is.na(.) & name %in% Base_2022$Pais,
              Base_2022[[cur_column()]][match(name, Base_2022$Pais)], .)
    )
  )

```

```{r crear-mapa-interactivo, fig.height=6.5, fig.width=11}
paletas <- list(
  "Crecimiento PIB" = colorNumeric(
    palette = colorRampPalette(c("#ff1744", "#ff6b00", "#ffd600", "#00e676", "#00e5ff"))(100),
    domain = world_data$`Crecimiento PIB`,
    na.color = "#1a1a2e"
  ),
  "Acceso electricidad" = colorNumeric(
    palette = colorRampPalette(c("#1a1a2e", "#0084ff", "#00e5ff", "#00e676", "#ffd600"))(100),
    domain = world_data$`Acceso electricidad`,
    na.color = "#1a1a2e"
  ),
  "Crecimiento poblacion" = colorNumeric(
    palette = colorRampPalette(c("#0084ff", "#00e5ff", "#a259ff", "#ff6b00", "#ff1744"))(100),
    domain = world_data$`Crecimiento poblacion`,  # ‚úÖ CORREGIDO
    na.color = "#1a1a2e"
  )
)

mapa <- leaflet(world_data, 
                width = "100%", 
                height = "550px",
                options = leafletOptions(
                  minZoom = 2,
                  maxZoom = 7,
                  worldCopyJump = TRUE
                )) %>%
  setView(lng = 15, lat = 20, zoom = 2.2) %>%
  addProviderTiles("CartoDB.DarkMatter")

for (var_display in names(variables_mapa)) {
  var_col <- variables_mapa[[var_display]]
  pal <- paletas[[var_display]]
  
  unidad <- if(grepl("Crecimiento", var_display)) "%" else "%"
  
  labels <- sprintf(
    "<div style='font-family: sans-serif;'>
      <strong style='color: #00e5ff; font-size: 15px;'>%s</strong><br/>
      <span style='color: #8b92a0; font-size: 12px;'>%s:</span><br/>
      <strong style='color: #00e5ff; font-size: 14px;'>%s</strong>
    </div>",
    world_data$name,
    var_display,
    ifelse(is.na(world_data[[var_col]]), 
           "Sin datos", 
           paste0(round(world_data[[var_col]], 2), unidad))
  ) %>% lapply(HTML)
  
  mapa <- mapa %>%
    addPolygons(
      fillColor = ~pal(world_data[[var_col]]),
      weight = 1.2,
      opacity = 0.9,
      color = "#00e5ff",
      fillOpacity = 0.75,
      highlight = highlightOptions(
        weight = 2.5,
        color = "#00ffff",
        fillOpacity = 0.9,
        bringToFront = TRUE
      ),
      label = labels,
      labelOptions = labelOptions(
        style = list(
          "background" = "rgba(10, 14, 26, 0.95)",
          "border" = "2px solid #00e5ff",
          "border-radius" = "6px",
          "padding" = "10px",
          "box-shadow" = "0 0 15px rgba(0, 229, 255, 0.6)"
        ),
        textsize = "13px"
      ),
      group = var_display
    )
}

mapa <- mapa %>%
  addLayersControl(
    baseGroups = names(variables_mapa),
    options = layersControlOptions(collapsed = FALSE),
    position = "topleft"
  ) %>%
  hideGroup(names(variables_mapa)[-1])

mapa <- mapa %>%
  htmlwidgets::onRender("
    function(el, x) {
      var map = this;
      
      // Configuraci√≥n de leyendas
      var legendConfigs = {
        'Crecimiento PIB': {
          title: 'CRECIMIENTO DEL PIB',
          subtitle: '(% anual)',
          min: -10,
          max: 10,
          colors: ['#ff1744', '#ff6b00', '#ffd600', '#00e676', '#00e5ff'],
          labels: ['-10%', '-5%', '0%', '5%', '10%']
        },
        'Acceso electricidad': {
          title: 'ACCESO A ELECTRICIDAD',
          subtitle: '(% de poblaci√≥n)',
          min: 0,
          max: 100,
          colors: ['#1a1a2e', '#0084ff', '#00e5ff', '#00e676', '#ffd600'],
          labels: ['0%', '25%', '50%', '75%', '100%']
        },
        'Crecimiento poblacion': {
          title: 'CRECIMIENTO POBLACI√ìN',
          subtitle: '(% anual)',
          min: -2,
          max: 4,
          colors: ['#0084ff', '#00e5ff', '#a259ff', '#ff6b00', '#ff1744'],
          labels: ['-2%', '-1%', '0%', '2%', '4%']
        }
      };
      
      // Crear leyenda
      var LegendControl = L.Control.extend({
        options: { position: 'bottomright' },
        onAdd: function(map) {
          var div = L.DomUtil.create('div', 'info legend');
          div.id = 'bar-legend';
          return div;
        }
      });
      
      map.addControl(new LegendControl());
      
      // Funci√≥n para crear barra de gradiente
      function updateLegend(varName) {
        var div = document.getElementById('bar-legend');
        var config = legendConfigs[varName];
        
        // Crear gradiente CSS
        var gradient = 'linear-gradient(to right';
        config.colors.forEach(function(color) {
          gradient += ', ' + color;
        });
        gradient += ')';
        
        var html = '<div style=\"background: linear-gradient(135deg, #0a0e1a, #12161f); padding: 18px; border-radius: 10px; border: 2px solid #00e5ff; box-shadow: 0 8px 32px rgba(0,0,0,0.9); min-width: 280px;\">';
        
        // T√≠tulo
        html += '<div style=\"color: #00e5ff; font-weight: 700; font-size: 13px; text-transform: uppercase; letter-spacing: 1.2px; margin-bottom: 4px; text-align: center; text-shadow: 0 0 10px rgba(0,229,255,0.5);\">' + config.title + '</div>';
        html += '<div style=\"color: #8b92a0; font-size: 11px; text-align: center; margin-bottom: 12px;\">' + config.subtitle + '</div>';
        
        // Barra de color
        html += '<div style=\"height: 20px; background: ' + gradient + '; border-radius: 4px; border: 1px solid #00e5ff; margin-bottom: 8px; box-shadow: inset 0 0 10px rgba(0,0,0,0.5);\"></div>';
        
        // Etiquetas
        html += '<div style=\"display: flex; justify-content: space-between; font-size: 11px; color: #e0e6ed;\">';
        config.labels.forEach(function(label) {
          html += '<span>' + label + '</span>';
        });
        html += '</div>';
        
        html += '</div>';
        div.innerHTML = html;
      }
      
      // Inicializar
      updateLegend('Crecimiento PIB');
      
      // Actualizar al cambiar capa
      map.on('baselayerchange', function(e) {
        updateLegend(e.name);
      });
      
      // Estilizar control de capas
      setTimeout(function() {
        var ctrl = document.querySelector('.leaflet-control-layers');
        if (ctrl) {
          ctrl.style.background = 'linear-gradient(135deg, #0a0e1a, #12161f)';
          ctrl.style.border = '2px solid rgba(0, 229, 255, 0.4)';
          ctrl.style.borderRadius = '10px';
          ctrl.style.padding = '18px';
          ctrl.style.boxShadow = '0 8px 32px rgba(0, 0, 0, 0.9)';
        }
        
        var base = document.querySelector('.leaflet-control-layers-base');
        if (base && !document.getElementById('sel-title')) {
          var title = document.createElement('div');
          title.id = 'sel-title';
          title.innerHTML = '<strong style=\"color: #00e5ff; font-size: 13px; text-transform: uppercase; letter-spacing: 1.5px; text-shadow: 0 0 10px rgba(0,229,255,0.5);\">üìä SELECCIONA VARIABLE</strong>';
          title.style.marginBottom = '12px';
          title.style.paddingBottom = '10px';
          title.style.borderBottom = '2px solid rgba(0, 229, 255, 0.3)';
          base.insertBefore(title, base.firstChild);
        }
        
        var labels = document.querySelectorAll('.leaflet-control-layers-base label');
        labels.forEach(function(label, idx) {
          label.style.color = '#e0e6ed';
          label.style.fontSize = '13px';
          label.style.fontWeight = '600';
          label.style.padding = '9px 12px';
          label.style.margin = '4px 0';
          label.style.display = 'block';
          label.style.borderRadius = '6px';
          label.style.cursor = 'pointer';
          label.style.transition = 'all 0.3s';
          
          var input = label.querySelector('input');
          if (input) {
            input.style.accentColor = '#00e5ff';
            if (idx === 0) {
              label.style.background = 'rgba(0, 229, 255, 0.15)';
              label.style.color = '#00e5ff';
            }
          }
          
          label.addEventListener('mouseenter', function() {
            this.style.background = 'rgba(0, 229, 255, 0.1)';
            this.style.color = '#00e5ff';
          });
          
          label.addEventListener('mouseleave', function() {
            if (!this.querySelector('input').checked) {
              this.style.background = 'transparent';
              this.style.color = '#e0e6ed';
            }
          });
        });
        
        var inputs = document.querySelectorAll('.leaflet-control-layers-base input');
        inputs.forEach(function(input) {
          input.addEventListener('change', function() {
            labels.forEach(function(l) {
              l.style.background = 'transparent';
              l.style.color = '#e0e6ed';
            });
            if (this.checked) {
              this.parentElement.style.background = 'rgba(0, 229, 255, 0.15)';
              this.parentElement.style.color = '#00e5ff';
            }
          });
        });
      }, 100);
    }
  ")

htmltools::tagList(
  htmltools::HTML(
    '<div style="
      text-align: center;
      color: #00e5ff;
      font-size: 22px;
      font-weight: bold;
      margin-bottom: 20px;
      text-shadow: 0 0 15px rgba(0, 229, 255, 0.5);
      text-transform: uppercase;
      letter-spacing: 2px;
    ">
       Figura 7: Distribuci√≥n Geoespacial de Indicadores de Desarrollo Global 2022
    </div>'
  ),
  mapa
)
```

En crecimiento PIB, se observa segregaci√≥n clara: Europa y Am√©rica del Norte tienden a tonos amarillo-verde (crecimiento moderado), mientras muchas naciones africanas muestran tonos oscuros (estancamiento). Asia exhibe m√°xima variabilidad: gigantes como India y Bangladesh en verde (crecimiento din√°mico), mientras Jap√≥n mantiene tonos amarillos (crecimiento moderado). En acceso a electricidad, la brecha digital-energ√©tica es evidente: Europa, Am√©rica del Norte y gran parte de Asia en amarillo (acceso universal), mientras amplias regiones de √Åfrica central permanecen en azul oscuro. Am√©rica Latina exhibe transici√≥n: colores intermedios reflejando acceso extendido pero no universal. En crecimiento poblacional, se observa un patr√≥n opuesto al desarrollo econ√≥mico: Europa y Jap√≥n dominan tonos azules (declive demogr√°fico), mientras √Åfrica muestra naranjas y rojos intensos (presi√≥n poblacional extrema), y Am√©rica Latina ocupa posiciones intermedias. Esta disociaci√≥n geogr√°fica entre prosperidad econ√≥mica, acceso de servicios b√°sicos y din√°mica demogr√°fica anticipa que el an√°lisis multivariado revelar√° si estas dimensiones operan de forma integrada o representan trayectorias diferentes del desarrollo.

------------------------------------------------------------------------

# Resultados del modelo

## Analisis de componentes principales (ACP)

### Matriz de correlaciones

Antes de aplicar el An√°lisis de Componentes Principales, es fundamental examinar la estructura de correlaciones entre las 17 variables para identificar redundancias potenciales y validar la pertinencia de la reducci√≥n de dimensionalidad. La matriz de correlaci√≥n de Pearson revela las asociaciones lineales entre pares de variables, proporcionando una visi√≥n exploratoria de c√≥mo las dimensiones del desarrollo se interrelacionan. (Jolliffe, 2002).

```{r matriz-correlaciones-cyber, fig.height=9, fig.width=14, out.width="100%"}
datos_analisis <- Base_2022 %>%
  select(-Codigo) %>%
  column_to_rownames("Pais")

matriz_cor <- cor(datos_analisis, use = "complete.obs")

nombres_completos <- c(
  "PIB_per" = "PIB per c√°pita",
  "Poblacion" = "Poblaci√≥n total",
  "Esperanza vida" = "Esperanza de vida",
  "Acceso electricidad" = "Acceso electricidad",
  "Area boscosa" = "√Årea boscosa",
  "Suscripciones movil" = "Suscripciones m√≥viles",
  "Crecimiento PIB" = "Crecimiento PIB",
  "Mortalidad infantil" = "Mortalidad infantil",
  "Inversion extranjera" = "Inversi√≥n extranjera",
  "Gasto salud" = "Gasto en salud",
  "Uso internet" = "Uso de internet",
  "Importaciones" = "Importaciones",
  "Exportaciones" = "Exportaciones",
  "Tierra cultivable" = "Tierra cultivable",
  "Crecimiento poblacion" = "Crecimiento poblaci√≥n",
  "Industria" = "Industria",
  "Remesas" = "Remesas"
)

rownames(matriz_cor) <- nombres_completos[rownames(matriz_cor)]
colnames(matriz_cor) <- nombres_completos[colnames(matriz_cor)]

heatmap_interactivo <- plot_ly(
  x = colnames(matriz_cor),
  y = rownames(matriz_cor),
  z = matriz_cor,
  type = "heatmap",
  colors = colorRamp(c("#ff1744", "#0a0e1a", "#00e5ff")), 
  hoverinfo = "text",
  text = matrix(
    paste(
      "<b>", rep(colnames(matriz_cor), each = nrow(matriz_cor)), "</b><br>",
      "vs <b>", rep(rownames(matriz_cor), times = ncol(matriz_cor)), "</b><br>",
      "Correlaci√≥n: <b style='color:#00e5ff'>", round(c(matriz_cor), 3), "</b>"
    ),
    nrow = nrow(matriz_cor),
    ncol = ncol(matriz_cor)
  ),
  colorbar = list(
    title = list(
      text = "<b>Correlaci√≥n</b>",
      font = list(color = "#e0e6ed", size = 12)
    ),
    tickfont = list(color = "#8b92a0", size = 10),
    thickness = 15,
    len = 0.8
  )
) %>%
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:20px;'>Figura 8: Matriz de Correlaciones Multidimensional</b><br>
             <span style='color:#8b92a0; font-size:13px;'>17 Variables de Desarrollo Global | A√±o 2022</span>",
      x = 0.05,
      y = 0.95,
      font = list(size = 14)
    ),
    xaxis = list(
      title = "",
      tickangle = -45,
      tickfont = list(size = 10, color = "#8b92a0"),
      showgrid = FALSE,
      zeroline = FALSE
    ),
    yaxis = list(
      title = "",
      tickfont = list(size = 10, color = "#8b92a0"),
      showgrid = FALSE,
      zeroline = FALSE
    ),
    plot_bgcolor = '#000000',
    paper_bgcolor = '#0a0e1a',
    font = list(family = "Arial, sans-serif", color = '#e0e6ed'),
    margin = list(l = 180, r = 50, b = 180, t = 120),
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 11, family = "Arial")
    ),
    annotations = list(
      list(
        x = 0.5,
        y = -0.18,
        text = "<span style='color:#8b92a0; font-size:11px;'>üîç Haz clic y arrastra para zoom ‚Ä¢ üìä Pasa el cursor para ver valores exactos</span>",
        showarrow = FALSE,
        xref = "paper",
        yref = "paper",
        font = list(size = 11)
      )
    )
  ) %>%
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "matriz_correlaciones_cyber",
      width = 1400,
      height = 1000
    )
  )

heatmap_interactivo

matriz_cor_long <- matriz_cor %>%
  as.data.frame() %>%
  rownames_to_column("Variable1") %>%
  pivot_longer(
    cols = -Variable1,
    names_to = "Variable2",
    values_to = "Correlacion"
  ) %>%
  filter(Variable1 != Variable2) %>%
  mutate(Correlacion = round(Correlacion, 3))

nombres_abreviados <- c(
  "PIB per c√°pita" = "PIB pc",
  "Poblaci√≥n total" = "Poblaci√≥n",
  "Esperanza de vida" = "Esp. vida",
  "Acceso electricidad" = "Electricidad",
  "√Årea boscosa" = "Bosques",
  "Suscripciones m√≥viles" = "M√≥vil",
  "Crecimiento PIB" = "Crec. PIB",
  "Mortalidad infantil" = "Mort. inf.",
  "Inversi√≥n extranjera" = "IED",
  "Gasto en salud" = "Salud",
  "Uso de internet" = "Internet",
  "Importaciones" = "Import.",
  "Exportaciones" = "Export.",
  "Tierra cultivable" = "Cultivable",
  "Crecimiento poblaci√≥n" = "Crec. pob.",
  "Industria" = "Industria",
  "Remesas" = "Remesas"
)

cor_significativas <- matriz_cor_long %>%
  mutate(
    Variable1_abr = nombres_abreviados[Variable1],
    Variable2_abr = nombres_abreviados[Variable2]
  ) %>%
  filter(abs(Correlacion) > 0.5) %>%
  arrange(desc(abs(Correlacion))) %>%
  select(Variable1_abr, Variable2_abr, Correlacion) %>%
  distinct()

tabla_cor <- cor_significativas %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 8: Correlaciones Significativas entre Variables**"),
    subtitle = "Relaciones con |r| > 0.5 entre indicadores de desarrollo global"
  ) %>%
  cols_label(
    Variable1_abr = md("**Variable 1**"),
    Variable2_abr = md("**Variable 2**"),
    Correlacion = md("**Correlaci√≥n (r)**")
  ) %>%
  cols_align(
    align = "center",
    columns = everything()
  ) %>%
  fmt_number(
    columns = Correlacion,
    decimals = 3
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium", color = "#000000"),
      cell_fill(color = "#00e5ff")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "#00e5ff",
      weight = px(2)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "#00e5ff",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Variable1_abr, Variable2_abr))
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#0a0e1a"),
      cell_text(color = "#e0e6ed")
    ),
    locations = cells_body()
  ) %>%
  tab_style(
    style = cell_text(weight = "bold", color = "#00e5ff"),
    locations = cells_body(columns = c(Variable1_abr, Variable2_abr))
  ) %>%
  tab_style(
    style = cell_fill(color = "rgba(0, 230, 118, 0.15)"),
    locations = cells_body(
      rows = Correlacion > 0.7
    )
  ) %>%
  tab_style(
    style = cell_fill(color = "rgba(255, 23, 68, 0.15)"),
    locations = cells_body(
      rows = Correlacion < -0.7
    )
  ) %>%
  tab_style(
    style = cell_text(color = "#00e676"),
    locations = cells_body(
      rows = Correlacion > 0.7,
      columns = Correlacion
    )
  ) %>%
  tab_style(
    style = cell_text(color = "#ff1744"),
    locations = cells_body(
      rows = Correlacion < -0.7,
      columns = Correlacion
    )
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.width = pct(90),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "solid",
    column_labels.border.top.color = "#00e5ff",
    column_labels.border.top.width = px(3),
    column_labels.border.bottom.style = "solid",
    column_labels.border.bottom.width = px(2),
    column_labels.border.bottom.color = "#00e5ff",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    table_body.hlines.style = "solid",
    table_body.hlines.color = "#00e5ff",
    table_body.hlines.width = px(1),
    table.background.color = "#0a0e1a",
    data_row.padding = px(10),
    heading.title.font.size = 18,
    heading.subtitle.font.size = 14,
    heading.padding = px(12),
    heading.border.bottom.style = "solid",
    heading.border.bottom.width = px(2),
    heading.border.bottom.color = "#00e5ff",
    footnotes.padding = px(10),
    footnotes.font.size = 12,
    source_notes.font.size = 12,
    source_notes.padding = px(10)
  ) %>%
  tab_source_note(
    source_note = md("**Fuente:** Elaboraci√≥n propia con base en World Bank (2023)")
  ) %>%
  tab_footnote(
    footnote = "üíö Correlaciones positivas fuertes (r > 0.7) indican relaciones directas significativas",
    locations = cells_body(rows = 1)
  ) %>%
  tab_footnote(
    footnote = "‚ù§Ô∏è Correlaciones negativas fuertes (r < -0.7) indican relaciones inversas significativas",
    locations = cells_body(rows = nrow(cor_significativas))
  )

tabla_cor

```

La matriz de correlaci√≥n entre todas las variables de desarrollo es fundamental porque exhibe patrones predecibles: variables econ√≥micas tienden a correlacionarse positivamente entre s√≠ (PIB per c√°pita, crecimiento del PIB, inversi√≥n extranjera), variables de bienestar social correlacionan positivamente (esperanza de vida, acceso a electricidad, uso de internet), y existe una correlaci√≥n positiva sustancial entre estas dos dimensiones generales (Hastie et al., 2009). Adicionalmente, se observan correlaciones negativas entre indicadores de rezago (mortalidad infantil, tierra cultivable) y variables de desarrollo avanzado, reflejando que pa√≠ses con mayor riqueza y bienestar exhiben menores tasas de mortalidad y menor dependencia agr√≠cola. La presencia de correlaciones altas (superiores a 0.7) entre m√∫ltiples pares de variables justifica plenamente la aplicaci√≥n del ACP: la reducci√≥n dimensional elimina redundancia sin perder informaci√≥n esencial (Jolliffe, 2002; Hastie et al., 2009).

### ACP

El An√°lisis de Componentes Principales fue aplicado al conjunto de 17 variables estandarizadas para identificar las dimensiones latentes subyacentes de variabilidad en el desarrollo internacional. El procedimiento consiste en la descomposici√≥n espectral de la matriz de covarianza estandarizada, identificando vectores propios (componentes) ordenados seg√∫n sus valores propios (autovalores) en orden descendente. Cada componente principal es una combinaci√≥n lineal ortogonal de las variables originales, dise√±ada para capturar la m√°xima varianza posible de manera sucesiva (Jolliffe, 2002; Hastie et al., 2009).

```{r ACP}


acp_temp <- dudi.pca(datos_analisis, center = TRUE, scale = TRUE, scannf = FALSE, nf = ncol(datos_analisis))

varianza_acum <- cumsum(acp_temp$eig) / sum(acp_temp$eig) * 100

n_componentes <- which(varianza_acum >= 70)[1]

acp_resultado <- dudi.pca(
  df = datos_analisis,
  center = TRUE,
  scale = TRUE,
  scannf = FALSE,
  nf = n_componentes
)

factores <- acp_resultado$li

```

```{r Tabla varianza}

varianza_df <- data.frame(
  Componente = factor(1:length(acp_resultado$eig)),
  Varianza = acp_resultado$eig / sum(acp_resultado$eig) * 100,
  VarianzaAcum = varianza_acum
) %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 9**"),
    subtitle = "Varianza Explicada por Componentes Principales"
  ) %>%
  cols_label(
    Componente = md("**Componente**"),
    Varianza = md("**Varianza (%)**"),
    VarianzaAcum = md("**Varianza Acumulada (%)**")
  ) %>%
  cols_align(
    align = "center",
    columns = everything()
  ) %>%
  fmt_number(
    columns = c(Varianza, VarianzaAcum),
    decimals = 2
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium", color = "#000000"),
      cell_fill(color = "#00e5ff")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "#00e5ff",
      weight = px(2)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "#00e5ff",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Componente, Varianza))
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#0a0e1a"),
      cell_text(color = "#e0e6ed")
    ),
    locations = cells_body()
  ) %>%
  tab_style(
    style = cell_text(weight = "bold", color = "#00e5ff"),
    locations = cells_body(columns = Componente)
  ) %>%
  tab_style(
    style = cell_text(size = "small", color = "#e0e6ed"),
    locations = cells_body(columns = c(Varianza, VarianzaAcum))
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#12161f"),
      cell_text(color = "#00ffff", weight = "bold")
    ),
    locations = cells_body(rows = 1)
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "solid",
    column_labels.border.top.color = "#00e5ff",
    column_labels.border.top.width = px(3),
    column_labels.border.bottom.style = "solid",
    column_labels.border.bottom.width = px(3),
    column_labels.border.bottom.color = "#00e5ff",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    table_body.hlines.style = "solid",
    table_body.hlines.color = "#00e5ff",
    table_body.hlines.width = px(1),
    table.background.color = "#0a0e1a",
    data_row.padding = px(12),
    heading.title.font.size = 18,
    heading.subtitle.font.size = 14,
    heading.padding = px(12),
    heading.border.bottom.style = "solid",
    heading.border.bottom.width = px(2),
    heading.border.bottom.color = "#00e5ff",
    footnotes.padding = px(10),
    footnotes.font.size = 13,
    source_notes.font.size = 13,
    source_notes.padding = px(10)
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff", size = "large")
    ),
    locations = cells_title(groups = "title")
  ) %>%
  tab_style(
    style = list(
      cell_text(color = "#e0e6ed", size = "medium")
    ),
    locations = cells_title(groups = "subtitle")
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboraci√≥n propia con base en los resultados del ACP (An√°lisis de Componentes Principales)")
  ) %>%
  tab_footnote(
    footnote = "Porcentaje de varianza explicada individualmente por cada componente principal en el espacio multidimensional",
    locations = cells_body(
      rows = 1,
      columns = Varianza
    )
  ) %>%
  tab_footnote(
    footnote = "Porcentaje acumulado de varianza explicada por los componentes hasta el actual. Determina el n√∫mero √≥ptimo de componentes",
    locations = cells_body(
      rows = 1,
      columns = VarianzaAcum
    )
  ) %>%
  tab_footnote(
    footnote = "Los componentes principales se ordenan de mayor a menor varianza explicada. Un nivel de 70-80% acumulado es t√≠picamente considerado suficiente",
    locations = cells_title(groups = "subtitle")
  )

varianza_df

varianza_df <- data.frame(
  Componente = paste0("PC", 1:length(acp_resultado$eig)),
  Varianza = acp_resultado$eig / sum(acp_resultado$eig) * 100,
  VarianzaAcum = varianza_acum
)

pc1_var <- round(varianza_df$Varianza[1], 1)
pc2_var <- round(varianza_df$Varianza[2], 1)
pc3_var <- round(varianza_df$Varianza[3], 1)
pc4_var <- round(varianza_df$Varianza[4], 1)
pc5_var <- round(varianza_df$Varianza[5], 1)
pc6_var <- round(varianza_df$Varianza[6], 1)

pc1_acum <- round(varianza_df$VarianzaAcum[1], 1)
pc2_acum <- round(varianza_df$VarianzaAcum[2], 1)
pc3_acum <- round(varianza_df$VarianzaAcum[3], 1)
pc4_acum <- round(varianza_df$VarianzaAcum[4], 1)
pc5_acum <- round(varianza_df$VarianzaAcum[5], 1)
pc6_acum <- round(varianza_df$VarianzaAcum[6], 1)


```

En este an√°lisis, el primer componente (**PC1**) captur√≥ un **`r pc1_var`%** de la varianza total, lo que indica que existe una dimensi√≥n principal que diferencia fundamentalmente a los pa√≠ses. Los componentes posteriores capturan variabilidad subsidiaria: el segundo componente (**PC2**) explica **`r pc2_var`%** (acumulando **`r pc2_acum`%**), el tercero (**PC3**) **`r pc3_var`%** (acumulando **`r pc3_acum`%**), el cuarto (**PC4**) **`r pc4_var`%** (acumulando **`r pc4_acum`%**).

### Grafico de sedimentacion

El gr√°fico de sedimentaci√≥n visualiza el concepto del "codo" (elbow) introducido por Kaiser (1960). La curva de los eigenvalores (representada como barras) exhibe un descenso pronunciado en los primeros componentes, indicando que capturan varianza sustancial. A partir de cierto componente, la pendiente se aplana significativamente, entrando en un r√©gimen donde componentes posteriores explican proporciones cada vez menores de varianza residual (Hastie et al., 2009).

```{r sedimentacion-cyber, fig.height=7, fig.width=12, out.width="100%"}
res.pca <- prcomp(datos_analisis, scale = TRUE)

eig.val <- get_eigenvalue(res.pca)

n_comp <- min(10, nrow(eig.val))

eig_df <- data.frame(
  Componente = factor(1:n_comp),
  Varianza = eig.val[1:n_comp, 2]
)

g <- ggplot(eig_df, aes(x = Componente, y = Varianza)) +
  geom_bar(stat = "identity", fill = "#00e5ff", color = "#00e5ff", alpha = 0.8) +
  geom_line(aes(group = 1), color = "#00e5ff", size = 1) +
  geom_point(color = "#00e5ff", size = 2) +
  geom_text(aes(label = round(Varianza, 1)), color = "#ffffff", vjust = -0.4, fontface = "bold", size = 4) +
  theme_cyber() +
  labs(
    title = "Figura 9: Varianza Explicada por Componente Principal",
    subtitle = "Autovalores del an√°lisis de componentes principales",
    x = "Componentes Principales",
    y = "Porcentaje de Varianza Explicada (%)"
  ) +
  theme(
    plot.title = element_text(face = "bold", size = 18, hjust = 0.5, color = "#00e5ff", margin = margin(b = 10)),
    plot.subtitle = element_text(size = 13, hjust = 0.5, color = "#8b92a0", margin = margin(b = 15)),
    axis.title = element_text(face = "bold", size = 14, color = "#e0e6ed"),
    axis.title.x = element_text(margin = margin(t = 10)),
    axis.title.y = element_text(margin = margin(r = 10)),
    axis.text = element_text(size = 11, color = "#8b92a0"),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_line(color = "#12161f", size = 0.5)
  ) +
  ylim(0, max(eig_df$Varianza) + 5)

g
```

```{r, include=FALSE}
res.var <- get_pca_var(res.pca)
res.pca$coord          
res.var$contrib        
res.var$cos2  
```

El punto donde esta curvatura cambia de pronunciada a plana (el "codo") indica aproximadamente el n√∫mero de componentes que retienen informaci√≥n relevante; componentes posteriores al codo tienden a capturar principalmente ruido estad√≠stico (Jolliffe, 2002). Y se selecciona 4 componentes ya que a partir de $k=4$ se comienza a aplanar la varianza explicada.

### Contribuci√≥n de Variables a Componentes Principales

La comprensi√≥n de c√≥mo cada variable original contribuye a la definici√≥n de los componentes principales es esencial para interpretar las dimensiones latentes descubiertas. La contribuci√≥n de una variable a un componente cuantifica el grado en el cual esa variable particular "explica" o "define" la direcci√≥n de ese componente en el espacio multidimensional original. Matem√°ticamente, la contribuci√≥n se expresa como porcentaje de la varianza del componente que puede atribuirse a cada variable (Hastie et al., 2009; Jolliffe, 2002).

Adicionalmente, la calidad de representaci√≥n ($cos¬≤$) de una variable en un componente indica qu√© proporci√≥n de la variabilidad total de esa variable es capturada por el componente. Un $cos¬≤$ cercano a 1 significa que la variable est√° casi completamente explicada por ese componente; un $cos¬≤$ cercano a 0 significa que la variable requiere componentes posteriores para ser bien representada (Jolliffe, 2002). Estas dos medidas‚Äîcontribuci√≥n y $cos^2$ son complementarias: la primera explica la importancia relativa de una variable en definir un componente; la segunda explica qu√© tan bien ese componente explica la variable (Hastie et al., 2009).

```{r contribucion}

contribuciones <- as.data.frame(acp_resultado$co)
contribuciones$Variable <- rownames(contribuciones)

cos2_df <- as.data.frame(acp_resultado$co^2)
cos2_df$Variable <- rownames(cos2_df)
crear_tabla_contribucion <- function(componente_num, contribuciones, cos2_df, titulo, tabla_num) {
  
  comp_data <- data.frame(
    Variable = rownames(contribuciones),
    Descripcion = round(abs(contribuciones[, componente_num]), 4),
    Interpretacion = round(cos2_df[, componente_num], 4)
  )
  
  comp_data <- comp_data[order(comp_data$Descripcion, decreasing = TRUE), ]
  rownames(comp_data) <- NULL
  
  tabla <- comp_data %>%
    gt() %>%
    tab_header(
      title = md(paste0("**Tabla ", tabla_num, "**")),
      subtitle = titulo
    ) %>%
    cols_label(
      Variable = md("**Variable**"),
      Descripcion = md("**Loading**"),
      Interpretacion = md("**Cos¬≤**")
    ) %>%
    cols_align(
      align = "center",
      columns = everything()
    ) %>%
    tab_style(
      style = list(
        cell_text(weight = "bold", size = "medium", color = "#000000"),
        cell_fill(color = "#00e5ff")
      ),
      locations = cells_column_labels()
    ) %>%
    tab_style(
      style = cell_borders(
        sides = c("top", "bottom"),
        color = "#00e5ff",
        weight = px(2)
      ),
      locations = list(
        cells_column_labels(),
        cells_body()
      )
    ) %>%
    tab_style(
      style = cell_borders(
        sides = "right",
        color = "#00e5ff",
        weight = px(1)
      ),
      locations = cells_body(columns = c(Variable, Descripcion))
    ) %>%
    tab_style(
      style = list(
        cell_fill(color = "#0a0e1a"),
        cell_text(color = "#e0e6ed")
      ),
      locations = cells_body()
    ) %>%
    tab_style(
      style = list(
        cell_text(weight = "bold", color = "#00e5ff"),
        cell_fill(color = "#12161f"),
        cell_borders(sides = "left", color = "#00e5ff", weight = px(2))
      ),
      locations = cells_body(columns = Variable)
    ) %>%
    tab_style(
      style = list(
        cell_text(color = "#00e676", weight = "bold"),
        cell_fill(color = "rgba(0, 230, 118, 0.1)")
      ),
      locations = cells_body(
        columns = Descripcion,
        rows = Descripcion > 0.3
      )
    ) %>%
    tab_style(
      style = list(
        cell_text(color = "#a259ff", weight = "bold"),
        cell_fill(color = "rgba(162, 89, 255, 0.1)")
      ),
      locations = cells_body(
        columns = Interpretacion,
        rows = Interpretacion > 0.7
      )
    ) %>%
    tab_style(
      style = list(
        cell_text(color = "#ffd600"),
        cell_fill(color = "rgba(255, 214, 0, 0.08)")
      ),
      locations = cells_body(
        columns = Descripcion,
        rows = Descripcion >= 0.15 & Descripcion <= 0.3
      )
    ) %>%
    tab_style(
      style = list(
        cell_text(weight = "bold", color = "#00e5ff", size = "large")
      ),
      locations = cells_title(groups = "title")
    ) %>%
    tab_style(
      style = list(
        cell_text(color = "#8b92a0", size = "medium")
      ),
      locations = cells_title(groups = "subtitle")
    ) %>%
    tab_options(
      table.font.names = "Arial",
      table.width = pct(100),
      table.border.top.style = "none",
      table.border.bottom.style = "none",
      column_labels.border.top.style = "solid",
      column_labels.border.top.color = "#00e5ff",
      column_labels.border.top.width = px(3),
      column_labels.border.bottom.style = "solid",
      column_labels.border.bottom.width = px(3),
      column_labels.border.bottom.color = "#00e5ff",
      table_body.border.bottom.style = "none",
      table_body.border.top.style = "none",
      table_body.hlines.style = "solid",
      table_body.hlines.color = "#00e5ff",
      table_body.hlines.width = px(1),
      table.background.color = "#0a0e1a",
      data_row.padding = px(12),
      heading.title.font.size = 18,
      heading.subtitle.font.size = 14,
      heading.padding = px(12),
      heading.border.bottom.style = "solid",
      heading.border.bottom.width = px(2),
      heading.border.bottom.color = "#00e5ff",
      footnotes.padding = px(10),
      footnotes.font.size = 13,
      source_notes.font.size = 13,
      source_notes.padding = px(10)
    ) %>%
    tab_source_note(
      source_note = md("**Fuentes:** Elaboraci√≥n propia con base en los resultados del ACP")
    ) %>%
    tab_footnote(
      footnote = "Loading: Contribuci√≥n de la variable al componente. >0.3 = fuerte (verde), 0.15-0.3 = moderada (amarillo)",
      locations = cells_title(groups = "subtitle")
    ) %>%
    tab_footnote(
      footnote = "Cos¬≤: Calidad de representaci√≥n. >0.7 = excelente (p√∫rpura), valores cercanos a 1 = mejor representaci√≥n",
      locations = cells_body(rows = 1, columns = Interpretacion)
    )
  
  return(tabla)
}

tabla_pc1 <- crear_tabla_contribucion(
  1, contribuciones, cos2_df,
  "Contribuci√≥n de Variables al Componente Principal 1 (24.3% de varianza)",
  10
)

tabla_pc2 <- crear_tabla_contribucion(
  2, contribuciones, cos2_df,
  "Contribuci√≥n de Variables al Componente Principal 2 (13.5% de varianza)", 
  11
)

tabla_pc3 <- crear_tabla_contribucion(
  3, contribuciones, cos2_df,
  "Contribuci√≥n de Variables al Componente Principal 3 (9.1% de varianza)",
  12
)

tabla_pc4 <- crear_tabla_contribucion(
  4, contribuciones, cos2_df,
  "Contribuci√≥n de Variables al Componente Principal 4 (7.5% de varianza)",
  13
)

tabla_pc1
tabla_pc2
tabla_pc3
tabla_pc4
```

### An√°lisis Multivariado: Interpretaci√≥n de Componentes y Pa√≠ses

Una vez identificados los componentes principales y cuantificadas las contribuciones de cada variable, es fundamental realizar un an√°lisis multivariado que permita interpretar simult√°neamente las relaciones entre pa√≠ses y variables en el espacio reducido de componentes principales. Este an√°lisis se fundamenta en visualizaciones bidimensionales que proyectan tanto pa√≠ses (individuos) como variables sobre los planos definidos por pares de componentes principales, revelando patrones de similitud, agrupamientos naturales y caracter√≠sticas diferenciadoras entre grupos de pa√≠ses (Jolliffe, 2002; Hastie et al., 2009).

En la Gr√°fica 1 observamos la proyecci√≥n de los pa√≠ses en el espacio reducido de las dos primeras dimensiones del an√°lisis de componentes principales.

```{r individuos DIM 1 Y DIM 2, fig.height=8, fig.width=14, out.width="100%"}
ind_data <- get_pca_ind(res.pca)

ind_df <- data.frame(
  Pais = rownames(ind_data$coord),
  Dim1 = ind_data$coord[, 1],
  Dim2 = ind_data$coord[, 2],
  Dim3 = ind_data$coord[, 3],
  Dim4 = ind_data$coord[, 4],
  Contrib1 = ind_data$contrib[, 1],
  Contrib2 = ind_data$contrib[, 2],
  Contrib3 = ind_data$contrib[, 3],
  Contrib4 = ind_data$contrib[, 4],
  Cos2_1 = ind_data$cos2[, 1],
  Cos2_2 = ind_data$cos2[, 2],
  Cos2_3 = ind_data$cos2[, 3],
  Cos2_4 = ind_data$cos2[, 4]
)

cyber_color_scale <- colorRampPalette(c("#0084ff", "#00e5ff", "#a259ff", "#ff1744"))(100)

p1 <- plot_ly(ind_df,
              x = ~Dim1, 
              y = ~Dim2,
              color = ~Contrib1,
              colors = cyber_color_scale,
              text = ~paste("<b style='color:#00e5ff; font-size:14px;'>", Pais, "</b><br>",
                            "<span style='color:#8b92a0;'>COORDENADAS PCA:</span><br>",
                            "‚îú‚îÄ Dim 1: <b style='color:#00e676;'>", round(Dim1, 3), "</b><br>",
                            "‚îú‚îÄ Dim 2: <b style='color:#00e5ff;'>", round(Dim2, 3), "</b><br>",
                            "<br><span style='color:#8b92a0;'>CONTRIBUCI√ìN:</span><br>",
                            "‚îú‚îÄ Dim 1: <b style='color:#ffd600;'>", round(Contrib1, 2), "%</b><br>",
                            "‚îú‚îÄ Dim 2: <b style='color:#a259ff;'>", round(Contrib2, 2), "%</b><br>",
                            "<br><span style='color:#8b92a0;'>CALIDAD REPRESENTACI√ìN (Cos¬≤):</span><br>",
                            "‚îú‚îÄ Dim 1: <b style='color:#00e676;'>", round(Cos2_1, 3), "</b><br>",
                            "‚îî‚îÄ Dim 2: <b style='color:#0084ff;'>", round(Cos2_2, 3), "</b>"),
              type = "scatter",
              mode = "markers",
              marker = list(
                size = 12, 
                opacity = 0.85, 
                line = list(width = 1.5, color = "#ffffff"),
                symbol = 'circle'
              ),
              hovertemplate = '%{text}<extra></extra>') %>%
  
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:20px;'>Figura 10: An√°lisis de Componentes Principales</b><br>
             <span style='color:#8b92a0; font-size:14px;'>Individuos: Dimensi√≥n 1 vs Dimensi√≥n 2 | Coloreado por Contribuci√≥n a Dim 1</span>",
      x = 0.5,
      xanchor = 'center',
      y = 0.95
    ),
    xaxis = list(
      title = "<b style='font-size:14px;'>Dimensi√≥n 1</b>",
      zeroline = TRUE, 
      zerolinecolor = "rgba(0, 229, 255, 0.3)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      tickfont = list(color = '#8b92a0', size = 12),
      titlefont = list(color = '#e0e6ed', size = 14)
    ),
    yaxis = list(
      title = "<b style='font-size:14px;'>Dimensi√≥n 2</b>",
      zeroline = TRUE, 
      zerolinecolor = "rgba(0, 229, 255, 0.3)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      tickfont = list(color = '#8b92a0', size = 12),
      titlefont = list(color = '#e0e6ed', size = 14)
    ),
    hovermode = "closest",
    plot_bgcolor = '#000000',
    paper_bgcolor = '#0a0e1a',
    font = list(family = "Arial, sans-serif", color = '#e0e6ed', size = 12),
    margin = list(l = 80, r = 50, b = 80, t = 100),
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 12, family = "Arial")
    ),
    coloraxis = list(
      colorbar = list(
        title = list(
          text = "<b>Contribuci√≥n<br>Dim 1 (%)</b>",
          font = list(size = 12, color = "#e0e6ed")
        ),
        tickfont = list(color = '#8b92a0', size = 11),
        thickness = 20,
        len = 0.75
      )
    ),
    annotations = list(
      list(
        x = 0.5, 
        y = -0.12,
        xref = "paper", 
        yref = "paper",
        text = "<span style='color:#8b92a0; font-size:11px;'>Cada punto representa un pa√≠s. Colores indican contribuci√≥n a la Dimensi√≥n 1. Hover para detalles.</span>",
        showarrow = FALSE,
        xanchor = "center",
        align = "center"
      )
    )
  ) %>%
  
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "pca_individuos_dim1_dim2",
      width = 1200,
      height = 800
    )
  )

p1
```

En la dimensi√≥n 1, N√≠ger emerge como el mayor contribuidor, posicion√°ndose en el extremo negativo del eje que representa el d√©ficit en desarrollo humano y conectividad tecnol√≥gica, reflejando severas limitaciones en acceso a servicios b√°sicos, mortalidad infantil elevada y baja penetraci√≥n digital. Le sigue San Marino, ubicado en el extremo positivo, representando un microestado con indicadores de bienestar consolidados en salud y esperanza de vida. En la dimensi√≥n 2, Qatar lidera como mayor contribuidor, posicion√°ndose en el extremo inferior del eje, consolid√°ndose como econom√≠a petroqu√≠mica ultraespecializada con estructura industrial dominada por hidrocarburos y din√°micas demogr√°ficas at√≠picas. Islas Marshall emerge como segundo mayor contribuidor, ubic√°ndose en el extremo superior, caracteriz√°ndose como Estado insular vulnerable con alta dependencia de ayuda externa y servicios financieros.

En la Figura 9 observamos la proyecci√≥n de los pa√≠ses en el espacio reducido de las dos ultimas dimensiones del an√°lisis de componentes principales.

```{r individuos DIM 3 Y DIM 4, fig.height=8, fig.width=14, out.width="100%"}
p2 <- plot_ly(ind_df,
              x = ~Dim3, 
              y = ~Dim4,
              color = ~Contrib3,
              colors = cyber_color_scale,
              text = ~paste("<b style='color:#00e5ff; font-size:14px;'>", Pais, "</b><br>",
                            "<span style='color:#8b92a0;'>COORDENADAS PCA:</span><br>",
                            "‚îú‚îÄ Dim 3: <b style='color:#00e676;'>", round(Dim3, 3), "</b><br>",
                            "‚îú‚îÄ Dim 4: <b style='color:#00e5ff;'>", round(Dim4, 3), "</b><br>",
                            "<br><span style='color:#8b92a0;'>CONTRIBUCI√ìN:</span><br>",
                            "‚îú‚îÄ Dim 3: <b style='color:#ffd600;'>", round(Contrib3, 2), "%</b><br>",
                            "‚îú‚îÄ Dim 4: <b style='color:#a259ff;'>", round(Contrib4, 2), "%</b><br>",
                            "<br><span style='color:#8b92a0;'>CALIDAD REPRESENTACI√ìN (Cos¬≤):</span><br>",
                            "‚îú‚îÄ Dim 3: <b style='color:#00e676;'>", round(Cos2_3, 3), "</b><br>",
                            "‚îî‚îÄ Dim 4: <b style='color:#0084ff;'>", round(Cos2_4, 3), "</b>"),
              type = "scatter",
              mode = "markers",
              marker = list(
                size = 12, 
                opacity = 0.85, 
                line = list(width = 1.5, color = "#ffffff"),
                symbol = 'circle'
              ),
              hovertemplate = '%{text}<extra></extra>') %>%
  
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:20px;'>Figura 11: An√°lisis de Componentes Principales</b><br>
             <span style='color:#8b92a0; font-size:14px;'>Individuos: Dimensi√≥n 3 vs Dimensi√≥n 4 | Coloreado por Contribuci√≥n a Dim 3</span>",
      x = 0.5,
      xanchor = 'center',
      y = 0.95
    ),
    xaxis = list(
      title = "<b style='font-size:14px;'>Dimensi√≥n 3</b>",
      zeroline = TRUE, 
      zerolinecolor = "rgba(0, 229, 255, 0.3)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      tickfont = list(color = '#8b92a0', size = 12),
      titlefont = list(color = '#e0e6ed', size = 14)
    ),
    yaxis = list(
      title = "<b style='font-size:14px;'>Dimensi√≥n 4</b>",
      zeroline = TRUE, 
      zerolinecolor = "rgba(0, 229, 255, 0.3)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      tickfont = list(color = '#8b92a0', size = 12),
      titlefont = list(color = '#e0e6ed', size = 14)
    ),
    hovermode = "closest",
    plot_bgcolor = '#000000',
    paper_bgcolor = '#0a0e1a',
    font = list(family = "Arial, sans-serif", color = '#e0e6ed', size = 12),
    margin = list(l = 80, r = 50, b = 80, t = 100),
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 12, family = "Arial")
    ),
    coloraxis = list(
      colorbar = list(
        title = list(
          text = "<b>Contribuci√≥n<br>Dim 3 (%)</b>",
          font = list(size = 12, color = "#e0e6ed")
        ),
        tickfont = list(color = '#8b92a0', size = 11),
        thickness = 20,
        len = 0.75
      )
    ),
    annotations = list(
      list(
        x = 0.5, 
        y = -0.12,
        xref = "paper", 
        yref = "paper",
        text = "<span style='color:#8b92a0; font-size:11px;'>Cada punto representa un pa√≠s. Colores indican contribuci√≥n a la Dimensi√≥n 3. Hover para detalles.</span>",
        showarrow = FALSE,
        xanchor = "center",
        align = "center"
      )
    )
  ) %>%
  
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "pca_individuos_dim3_dim4",
      width = 1200,
      height = 800
    )
  )

p2
```

En la dimensi√≥n 3, Malta emerge como el mayor contribuidor, posicion√°ndose en el extremo positivo del eje que representa econom√≠as hiperglobalizadas con ratios comerciales excesivamente altos, reflejando su condici√≥n de centro financiero y comercial con flujos internacionales que superan significativamente su PIB. China se sit√∫a en el extremo negativo, evidenciando una estructura comercial m√°s balanceada basada en exportaciones de manufactura y sostenida por una vasta base poblacional. En la dimensi√≥n 4, India se coloca en el extremo negativo, reflejando presi√≥n demogr√°fica extrema sobre recursos naturales (1,400 millones de habitantes sobre territorio limitado generan demanda exponencial de tierra cultivable y agua). Timor-Leste se ubica en el extremo positivo, caracteriz√°ndose por baja densidad poblacional relativa y abundancia de cobertura forestal.

### Representaci√≥n de Variables en el Plano de Componentes Principales

El c√≠rculo de correlaciones es una herramienta fundamental para interpretar las dimensiones latentes capturadas por los componentes principales. Cada una de las 17 variables originales se representa como un vector (flecha) proyectado desde el origen hacia el plano bidimensional definido por los dos primeros componentes principales. La longitud de cada flecha indica la calidad de representaci√≥n de esa variable: flechas largas (pr√≥ximas al c√≠rculo unitario de referencia) indican variables bien representadas los componentes principales, mientras que flechas cortas indican que la variable requiere componentes posteriores para ser completamente explicada (Jolliffe, 2002; Hastie et al., 2009).

La direcci√≥n de cada flecha es decir, el √°ngulo que forma con los ejes indica c√≥mo esa variable se correlaciona con los componentes. Las variables posicionadas en la direcci√≥n positiva del eje PC1 (hacia la derecha del gr√°fico) son aquellas que correlacionan positivamente con PC1 y, por lo tanto, caracterizan el polo derecho del eje.

En la Figura 10, correspondiente al c√≠rculo de correlaciones, observamos la proyecci√≥n de las 17 variables originales en el plano definido por los dos primeros componentes principales.

```{r Variables DIM 1 Y DIM 2., fig.height=7, fig.width=12, out.width="100%"}
var_data <- get_pca_var(res.pca)

var_df <- data.frame(
  Variable = rownames(var_data$coord),
  Dim1 = var_data$coord[, 1],
  Dim2 = var_data$coord[, 2],
  Dim3 = var_data$coord[, 3],
  Dim4 = var_data$coord[, 4],
  Dim5 = var_data$coord[, 5],
  Dim6 = var_data$coord[, 6],
  Contrib1 = var_data$contrib[, 1],
  Contrib2 = var_data$contrib[, 2],
  Contrib3 = var_data$contrib[, 3],
  Contrib4 = var_data$contrib[, 4],
  Contrib5 = var_data$contrib[, 5],
  Contrib6 = var_data$contrib[, 6],
  Cos2_1 = var_data$cos2[, 1],
  Cos2_2 = var_data$cos2[, 2],
  Cos2_3 = var_data$cos2[, 3],
  Cos2_4 = var_data$cos2[, 4],
  Cos2_5 = var_data$cos2[, 5],
  Cos2_6 = var_data$cos2[, 6]
)

p1 <- plot_ly(var_df,
              x = ~Dim1, 
              y = ~Dim2,
              color = ~Contrib1,
              colors = cyber_color_scale,
              text = ~paste("<b style='color:#00e5ff; font-size:14px;'>", Variable, "</b><br>",
                            "<span style='color:#8b92a0;'>COORDENADAS PCA:</span><br>",
                            "‚îú‚îÄ Dim 1: <b style='color:#00e676;'>", round(Dim1, 3), "</b><br>",
                            "‚îú‚îÄ Dim 2: <b style='color:#00e5ff;'>", round(Dim2, 3), "</b><br>",
                            "<br><span style='color:#8b92a0;'>CONTRIBUCI√ìN:</span><br>",
                            "‚îú‚îÄ Dim 1: <b style='color:#ffd600;'>", round(Contrib1, 2), "%</b><br>",
                            "‚îú‚îÄ Dim 2: <b style='color:#a259ff;'>", round(Contrib2, 2), "%</b><br>",
                            "<br><span style='color:#8b92a0;'>CALIDAD (Cos¬≤):</span><br>",
                            "‚îú‚îÄ Dim 1: <b style='color:#00e676;'>", round(Cos2_1, 3), "</b><br>",
                            "‚îî‚îÄ Dim 2: <b style='color:#0084ff;'>", round(Cos2_2, 3), "</b>"),
              type = "scatter",
              mode = "markers",
              marker = list(
                size = 7,
                opacity = 0.8, 
                line = list(width = 0.5, color = "#ffffff"),
                symbol = 'circle'
              ),
              hovertemplate = '%{text}<extra></extra>') %>%
  
  add_segments(x = 0, xend = ~Dim1, y = 0, yend = ~Dim2,
               line = list(color = "rgba(0, 229, 255, 0.5)", width = 1.2),
               showlegend = FALSE, hoverinfo = "skip") %>%
  
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:20px;'>Figura 12: Variables-Dimensi√≥n 1 vs Dimensi√≥n 2</b><br>
             <span style='color:#8b92a0; font-size:14px;'>Coloreado por Contribuci√≥n a Dimensi√≥n 1</span>",
      x = 0.5,
      xanchor = 'center',
      y = 0.95
    ),
    xaxis = list(
      title = "<b style='font-size:14px;'>Dimensi√≥n 1</b>",
      zeroline = TRUE, 
      zerolinecolor = "rgba(0, 229, 255, 0.6)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      range = c(-1.1, 1.1),
      tickfont = list(color = '#8b92a0', size = 12),
      titlefont = list(color = '#e0e6ed', size = 14)
    ),
    yaxis = list(
      title = "<b style='font-size:14px;'>Dimensi√≥n 2</b>",
      zeroline = TRUE, 
      zerolinecolor = "rgba(0, 229, 255, 0.6)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      range = c(-1.1, 1.1),
      tickfont = list(color = '#8b92a0', size = 12),
      titlefont = list(color = '#e0e6ed', size = 14)
    ),
    hovermode = "closest",
    plot_bgcolor = '#000000',
    paper_bgcolor = '#0a0e1a',
    font = list(family = "Arial, sans-serif", color = '#e0e6ed', size = 12),
    margin = list(l = 80, r = 80, b = 80, t = 100),
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 11, family = "Arial")
    ),
    coloraxis = list(
      colorbar = list(
        title = list(
          text = "<b>Contribuci√≥n<br>Dim 1 (%)</b>",
          font = list(size = 12, color = "#e0e6ed")
        ),
        tickfont = list(color = '#8b92a0', size = 11),
        thickness = 20,
        len = 0.75
      )
    ),
    shapes = list(
      list(
        type = "circle",
        x0 = -1, x1 = 1,
        y0 = -1, y1 = 1,
        xref = "x", yref = "y",
        line = list(color = "rgba(0, 229, 255, 0.3)", width = 1.5, dash = "dash")
      )
    ),
    annotations = list(
      list(
        x = 0.5, 
        y = -0.12,
        xref = "paper", 
        yref = "paper",
        text = "<span style='color:#8b92a0; font-size:11px;'>Pasa el mouse sobre los puntos para ver detalles. Vectores = direcci√≥n e importancia de variables.</span>",
        showarrow = FALSE,
        xanchor = "center",
        align = "center"
      )
    )
  ) %>%
  
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "pca_variables_dim1_dim2",
      width = 1200,
      height = 800
    )
  )

p1

```

En la dimensi√≥n 1, la Esperanza de vida lidera, posicion√°ndose en el extremo positivo, consolidando un eje que representa desarrollo humano y calidad de vida. Simult√°neamente, la Mortalidad infantil se posiciona en el extremo negativo, estableciendo un contraste fundamental entre naciones con alta esperanza de vida versus aquellas con elevada mortalidad neonatal refleja de sistemas de salud deficitarios. En la dimensi√≥n 2, la Industria en el extremo negativo refleja econom√≠as donde la dependencia de una √∫nica rama industrial es REDUCIDA o donde la manufactura est√° integrada verticalmente de manera aut√≥noma. Las Remesas emergen como segundo vector importante en el extremo positivo, capturando econom√≠as ALTAMENTE DEPENDIENTES de transferencias de capital internacional, caracterizadas por d√©bil base productiva propia y vulnerabilidad a ciclos externos.

En la Figura 11, correspondiente al c√≠rculo de correlaciones, observamos la proyecci√≥n de las 17 variables originales en el plano definido por los componentes principales 3 y 4.

```{r Variables DIM 3 Y DIM 4, fig.height=7, fig.width=12, out.width="100%"}
p2 <- plot_ly(var_df,
              x = ~Dim3, 
              y = ~Dim4,
              color = ~Contrib3,
              colors = cyber_color_scale,
              text = ~paste("<b style='color:#00e5ff; font-size:14px;'>", Variable, "</b><br>",
                            "<span style='color:#8b92a0;'>COORDENADAS PCA:</span><br>",
                            "‚îú‚îÄ Dim 3: <b style='color:#00e676;'>", round(Dim3, 3), "</b><br>",
                            "‚îú‚îÄ Dim 4: <b style='color:#00e5ff;'>", round(Dim4, 3), "</b><br>",
                            "<br><span style='color:#8b92a0;'>CONTRIBUCI√ìN:</span><br>",
                            "‚îú‚îÄ Dim 3: <b style='color:#ffd600;'>", round(Contrib3, 2), "%</b><br>",
                            "‚îú‚îÄ Dim 4: <b style='color:#a259ff;'>", round(Contrib4, 2), "%</b><br>",
                            "<br><span style='color:#8b92a0;'>CALIDAD (Cos¬≤):</span><br>",
                            "‚îú‚îÄ Dim 3: <b style='color:#00e676;'>", round(Cos2_3, 3), "</b><br>",
                            "‚îî‚îÄ Dim 4: <b style='color:#0084ff;'>", round(Cos2_4, 3), "</b>"),
              type = "scatter",
              mode = "markers",
              marker = list(
                size = 7,
                opacity = 0.8, 
                line = list(width = 0.5, color = "#ffffff"),
                symbol = 'circle'
              ),
              hovertemplate = '%{text}<extra></extra>') %>%
  
  add_segments(x = 0, xend = ~Dim3, y = 0, yend = ~Dim4,
               line = list(color = "rgba(0, 229, 255, 0.5)", width = 1.2),
               showlegend = FALSE, hoverinfo = "skip") %>%
  
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:20px;'>Figura 13: Variables-Dimensi√≥n 3 vs Dimensi√≥n 4</b><br>
             <span style='color:#8b92a0; font-size:14px;'>Coloreado por Contribuci√≥n a Dimensi√≥n 3</span>",
      x = 0.5,
      xanchor = 'center',
      y = 0.95
    ),
    xaxis = list(
      title = "<b style='font-size:14px;'>Dimensi√≥n 3</b>",
      zeroline = TRUE, 
      zerolinecolor = "rgba(0, 229, 255, 0.6)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      range = c(-1.1, 1.1),
      tickfont = list(color = '#8b92a0', size = 12),
      titlefont = list(color = '#e0e6ed', size = 14)
    ),
    yaxis = list(
      title = "<b style='font-size:14px;'>Dimensi√≥n 4</b>",
      zeroline = TRUE, 
      zerolinecolor = "rgba(0, 229, 255, 0.6)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      range = c(-1.1, 1.1),
      tickfont = list(color = '#8b92a0', size = 12),
      titlefont = list(color = '#e0e6ed', size = 14)
    ),
    hovermode = "closest",
    plot_bgcolor = '#000000',
    paper_bgcolor = '#0a0e1a',
    font = list(family = "Arial, sans-serif", color = '#e0e6ed', size = 12),
    margin = list(l = 80, r = 80, b = 80, t = 100),
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 11, family = "Arial")
    ),
    coloraxis = list(
      colorbar = list(
        title = list(
          text = "<b>Contribuci√≥n<br>Dim 3 (%)</b>",
          font = list(size = 12, color = "#e0e6ed")
        ),
        tickfont = list(color = '#8b92a0', size = 11),
        thickness = 20,
        len = 0.75
      )
    ),
    shapes = list(
      list(
        type = "circle",
        x0 = -1, x1 = 1,
        y0 = -1, y1 = 1,
        xref = "x", yref = "y",
        line = list(color = "rgba(0, 229, 255, 0.3)", width = 1.5, dash = "dash")
      )
    ),
    annotations = list(
      list(
        x = 0.5, 
        y = -0.12,
        xref = "paper", 
        yref = "paper",
        text = "<span style='color:#8b92a0; font-size:11px;'>Pasa el mouse sobre los puntos para ver detalles. Vectores = direcci√≥n e importancia de variables.</span>",
        showarrow = FALSE,
        xanchor = "center",
        align = "center"
      )
    )
  ) %>%
  
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "pca_variables_dim3_dim4",
      width = 1200,
      height = 800
    )
  )

p2
```

En la dimensi√≥n 3, las Importaciones, Exportaciones e Inversi√≥n extranjera se posicionan en el extremo positivo, caracterizando econom√≠as altamente integradas en cadenas de valor globales con comercio y flujos de inversi√≥n exponenciados. Malta (comercio \>260% del PIB), Singapur, Irlanda y otros micro-Estados/hubs financieros ocupan este polo.

En el extremo negativo se ubican √Årea boscosa y Poblaci√≥n, pa√≠ses que preservan ecosistemas naturales tienden a tener menor integraci√≥n comercial. Esto refleja que naciones con biodiversidad conservada (Timor-Leste, algunos pa√≠ses amaz√≥nicos con 70%+ bosques) t√≠picamente tienen econom√≠as m√°s locales, menos insertadas en globalizaci√≥n, y mercados m√°s peque√±os.

### An√°lisis Integrado de Variables y Pa√≠ses

El an√°lisis combinado de las variables y los pa√≠ses en el espacio reducido de los componentes principales permite identificar patrones de asociaci√≥n estructural que trascienden el an√°lisis univariable. La metodolog√≠a del biplot permite vincular directamente las posiciones espaciales de los pa√≠ses con las magnitudes observadas en las variables originales, estableciendo relaciones interpretativas que evidencian c√≥mo las caracter√≠sticas multidimensionales de desarrollo se manifiestan diferencialmente en distintos grupos de pa√≠ses (Jolliffe, 2002; Hastie et al., 2009).

Para comprender la l√≥gica interpretativa del biplot, es fundamental reconocer que la posici√≥n de un pa√≠s en relaci√≥n a la direcci√≥n de una flecha de variable indica el valor relativo de ese pa√≠s en esa variable espec√≠fica. Pa√≠ses ubicados en la misma direcci√≥n que una flecha exhiben valores altos en esa variable; pa√≠ses ubicados en direcci√≥n opuesta exhiben valores bajos; pa√≠ses ubicados perpendicularmente (formando √°ngulos de \~$90¬∞$) exhiben valores cercanos a la media global. Esta propiedad geom√©trica del biplot permite realizar diagn√≥sticos cuantitativos directamente desde la visualizaci√≥n gr√°fica, sin necesidad de consultar la base de datos original, siempre que la calidad de representaci√≥n ($cos¬≤$) sea suficientemente alta (Jolliffe, 2002).

```{r Paises y variables DIM 1 Y DIM 2, fig.height=8, fig.width=12, out.width="100%"}

acp_prcomp <- prcomp(datos_analisis, center = TRUE, scale. = TRUE)
ind_data <- get_pca_ind(acp_prcomp)
var_data <- get_pca_var(acp_prcomp)

ind_df <- data.frame(
  Pais = rownames(ind_data$coord),
  Dim1 = ind_data$coord[, 1],
  Dim2 = ind_data$coord[, 2],
  Dim3 = ind_data$coord[, 3],
  Dim4 = ind_data$coord[, 4],
  Contrib1 = ind_data$contrib[, 1],
  Contrib2 = ind_data$contrib[, 2],
  Contrib3 = ind_data$contrib[, 3],
  Contrib4 = ind_data$contrib[, 4]
)

var_df <- data.frame(
  Variable = rownames(var_data$coord),
  Dim1 = var_data$coord[, 1] * 3,
  Dim2 = var_data$coord[, 2] * 3,
  Dim3 = var_data$coord[, 3] * 3,
  Dim4 = var_data$coord[, 4] * 3,
  Contrib1 = var_data$contrib[, 1],
  Contrib2 = var_data$contrib[, 2],
  Contrib3 = var_data$contrib[, 3],
  Contrib4 = var_data$contrib[, 4]
)

p1 <- plot_ly() %>%
  
  add_segments(
    data = var_df,
    x = 0, xend = ~Dim1, y = 0, yend = ~Dim2,
    line = list(color = "#00e5ff", width = 2),
    showlegend = FALSE, hoverinfo = "skip"
  ) %>%
  
  add_trace(
    data = var_df,
    x = ~Dim1, y = ~Dim2,
    text = ~paste("<b style='color:#00e5ff; font-size:14px;'>", Variable, "</b><br>",
                  "<span style='color:#8b92a0;'>COORDENADAS:</span><br>",
                  "‚îú‚îÄ Dim 1: <b style='color:#00e676;'>", round(Dim1/3, 3), "</b><br>",
                  "‚îú‚îÄ Dim 2: <b style='color:#00e5ff;'>", round(Dim2/3, 3), "</b><br>",
                  "<br><span style='color:#8b92a0;'>CONTRIBUCI√ìN:</span><br>",
                  "‚îú‚îÄ Dim 1: <b style='color:#ffd600;'>", round(Contrib1, 2), "%</b><br>",
                  "‚îî‚îÄ Dim 2: <b style='color:#a259ff;'>", round(Contrib2, 2), "%</b>"),
    type = "scatter",
    mode = "markers",
    marker = list(
      size = 10, 
      color = "#00e5ff", 
      opacity = 0.9, 
      line = list(width = 1.5, color = "#ffffff")
    ),
    hovertemplate = '%{text}<extra></extra>',
    name = "Variables",
    showlegend = TRUE
  ) %>%
  
  add_trace(
    data = ind_df,
    x = ~Dim1, y = ~Dim2,
    text = ~paste("<b style='color:#00e5ff; font-size:14px;'>", Pais, "</b><br>",
                  "<span style='color:#8b92a0;'>COORDENADAS:</span><br>",
                  "‚îú‚îÄ Dim 1: <b style='color:#00e676;'>", round(Dim1, 3), "</b><br>",
                  "‚îú‚îÄ Dim 2: <b style='color:#00e5ff;'>", round(Dim2, 3), "</b><br>",
                  "<br><span style='color:#8b92a0;'>CONTRIBUCI√ìN:</span><br>",
                  "‚îú‚îÄ Dim 1: <b style='color:#ffd600;'>", round(Contrib1, 2), "%</b><br>",
                  "‚îî‚îÄ Dim 2: <b style='color:#a259ff;'>", round(Contrib2, 2), "%</b>"),
    type = "scatter",
    mode = "markers",
    marker = list(
      size = 6, 
      color = "#4a9eff", 
      opacity = 0.5, 
      line = list(width = 0.5, color = "#00e5ff")
    ),
    hovertemplate = '%{text}<extra></extra>',
    name = "Pa√≠ses",
    showlegend = TRUE
  ) %>%
  
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:22px;'>Figura 14: Biplot-Dimensi√≥n 1 vs Dimensi√≥n 2</b><br>
             <span style='color:#8b92a0; font-size:13px;'></span>",
      x = 0.5,
      xanchor = 'center',
      y = 0.98
    ),
    xaxis = list(
      title = "<b style='font-size:14px;'>Dimensi√≥n 1</b>",
      zeroline = TRUE, 
      zerolinecolor = "rgba(0, 229, 255, 0.6)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      tickfont = list(color = '#8b92a0', size = 12),
      titlefont = list(color = '#e0e6ed', size = 14)
    ),
    yaxis = list(
      title = "<b style='font-size:14px;'>Dimensi√≥n 2</b>",
      zeroline = TRUE, 
      zerolinecolor = "rgba(0, 229, 255, 0.6)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      tickfont = list(color = '#8b92a0', size = 12),
      titlefont = list(color = '#e0e6ed', size = 14)
    ),
    hovermode = "closest",
    plot_bgcolor = '#000000',
    paper_bgcolor = '#0a0e1a',
    font = list(family = "Arial, sans-serif", color = '#e0e6ed', size = 12),
    margin = list(l = 80, r = 80, b = 80, t = 120),
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 11, family = "Arial")
    ),
    legend = list(
      bgcolor = "rgba(10, 14, 26, 0.9)",
      bordercolor = "#00e5ff",
      borderwidth = 1.5,
      font = list(size = 12, color = "#e0e6ed"),
      x = 0.02,
      y = 0.98,
      xanchor = "left",
      yanchor = "top"
    ),
    annotations = list(
      list(
        x = 0.5, 
        y = -0.12,
        xref = "paper", 
        yref = "paper",
        text = "<span style='color:#8b92a0; font-size:11px;'>Vectores cyan = direcciones de m√°xima varianza | Puntos azules = posiciones de pa√≠ses en el espacio PCA</span>",
        showarrow = FALSE,
        xanchor = "center",
        align = "center"
      )
    )
  ) %>%
  
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "biplot_dim1_dim2",
      width = 1400,
      height = 900
    )
  )

p1

```

Senegal y Burkina Faso se alinean con la flecha de mortalidad infantil, confirmando valores altos en esa variable. Egipto se alinea con crecimiento poblacional, indicando tasa de crecimiento demogr√°fico elevada. Corea del Sur y Nueva Zelanda se alinean con exportaciones, indicando econom√≠as muy orientadas a comercio externo. Suiza se alinea con esperanza de vida, confirmando longevidad excepcional.

En direcci√≥n opuesta: pa√≠ses desarrollados europeos se oponen a flechas de mortalidad y rezago, reflejando valores bajos en estos indicadores negativos. Honduras y Rep√∫blica Kirguisa se alinean con remesas, indicando dependencia cr√≠tica de transferencias de migrantes.

```{r Paises y variables DIM 3 Y DIM 4, fig.height=8, fig.width=12, out.width="100%"}

p2 <- plot_ly() %>%
  
  add_segments(
    data = var_df,
    x = 0, xend = ~Dim3, y = 0, yend = ~Dim4,
    line = list(color = "#00e5ff", width = 2),
    showlegend = FALSE, hoverinfo = "skip"
  ) %>%
  
  add_trace(
    data = var_df,
    x = ~Dim3, y = ~Dim4,
    text = ~paste("<b style='color:#00e5ff; font-size:14px;'>", Variable, "</b><br>",
                  "<span style='color:#8b92a0;'>COORDENADAS:</span><br>",
                  "‚îú‚îÄ Dim 3: <b style='color:#00e676;'>", round(Dim3/3, 3), "</b><br>",
                  "‚îú‚îÄ Dim 4: <b style='color:#00e5ff;'>", round(Dim4/3, 3), "</b><br>",
                  "<br><span style='color:#8b92a0;'>CONTRIBUCI√ìN:</span><br>",
                  "‚îú‚îÄ Dim 3: <b style='color:#ffd600;'>", round(Contrib3, 2), "%</b><br>",
                  "‚îî‚îÄ Dim 4: <b style='color:#a259ff;'>", round(Contrib4, 2), "%</b>"),
    type = "scatter",
    mode = "markers",
    marker = list(
      size = 10, 
      color = "#00e5ff", 
      opacity = 0.9, 
      line = list(width = 1.5, color = "#ffffff")
    ),
    hovertemplate = '%{text}<extra></extra>',
    name = "Variables",
    showlegend = TRUE
  ) %>%
  
  add_trace(
    data = ind_df,
    x = ~Dim3, y = ~Dim4,
    text = ~paste("<b style='color:#00e5ff; font-size:14px;'>", Pais, "</b><br>",
                  "<span style='color:#8b92a0;'>COORDENADAS:</span><br>",
                  "‚îú‚îÄ Dim 3: <b style='color:#00e676;'>", round(Dim3, 3), "</b><br>",
                  "‚îú‚îÄ Dim 4: <b style='color:#00e5ff;'>", round(Dim4, 3), "</b><br>",
                  "<br><span style='color:#8b92a0;'>CONTRIBUCI√ìN:</span><br>",
                  "‚îú‚îÄ Dim 3: <b style='color:#ffd600;'>", round(Contrib3, 2), "%</b><br>",
                  "‚îî‚îÄ Dim 4: <b style='color:#a259ff;'>", round(Contrib4, 2), "%</b>"),
    type = "scatter",
    mode = "markers",
    marker = list(
      size = 6, 
      color = "#4a9eff", 
      opacity = 0.5, 
      line = list(width = 0.5, color = "#00e5ff")
    ),
    hovertemplate = '%{text}<extra></extra>',
    name = "Pa√≠ses",
    showlegend = TRUE
  ) %>%
  
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:22px;'>Figura 15: Biplot-Dimensi√≥n 3 vs Dimensi√≥n 4</b><br>
             <span style='color:#8b92a0; font-size:13px;'></span>",
      x = 0.5,
      xanchor = 'center',
      y = 0.98
    ),
    xaxis = list(
      title = "<b style='font-size:14px;'>Dimensi√≥n 3</b>",
      zeroline = TRUE, 
      zerolinecolor = "rgba(0, 229, 255, 0.6)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      tickfont = list(color = '#8b92a0', size = 12),
      titlefont = list(color = '#e0e6ed', size = 14)
    ),
    yaxis = list(
      title = "<b style='font-size:14px;'>Dimensi√≥n 4</b>",
      zeroline = TRUE, 
      zerolinecolor = "rgba(0, 229, 255, 0.6)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      tickfont = list(color = '#8b92a0', size = 12),
      titlefont = list(color = '#e0e6ed', size = 14)
    ),
    hovermode = "closest",
    plot_bgcolor = '#000000',
    paper_bgcolor = '#0a0e1a',
    font = list(family = "Arial, sans-serif", color = '#e0e6ed', size = 12),
    margin = list(l = 80, r = 80, b = 80, t = 120),
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 11, family = "Arial")
    ),
    legend = list(
      bgcolor = "rgba(10, 14, 26, 0.9)",
      bordercolor = "#00e5ff",
      borderwidth = 1.5,
      font = list(size = 12, color = "#e0e6ed"),
      x = 0.02,
      y = 0.98,
      xanchor = "left",
      yanchor = "top"
    ),
    annotations = list(
      list(
        x = 0.5, 
        y = -0.12,
        xref = "paper", 
        yref = "paper",
        text = "<span style='color:#8b92a0; font-size:11px;'>Vectores cyan = direcciones de m√°xima varianza | Puntos azules = posiciones de pa√≠ses en el espacio PCA</span>",
        showarrow = FALSE,
        xanchor = "center",
        align = "center"
      )
    )
  ) %>%
  
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "biplot_dim3_dim4",
      width = 1400,
      height = 900
    )
  )

p2

```

Guinea se posiciona en la direcci√≥n de crecimiento poblacional, indicando valores altos en esta variable. Kuwait y Djibouti se alinean con importaciones, indicando ratios elevados. Senegal e Irlanda se alinean con exportaciones, indicando orientaci√≥n exportadora. Burkina Faso y Qatar se alinean con mortalidad infantil, indicando valores en esta variable. Macedonia del Norte se alinea con PIB per c√°pita, indicando ingreso por habitante en esa direcci√≥n.

### Caracterizacion de los componentes principales

```{r caracterizacion dimensiones}

dimensiones_tabla <- tribble(
  ~Dimensi√≥n, ~Descripci√≥n, ~Variables, ~Ejemplo_Pa√≠ses,
  
  "Dimensi√≥n 1", 
  "Nivel de desarrollo humano y tecnol√≥gico", 
  "Uso de internet, Esperanza de vida, Mortalidad infantil", 
  "Burundi (Poca, Poca, Mucha); Australia (Mucha, Mucha, Poca); Cambodia (Media, Media, Media)",
  
  "Dimensi√≥n 2", 
  "Industrializaci√≥n y crecimiento demogr√°fico", 
  "Industria, Crecimiento poblacional, Remesas", 
  "China (Mucha, Media, Poca); Comoros (Poca, Poca, Mucha); Algeria (Mucha, Mucha, Poca)",
  
  "Dimensi√≥n 3", 
  "Comercio internacional", 
  "Importaciones, Exportaciones, Inversi√≥n extranjera", 
  "Malta (Mucha, Mucha, Mucha); Djibouti (Mucha, Mucha, Media); San Marino (Mucha, Mucha, Media)",
  
  "Dimensi√≥n 4", 
  "Uso del suelo y demograf√≠a", 
  "√Årea boscosa, Tierra cultivable, Poblaci√≥n", 
  "India (Poca, Mucha, Mucha); Timor Leste (Media, Poca, ‚Äî); China (Poca, Poca, Mucha)"
)

dimensiones_tabla %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 14**"),
    subtitle = "Interpretaci√≥n de las Dimensiones obtenidas del An√°lisis de Componentes Principales (ACP)"
  ) %>%
  cols_label(
    Dimensi√≥n = md("**Dimensi√≥n**"),
    Descripci√≥n = md("**Descripci√≥n**"),
    Variables = md("**Variables Asociadas**"),
    Ejemplo_Pa√≠ses = md("**Ejemplo de Pa√≠ses**")
  ) %>%
  cols_align(
    align = "left",
    columns = everything()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium", color = "#000000"),
      cell_fill(color = "#00e5ff")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "#00e5ff",
      weight = px(2)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "#00e5ff",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Dimensi√≥n, Descripci√≥n, Variables))
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#0a0e1a"),
      cell_text(color = "#e0e6ed")
    ),
    locations = cells_body()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff"),
      cell_fill(color = "#12161f")
    ),
    locations = cells_body(columns = Dimensi√≥n)
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff", size = "large")
    ),
    locations = cells_title(groups = "title")
  ) %>%
  tab_style(
    style = list(
      cell_text(color = "#8b92a0", size = "medium")
    ),
    locations = cells_title(groups = "subtitle")
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "solid",
    column_labels.border.top.color = "#00e5ff",
    column_labels.border.top.width = px(3),
    column_labels.border.bottom.style = "solid",
    column_labels.border.bottom.width = px(3),
    column_labels.border.bottom.color = "#00e5ff",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    table_body.hlines.style = "solid",
    table_body.hlines.color = "#00e5ff",
    table_body.hlines.width = px(1),
    table.background.color = "#0a0e1a",
    data_row.padding = px(12),
    heading.title.font.size = 18,
    heading.subtitle.font.size = 14,
    heading.padding = px(12),
    heading.border.bottom.style = "solid",
    heading.border.bottom.width = px(2),
    heading.border.bottom.color = "#00e5ff",
    footnotes.padding = px(10),
    footnotes.font.size = 13,
    source_notes.font.size = 13,
    source_notes.padding = px(10)
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboraci√≥n propia con base en los resultados del ACP")
  )

```

## Segmentaci√≥n: Clusterizaci√≥n

Sobre la base de los k componentes principales retenidos del An√°lisis de Componentes Principales, se aplic√≥ el m√©todo de Ward para clusterizaci√≥n jer√°rquica aglomerativa. Este algoritmo organiza los datos con el objetivo de determinar clusters de pa√≠ses mediante un enfoque que se basa en la distancia entre los puntos para mostrar posibles agrupamientos. El procedimiento iterativo de fusi√≥n permite identificar estructuras naturales de similitud que trascienden clasificaciones geogr√°ficas o econ√≥micas convencionales, revelando en cambio grupos de pa√≠ses que comparten perfiles multidimensionales coherentes de desarrollo (Ward, 1963; Hastie et al., 2009).

El m√©todo de Ward minimiza espec√≠ficamente la suma total de cuadrados dentro de clusters (*within-cluster sum of squares*, WCSS), definida matem√°ticamente como:

$$WCSS = \sum_{c=1}^{C} \sum_{i \in c} ||x_i - \bar{c}||^2$$

donde: $C$ es el n√∫mero de clusters, $x_i$ es la posici√≥n de la observaci√≥n $i$ en el espacio de componentes principales, $\bar{c}$ es el centroide (promedio) del cluster $c$.

En cada paso del algoritmo, se identifican los dos clusters cuya fusi√≥n produce el incremento m√≠nimo en WCSS total, maximizando as√≠ la homogeneidad interna de cada cluster mientras se maximiza la disimilaridad entre clusters (Ward, 1963; Hastie et al., 2009).

```{r clusters, message=FALSE, warning=FALSE, results='hide'}

resultado_ACP <- FactoClass(
  datos_analisis,  
  dudi.pca,       
  nf = 4,           
  k.clust = 3,      
  scan = FALSE     
)

clusters_asignados <- resultado_ACP$cluster

NuevaBase <- data.frame(Cluster = clusters_asignados, datos_analisis)
```

### Numero optimo de clusters

La selecci√≥n del n√∫mero √≥ptimo de clusters k se realiz√≥ mediante la evaluaci√≥n conjunta de tres criterios complementarios: an√°lisis del dendrograma, m√©todo del codo, y coherencia interpretativa. El dendrograma revela visualmente la estructura jer√°rquica de fusiones: se identifican alturas donde las fusiones producen incrementos dram√°ticos en disimilaridad, sugiriendo que clusters diferenciados se est√°n uniendo. Un corte horizontal del dendrograma a altura intermedia permite definir el n√∫mero de clusters finales.

```{r DENDO, fig.height=7, fig.width=12, out.width="100%"}
coordenadas_pca <- as.data.frame(resultado_ACP$dudi$li[, 1:4])
distancias <- dist(coordenadas_pca)
hc <- hclust(distancias, method = "ward.D2")
k <- 3

cluster_colors <- c("1" = "#00e676",   
                    "2" = "#0084ff",    
                    "3" = "#ffd600")  

clusters <- cutree(hc, k = k)
dend <- as.dendrogram(hc)
dend_data <- dendro_data(dend)
leaf_x <- dend_data$labels$x
leaf_names <- as.character(dend_data$labels$label)
names(clusters) <- rownames(coordenadas_pca)
label_clusters <- clusters[match(leaf_names, names(clusters))]

if (any(is.na(label_clusters))) {
  idx_num <- suppressWarnings(as.integer(leaf_names))
  if (!all(is.na(idx_num))) {
    label_clusters[is.na(label_clusters)] <- clusters[idx_num[is.na(label_clusters)]]
  }
}

label_clusters <- as.integer(label_clusters)
dxs <- sort(unique(diff(sort(leaf_x))))
pad <- ifelse(length(dxs) > 0, dxs[1] / 2, 0.5)
max_y <- max(dend_data$segments$y, na.rm = TRUE)

cluster_rectangles <- tibble::tibble(
  cluster = integer(),
  x0 = numeric(),
  x1 = numeric(),
  y0 = numeric(),
  y1 = numeric(),
  color = character()
)

for (cl in 1:k) {
  xs_cl <- leaf_x[which(label_clusters == cl)]
  if (length(xs_cl) > 0) {
    x0 <- min(xs_cl) - pad
    x1 <- max(xs_cl) + pad
    cluster_rectangles <- cluster_rectangles %>%
      add_row(
        cluster = cl,
        x0 = x0,
        x1 = x1,
        y0 = 0,
        y1 = max_y * 0.92,
        color = cluster_colors[as.character(cl)]
      )
  }
}

tree_color <- "#00e5ff"
seg_df <- dend_data$segments
seg_df$seg_col <- tree_color

dend_interactive <- plot_ly()

dend_interactive <- dend_interactive %>%
  add_segments(
    data = seg_df,
    x = ~x, xend = ~xend,
    y = ~y, yend = ~yend,
    line = list(color = tree_color, width = 2),
    hoverinfo = "none",
    showlegend = FALSE
  )

labels_df <- dend_data$labels %>%
  mutate(cluster = label_clusters,
         color = cluster_colors[as.character(cluster)])

dend_interactive <- dend_interactive %>%
  add_markers(
    data = labels_df,
    x = ~x, y = ~y,
    text = ~paste0(
      "<b style='color:#00e5ff; font-size:13px;'>", label, "</b><br>",
      "<span style='color:#a259ff; font-size:12px;'><b>Cluster:</b> ", cluster, "</span>"
    ),
    hoverinfo = "text",
    marker = list(size = 9, line = list(width = 1.5, color = "#ffffff")),
    color = ~I(color),
    showlegend = FALSE,
    hovertemplate = "%{text}<extra></extra>"
  )

shapes_list <- lapply(seq_len(nrow(cluster_rectangles)), function(i) {
  list(
    type = "rect",
    x0 = cluster_rectangles$x0[i],
    x1 = cluster_rectangles$x1[i],
    y0 = cluster_rectangles$y0[i],
    y1 = cluster_rectangles$y1[i],
    fillcolor = cluster_rectangles$color[i],
    line = list(color = cluster_rectangles$color[i], width = 2),
    opacity = 0.15,
    layer = "below"
  )
})

linea_corte <- list(
  type = "line",
  x0 = min(dend_data$segments$x, na.rm = TRUE),
  x1 = max(dend_data$segments$x, na.rm = TRUE),
  y0 = 15,
  y1 = 15,
  line = list(color = "#ff1744", width = 2.5, dash = "solid"),
  layer = "above"
)

shapes_list <- append(shapes_list, list(linea_corte))

dend_interactive <- dend_interactive %>%
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:18px;'>Figura 16: Dendrograma Jer√°rquico - Clusterizaci√≥n Ward</b><br>
              <span style='color:#8b92a0; font-size:12px;'>Distancia Euclidiana | M√©todo de Ward | k = 3 clusters √≥ptimos</span>",
      x = 0.5,
      xanchor = "center",
      y = 0.98
    ),
    shapes = shapes_list,
    xaxis = list(
      title = "",
      showticklabels = FALSE,
      zeroline = FALSE,
      showgrid = FALSE,
      color = "#8b92a0"
    ),
    yaxis = list(
      title = "<b style='font-size:13px; color:#e0e6ed;'>Distancia Euclidiana</b>",
      zeroline = FALSE,
      showgrid = TRUE,
      gridcolor = "#12161f",
      gridwidth = 0.5,
      tickfont = list(color = "#8b92a0", size = 11),
      titlefont = list(color = "#e0e6ed", size = 12)
    ),
    plot_bgcolor = "#000000",
    paper_bgcolor = "#0a0e1a",
    font = list(family = "Arial, sans-serif", color = "#e0e6ed", size = 11),
    hovermode = "closest",
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 12)
    ),
    margin = list(l = 80, r = 50, t = 120, b = 80)
  ) %>%
  config(
    displayModeBar = TRUE,
    scrollZoom = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "dendrograma_clustering",
      width = 1200,
      height = 900
    )
  )

dend_interactive
```

El m√©todo del codo examina c√≥mo disminuye WCSS (suma de cuadrados dentro de clusters) conforme aumenta el n√∫mero de clusters desde $k=2$ hasta $k=10$ Inicialmente, incrementar $k$ reduce WCSS r√°pidamente porque se reduce heterogeneidad interna; sin embargo, a partir de cierto $k$ (el "codo"), la reducci√≥n adicional se vuelve marginal, sugiriendo que clusters posteriores no capturan estructura genuina sino que simplemente subdividen artificialmente. T√≠picamente, el codo se identifica en $k=3$ a $k=4$ para an√°lisis de desarrollo internacional.

```{r metodo-codo-cyber, message=FALSE, warning=FALSE,fig.height=7.5, fig.width=12, out.width="100%"}
wss <- function(k) {
  kmeans(coordenadas_pca, k, nstart = 25)$tot.withinss
}

k.values <- 1:10
wss_values <- map_dbl(k.values, wss)

elbow_data <- data.frame(
  k = k.values,
  wss = wss_values
)

elbow_plot <- ggplot(elbow_data, aes(x = k, y = wss)) +
  geom_line(size = 1.3, color = "#00e5ff") +
  geom_point(size = 4, color = "#00e5ff", alpha = 0.85) +
  geom_vline(xintercept = 3, linetype = "dashed", color = "#ff1744", size = 1.2) +
  labs(
    title = "",
    subtitle = "",
    x = "N√∫mero de Clusters (k)",
    y = "Suma de Cuadrados Within-Cluster (WCSS)"
  ) +
  scale_x_continuous(breaks = 1:10) +
  theme_minimal(base_size = 12) +
  theme(
    plot.background = element_rect(fill = "#000000", color = NA),
    panel.background = element_rect(fill = "#0a0e1a", color = NA),
    panel.grid.major = element_line(color = "#12161f", size = 0.4),
    panel.grid.minor = element_line(color = "#12161f", size = 0.2),
    
    axis.title = element_text(
      face = "bold",
      color = "#e0e6ed",
      size = 13
    ),
    axis.text = element_text(
      color = "#8b92a0",
      size = 11
    ),
    axis.line = element_line(
      color = "#00e5ff",
      size = 0.6
    ),
    
    plot.title = element_text(
      face = "bold",
      size = 16,
      hjust = 0.5,
      color = "#00e5ff"
    ),
    plot.subtitle = element_text(
      size = 12,
      hjust = 0.5,
      color = "#8b92a0"
    ),
    
    panel.border = element_rect(
      color = "#00e5ff",
      fill = NA,
      size = 0.8
    ),
    
    plot.margin = margin(20, 20, 20, 20)
  )

elbow_plot_interactive <- ggplotly(
  elbow_plot,
  tooltip = c("x", "y")
) %>%
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:18px;'>Figura 17: M√©todo del Codo</b><br>
              <span style='color:#8b92a0; font-size:12px;'>Determinaci√≥n del n√∫mero √≥ptimo de clusters | WCSS por k</span>",
      x = 0.5,
      xanchor = "center",
      y = 0.98
    ),
    
    xaxis = list(
      title = "<b style='color:#e0e6ed; font-size:13px;'>N√∫mero de Clusters (k)</b>",
      gridcolor = "#12161f",
      gridwidth = 0.5,
      showgrid = TRUE,
      zeroline = FALSE,
      tickfont = list(color = "#8b92a0", size = 11),
      titlefont = list(color = "#e0e6ed", size = 12),
      linecolor = "#00e5ff",
      linewidth = 1
    ),
    
    yaxis = list(
      title = "<b style='color:#e0e6ed; font-size:13px;'>Suma de Cuadrados Within-Cluster (WCSS)</b>",
      gridcolor = "#12161f",
      gridwidth = 0.5,
      showgrid = TRUE,
      zeroline = FALSE,
      tickfont = list(color = "#8b92a0", size = 11),
      titlefont = list(color = "#e0e6ed", size = 12),
      linecolor = "#00e5ff",
      linewidth = 1
    ),
    
    plot_bgcolor = "#000000",
    paper_bgcolor = "#0a0e1a",
    
    annotations = list(
      list(
        x = 3,
        y = max(wss_values) * 0.85,
        text = "<b style='color:#ff1744; font-size:12px;'>‚ö† Codo √ìptimo</b><br>
               <span style='color:#00e676; font-size:11px;'>k = 3 clusters</span>",
        showarrow = TRUE,
        arrowhead = 4,
        arrowsize = 1.5,
        arrowcolor = "#ff1744",
        arrowwidth = 2.5,
        ax = -50,
        ay = -60,
        bgcolor = "rgba(10, 14, 26, 0.9)",
        bordercolor = "#ff1744",
        borderwidth = 1.5,
        borderpad = 8,
        font = list(size = 11)
      )
    ),
    
    hovermode = "closest",
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(
        color = "#e0e6ed",
        size = 12,
        family = "Arial"
      ),
      align = "left"
    ),
    
    margin = list(l = 100, r = 50, b = 100, t = 160),
    
    font = list(
      family = "Arial, sans-serif",
      color = "#e0e6ed",
      size = 12
    )
  ) %>%
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "metodo_codo_clustering",
      width = 1400,
      height = 800
    )
  )

elbow_plot_interactive
```

La coherencia interpretativa valida que los clusters identificados tienen significado econ√≥mico y social claro. En este an√°lisis, se seleccion√≥ $k=3$ clusters porque esta segmentaci√≥n produce tres grupos conceptualmente diferenciados.

### Caracterizaci√≥n de los clusters

La segmentaci√≥n produjo una distribuci√≥n desigual de pa√≠ses entre clusters. El Cluster 1 agrupa 84 pa√≠ses (61.8% del total), el Cluster 2 agrupa 32 pa√≠ses (23.5%), y el Cluster 3 agrupa 20 pa√≠ses (14.7%). Esta distribuci√≥n refuerza la interpretaci√≥n de que existe un peque√±o grupo de pa√≠ses ultra-desarrollados (Cluster 1), un grupo intermedio significativo de emergentes (Cluster 2), y un grupo minoritario pero vulnerable de pa√≠ses en rezago extremo (Cluster 3). La concentraci√≥n de 61.8% en Cluster 1 sugiere que la mayor√≠a de pa√≠ses han logrado alg√∫n nivel de desarrollo b√°sico, mientras que la minor√≠a de 14.7% en Cluster 3 representa casos de vulnerabilidad persistente y multidimensional.

```{r tabla-distribucion-clusters-cyber}
distribucion_clusters <- table(clusters) %>%
  as.data.frame() %>%
  rename(Cluster = clusters, Frecuencia = Freq) %>%
  mutate(Porcentaje = round(Frecuencia/sum(Frecuencia)*100, 2))

tabla_distribucion <- distribucion_clusters %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 15**"),
    subtitle = "Distribuci√≥n de Pa√≠ses por Cluster"
  ) %>%
  cols_label(
    Cluster = md("**Cluster**"),
    Frecuencia = md("**N¬∞ Pa√≠ses**"),
    Porcentaje = md("**Porcentaje (%)**")
  ) %>%
  fmt_number(
    columns = Porcentaje,
    decimals = 1,
    pattern = "{x}%"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium", color = "#000000"),
      cell_fill(color = "#00e5ff")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "#00e5ff",
      weight = px(2)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "#00e5ff",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Cluster, Frecuencia))
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#0a0e1a"),
      cell_text(color = "#e0e6ed")
    ),
    locations = cells_body()
  ) %>%
  tab_style(
    style = cell_text(weight = "bold", color = "#00e5ff"),
    locations = cells_body(columns = Cluster)
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff", size = "large")
    ),
    locations = cells_title(groups = "title")
  ) %>%
  tab_style(
    style = list(
      cell_text(color = "#e0e6ed", size = "medium")
    ),
    locations = cells_title(groups = "subtitle")
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "solid",
    column_labels.border.top.color = "#00e5ff",
    column_labels.border.top.width = px(3),
    column_labels.border.bottom.style = "solid",
    column_labels.border.bottom.width = px(3),
    column_labels.border.bottom.color = "#00e5ff",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    table_body.hlines.style = "solid",
    table_body.hlines.color = "#00e5ff",
    table_body.hlines.width = px(1),
    table.background.color = "#0a0e1a",
    data_row.padding = px(10),
    heading.title.font.size = 18,
    heading.subtitle.font.size = 14,
    heading.padding = px(12),
    heading.border.bottom.style = "solid",
    heading.border.bottom.width = px(2),
    heading.border.bottom.color = "#00e5ff"
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboraci√≥n propia basada en agrupamiento Ward")
  )

tabla_distribucion
```

```{r tabla-estadisticas-descriptivas-cyber}
nombres_variables <- c(
  "PIB_per" = "PIB per c√°pita (US$)",
  "Poblacion" = "Poblaci√≥n total",
  "Esperanza.vida" = "Esperanza de vida (a√±os)",
  "Acceso.electricidad" = "Acceso electricidad (%)",
  "Area.boscosa" = "√Årea boscosa (%)",
  "Suscripciones.movil" = "Suscripciones m√≥viles",
  "Crecimiento.PIB" = "Crecimiento PIB (%)",
  "Mortalidad.infantil" = "Mortalidad infantil",
  "Inversion.extranjera" = "Inversi√≥n extranjera (%)",
  "Gasto.salud" = "Gasto en salud (%)",
  "Uso.internet" = "Uso de internet (%)",
  "Importaciones" = "Importaciones (%)",
  "Exportaciones" = "Exportaciones (%)",
  "Tierra.cultivable" = "Tierra cultivable (%)",
  "Crecimiento.poblacion" = "Crecimiento poblaci√≥n (%)",
  "Industria" = "Industria (%)",
  "Remesas" = "Remesas (%)"
)

estadisticas_clusters <- NuevaBase %>%
  group_by(Cluster) %>%
  summarise(across(
    where(is.numeric),
    list(
      Media = ~round(mean(., na.rm = TRUE), 2),
      Mediana = ~round(median(., na.rm = TRUE), 2),
      DE = ~round(sd(., na.rm = TRUE), 2),
      Min = ~round(min(., na.rm = TRUE), 2),
      Max = ~round(max(., na.rm = TRUE), 2)
    )
  )) %>%
  pivot_longer(
    cols = -Cluster,
    names_to = "Variable_Estadistica",
    values_to = "Valor"
  ) %>%
  separate(Variable_Estadistica, into = c("Variable", "Estadistica"), sep = "_") %>%
  pivot_wider(
    names_from = Estadistica,
    values_from = Valor
  )

tabla_estadisticas <- estadisticas_clusters %>%
  mutate(
    Variable_Descriptiva = nombres_variables[Variable],
    Cluster = paste("Cluster", Cluster)
  ) %>%
  select(Cluster, Variable_Descriptiva, Media, Mediana, DE, Min, Max) %>%
  arrange(Cluster, Variable_Descriptiva) %>%
  gt(groupname_col = "Cluster") %>%
  tab_header(
    title = md("**Tabla 16**"),
    subtitle = "Estad√≠sticas Descriptivas por Cluster | Medias, desviaciones est√°ndar y rangos"
  ) %>%
  cols_label(
    Variable_Descriptiva = md("**Variable**"),
    Media = md("**Media**"),
    Mediana = md("**Mediana**"),
    DE = md("**D.E.**"),
    Min = md("**M√≠n**"),
    Max = md("**M√°x**")
  ) %>%
  cols_align(
    align = "center",
    columns = c(Media, Mediana, DE, Min, Max)
  ) %>%
  cols_align(
    align = "left",
    columns = Variable_Descriptiva
  ) %>%
  fmt_number(
    columns = c(Media, Mediana, DE, Min, Max),
    decimals = 2
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium", color = "#000000"),
      cell_fill(color = "#00e5ff")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "#00e5ff",
      weight = px(2)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "#00e5ff",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Variable_Descriptiva, Media, Mediana, DE, Min))
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#0a0e1a"),
      cell_text(color = "#e0e6ed")
    ),
    locations = cells_body()
  ) %>%
  tab_style(
    style = cell_text(weight = "bold", color = "#00e5ff"),
    locations = cells_body(columns = Variable_Descriptiva)
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#ffffff"),
      cell_text(color = "#ffffff", weight = "bold", size = "large") 
    ),
    locations = cells_row_groups()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff", size = "large")
    ),
    locations = cells_title(groups = "title")
  ) %>%
  tab_style(
    style = list(
      cell_text(color = "#e0e6ed", size = "medium")
    ),
    locations = cells_title(groups = "subtitle")
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "solid",
    column_labels.border.top.color = "#00e5ff",
    column_labels.border.top.width = px(3),
    column_labels.border.bottom.style = "solid",
    column_labels.border.bottom.width = px(3),
    column_labels.border.bottom.color = "#00e5ff",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    table_body.hlines.style = "solid",
    table_body.hlines.color = "#00e5ff",
    table_body.hlines.width = px(1),
    table.background.color = "#0a0e1a",
    data_row.padding = px(8),
    row_group.background.color = "#0a0e1a",
    row_group.padding = px(12),
    row_group.font.weight = "bold",
    row_group.font.size = "large",
    heading.title.font.size = 18,
    heading.subtitle.font.size = 14,
    heading.padding = px(12),
    heading.border.bottom.style = "solid",
    heading.border.bottom.width = px(2),
    heading.border.bottom.color = "#00e5ff"
  ) %>%
  tab_source_note(
    source_note = md("**Fuente:** Elaboraci√≥n propia con base en World Bank (2023)")
  )

tabla_estadisticas

```

```{r tabla-comparacion-medias-cyber}
estadisticas_por_cluster <- NuevaBase %>%
  group_by(Cluster) %>%
  summarise(across(
    where(is.numeric),
    list(
      Media = ~mean(., na.rm = TRUE)
    ),
    .names = "{.col}_{.fn}"
  ))

estadisticas_largas <- estadisticas_por_cluster %>%
  pivot_longer(
    cols = -Cluster,
    names_to = "Variable_Estadistica",
    values_to = "Valor"
  ) %>%
  mutate(
    Estadistica = str_extract(Variable_Estadistica, "[^_]+$"),
    Variable = str_remove(Variable_Estadistica, "_[^_]+$"),
    Valor = as.numeric(Valor)
  ) %>%
  select(-Variable_Estadistica)

tabla_estadisticas_mejorada <- estadisticas_largas %>%
  filter(Estadistica == "Media") %>%
  mutate(
    Variable_Descriptiva = nombres_variables[Variable],
    Cluster = paste("Cluster", Cluster),
    Valor = round(Valor, 2)
  ) %>%
  select(Cluster, Variable_Descriptiva, Valor) %>%
  pivot_wider(
    names_from = Cluster,
    values_from = Valor
  ) %>%
  arrange(Variable_Descriptiva) %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 17**"),
    subtitle = "Comparaci√≥n de Clusters - Medias por Variable | An√°lisis comparativo de indicadores"
  ) %>%
  cols_label(
    Variable_Descriptiva = md("**Variable**")
  ) %>%
  cols_align(
    align = "center",
    columns = -Variable_Descriptiva
  ) %>%
  cols_align(
    align = "left",
    columns = Variable_Descriptiva
  ) %>%
  fmt_number(
    columns = -Variable_Descriptiva,
    decimals = 2
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium", color = "#000000"),
      cell_fill(color = "#00e5ff")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "#00e5ff",
      weight = px(2)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "#00e5ff",
      weight = px(1)
    ),
    locations = cells_body(columns = Variable_Descriptiva)
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#0a0e1a"),
      cell_text(color = "#e0e6ed")
    ),
    locations = cells_body()
  ) %>%
  tab_style(
    style = cell_text(weight = "bold", color = "#00e5ff"),
    locations = cells_body(columns = Variable_Descriptiva)
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff", size = "large")
    ),
    locations = cells_title(groups = "title")
  ) %>%
  tab_style(
    style = list(
      cell_text(color = "#e0e6ed", size = "medium")
    ),
    locations = cells_title(groups = "subtitle")
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "solid",
    column_labels.border.top.color = "#00e5ff",
    column_labels.border.top.width = px(3),
    column_labels.border.bottom.style = "solid",
    column_labels.border.bottom.width = px(3),
    column_labels.border.bottom.color = "#00e5ff",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    table_body.hlines.style = "solid",
    table_body.hlines.color = "#00e5ff",
    table_body.hlines.width = px(1),
    table.background.color = "#0a0e1a",
    data_row.padding = px(10),
    heading.title.font.size = 18,
    heading.subtitle.font.size = 14,
    heading.padding = px(12),
    heading.border.bottom.style = "solid",
    heading.border.bottom.width = px(2),
    heading.border.bottom.color = "#00e5ff"
  ) %>%
  tab_source_note(
    source_note = md("**Nota:** Elaboraci√≥n propia. Los valores est√°n redondeados a 2 decimales")
  )

tabla_estadisticas_mejorada
```

#### Cluster 1: Desarrollo Humano Avanzado y Conectividad Digital Consolidada

Perfil de variables: Cluster 1 se caracteriza por valores extremadamente altos en indicadores de desarrollo humano e infraestructura. Acceso a electricidad alcanza 99.16%, reflejando electrificaci√≥n universal que define econom√≠as desarrolladas. Esperanza de vida promedio es 77.44 a√±os, el nivel m√°s alto entre los tres clusters, indicando sistemas sanitarios consolidados, nutrici√≥n adecuada, y estabilidad sociopol√≠tica. Uso de internet es 86.05%, el m√°s elevado, confirmando que la conectividad digital es caracter√≠stica definitoria de este grupo. Mortalidad infantil es apenas 7.85 por 1,000 nacidos vivos, la m√°s baja, reflejando que sistemas de salud materno-infantil funcionan eficientemente. PIB per c√°pita promedio es \$26,489.97 USD, demostrando riqueza econ√≥mica consolidada.

Simult√°neamente, Cluster 1 muestra caracter√≠sticas econ√≥micas de econom√≠as maduras y globalizadas: exportaciones representan 55.30% del PIB (comercio orientado externamente), importaciones 54.55%, indicando que estos pa√≠ses son hubs comerciales internacionales. Crecimiento del PIB es 5.12% (moderado pero positivo), sugiriendo expansi√≥n econ√≥mica sostenida. Industria representa 28.53% del PIB, confirmando que aunque estas econom√≠as son postindustriales (basadas en servicios), mantienen capacidad manufacturera significativa. Inversi√≥n extranjera directa es 5.08% del PIB, indicando que son destinos atractivos para capitales internacionales. Gasto en salud es 7.62% del PIB, el m√°s alto, validando inversi√≥n sustancial en sistemas de salud universales. Crecimiento poblacional es apenas 0.73% anual, reflejando que han completado transiciones demogr√°ficas con poblaciones envejecidas.

Composici√≥n de pa√≠ses: Incluye principalmente naciones europeas desarrolladas (Alemania, Francia, Italia, Espa√±a, Reino Unido, Suecia, Dinamarca, Finlandia, Noruega, Pa√≠ses Bajos), naciones norteamericanas (Estados Unidos, Canad√°), econom√≠as asi√°ticas avanzadas (Jap√≥n, Corea del Sur, Singapur, Hong Kong), y destinos de desarrollo consolidado (Australia, Nueva Zelanda, Israel). La predominancia de econom√≠as OCDE valida que Cluster 1 captura efectivamente el grupo de desarrollo ultra-avanzado global (Banco Mundial, 2023).

#### Cluster 2: Desarrollo Intermedio Heterog√©neo con Vulnerabilidades Persistentes

Perfil de variables: Cluster 2 representa el grupo de pa√≠ses con desarrollo humano intermedio pero altamente heterog√©neo internamente. Esperanza de vida promedio es 64.29 a√±os, sustancialmente menor que Cluster 1 (13 a√±os de diferencia), pero superior a Cluster 3, indicando que estos pa√≠ses han logrado avances en salud b√°sica pero enfrentan desaf√≠os significativos. Acceso a electricidad es 54.59%, apenas por encima de la mitad, reflejando que la electrificaci√≥n es incompleta especialmente en zonas rurales. Uso de internet es 35.04%, menos de la mitad de Cluster 1, confirmando que brecha digital es significativa. Mortalidad infantil es 40.97 por 1,000, aproximadamente 5 veces mayor que Cluster 1, indicando que sistemas de salud materno-infantil enfrentan capacidades limitadas.

PIB per c√°pita promedio es \$1,578.46 USD, dram√°ticamente menor que Cluster 1 (95% de diferencia), confirmando que estos son pa√≠ses de ingresos medios bajos a medios. Crecimiento poblacional es 2.31% anual, significativamente m√°s alto que Cluster 1, reflejando que est√°n en transiciones demogr√°ficas incompletas donde natalidad sigue siendo elevada. Remesas recibidas representan 4.94% del PIB, indicando dependencia moderada de transferencias de migrantes. Inversi√≥n extranjera es 3.65% del PIB (inferior a Cluster 1), sugiriendo que son menos atractivos para capitales internacionales. Gasto en salud es 5.10% del PIB (menor que Cluster 1), limitando recursos disponibles para sistemas de salud.

Heterogeneidad interna: Este cluster contiene gran variaci√≥n: desde pa√≠ses con desarrollo relativamente avanzado (M√©xico \~\$9,500 PIB per c√°pita, esperanza de vida \~75 a√±os) hasta pa√≠ses con rezago moderado (Kenia, Ghana, Nigeria con esperanza de vida \~65 a√±os). Tierra cultivable es 20.60%, la m√°s alta entre clusters, reflejando que muchos son econom√≠as donde agricultura sigue siendo importante. Suscripciones m√≥viles son 91.59 por cada 100 habitantes, indicando penetraci√≥n de tecnolog√≠a m√≥vil como vector de inclusi√≥n financiera y digital.

Composici√≥n de pa√≠ses: Incluye principalmente econom√≠as latinoamericanas emergentes (Brasil, M√©xico, Colombia, Argentina, Chile, Uruguay, Per√∫), econom√≠as asi√°ticas en transici√≥n (Vietnam, Tailandia, Indonesia, Filipinas, India en su mayor√≠a), econom√≠as africanas moderadamente desarrolladas (Botswana, Mauricio, Sud√°frica), y pa√≠ses del Oriente Medio con ingresos medios (Turqu√≠a, Jordania, L√≠bano). La diversidad geogr√°fica y econ√≥mica confirma que Cluster 2 captura un espectro amplio de naciones en estado intermedio de desarrollo (Banco Mundial, 2023; PNUD, 2023).

#### Cluster 3: Rezago Extremo y Vulnerabilidad Multidimensional

Perfil de variables: Cluster 3 representa el grupo de rezago humano y econ√≥mico extremo. Esperanza de vida promedio es apenas 71.59 a√±os, superior a Cluster 2 en cifra pero esta cifra es enga√±osa porque oculta volatilidad extrema: mientras algunos pa√≠ses tienen \~75 a√±os, otros tienen \~55-58 a√±os, y mortalidad adulta es severamente elevada por VIH, conflictos armados, y enfermedades tropicales. Acceso a electricidad es 96.42%, aparentemente alto, pero esta cifra promedio se distorsiona por algunos pa√≠ses con cobertura urbana buena; zonas rurales en muchos pa√≠ses est√°n completamente sin electricidad.

Mortalidad infantil es 18.11 por 1,000, intermedia entre Cluster 1 (7.85) y Cluster 2 (40.97), sugiriendo que este cluster, aunque llamado "rezago", contiene algunos pa√≠ses que han logrado mejoras en salud infantil. Uso de internet es 61.08%, sorprendentemente alto comparado con Cluster 2 (35.04%), pero se explica porque algunos pa√≠ses han adoptado tecnolog√≠a m√≥vil massivamente sin infraestructura de electricidad o salud consolidada. PIB per c√°pita es \$3,776.68 USD, intermedio entre Cluster 2 (\$1,578) y Cluster 1 (\$26,489), contradictorio con la caracterizaci√≥n de "rezago extremo", pero refleja que algunos pa√≠ses tienen petr√≥leo (Angola) o recursos (Zambia) que generan ingresos nominales sin beneficios distributivos amplios.

Crecimiento poblacional es 0.79% anual, el m√°s bajo entre clusters, indicando que est√°n completando transiciones demogr√°ficas pero desde bases de desarrollo muy rezagadas. Remesas recibidas son 22.09% del PIB, el porcentaje m√°s alto, reflejando que econom√≠as est√°n severamente dependientes de transferencias de di√°sporas en exterior. Gasto en salud es 7.44% del PIB (similar a Cluster 1), pero esta cifra es enga√±osa porque presupuestos limitados resultan en servicios muy deficientes. Tierra cultivable es 15.21%, indicando que agricultura es importante pero infraestructura agr√≠cola y productividad est√°n severamente limitadas.

La paradoja de Cluster 3: A primera vista, algunas m√©tricas (esperanza de vida 71.59, acceso electricidad 96.42, gasto salud 7.44%) parecen intermedias, no rezagadas. Esto refleja que el cluster contiene mezcla heterog√©nea: pa√≠ses como Angola (productor petrolero con ingresos altos nominales pero servicios colapsados) coexisten con pa√≠ses como Etiop√≠a o Uganda. La vulnerabilidad real radica en fragilidad institucional, volatilidad, dependencia de remesas (22.09% vs. 2.47% en Cluster 1), y que indicadores altos coexisten con servicios p√∫blicos disfuncionales (Banco Mundial, 2023).

### Segmentacion de paises

Plano PC1-PC2 (Desarrollo Humano vs. Modelo Econ√≥mico-Institucional): El gr√°fico PC1-PC2 muestra la distribuci√≥n de clusters en el plano que explica la mayor proporci√≥n de varianza (37.8% combinada). El Cluster 1 (puntos rojos) se concentra predominantemente en el cuadrante central-derecho y ligeramente disperso verticalmente, reflejando que estos pa√≠ses comparten desarrollo humano avanzado (PC1 positivo moderado a alto) pero var√≠an en estructura econ√≥mica institucional (PC2 desde -4 hasta +4). Pa√≠ses con PC2 extremadamente negativo (como Qatar, Kuwait) representan econom√≠as petroleras industrializadas; pa√≠ses con PC2 cercano a cero representan econom√≠as postindustriales diversificadas europeas; pa√≠ses con PC2 ligeramente positivo representan econom√≠as con gasto social elevado.

```{r clusters-tabla-cyber}
coordenadas_pca <- as.data.frame(resultado_ACP$dudi$li[, 1:4])
distancias <- dist(coordenadas_pca)
hc <- hclust(distancias, method = "ward.D2")
clusters <- cutree(hc, k = 3)

cluster_df <- data.frame(
  Pais = rownames(coordenadas_pca),
  Dim1 = coordenadas_pca$Axis1,
  Dim2 = coordenadas_pca$Axis2,
  Dim3 = coordenadas_pca$Axis3,
  Dim4 = coordenadas_pca$Axis4,
  Cluster = as.factor(clusters)
)

resumen_clusters <- cluster_df %>%
  group_by(Cluster) %>%
  summarise(
    Cantidad_Paises = n(),
    Porcentaje = round(n() / nrow(cluster_df) * 100, 1),
    Paises_Ejemplo = paste(head(Pais, 5), collapse = ", "),
    .groups = 'drop'
  ) %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 18**"),
    subtitle = "Resumen de Clusters Identificados | Agrupamiento jer√°rquico con m√©todo Ward"
  ) %>%
  cols_label(
    Cluster = md("**Cluster**"),
    Cantidad_Paises = md("**N¬∞ Pa√≠ses**"),
    Porcentaje = md("**%**"),
    Paises_Ejemplo = md("**Pa√≠ses Representativos**")
  ) %>%
  fmt_number(
    columns = Porcentaje,
    decimals = 1,
    pattern = "{x}%"
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium", color = "#000000"),
      cell_fill(color = "#00e5ff")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "#00e5ff",
      weight = px(2)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "#00e5ff",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Cluster, Cantidad_Paises))
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#0a0e1a"),
      cell_text(color = "#e0e6ed")
    ),
    locations = cells_body()
  ) %>%
  tab_style(
    style = cell_text(weight = "bold", color = "#00e5ff"),
    locations = cells_body(columns = Cluster)
  ) %>%
  tab_style(
    style = cell_text(size = "small", color = "#e0e6ed"),
    locations = cells_body(columns = c(Cantidad_Paises, Porcentaje, Paises_Ejemplo))
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff", size = "large")
    ),
    locations = cells_title(groups = "title")
  ) %>%
  tab_style(
    style = list(
      cell_text(color = "#e0e6ed", size = "medium")
    ),
    locations = cells_title(groups = "subtitle")
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "solid",
    column_labels.border.top.color = "#00e5ff",
    column_labels.border.top.width = px(3),
    column_labels.border.bottom.style = "solid",
    column_labels.border.bottom.width = px(3),
    column_labels.border.bottom.color = "#00e5ff",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    table_body.hlines.style = "solid",
    table_body.hlines.color = "#00e5ff",
    table_body.hlines.width = px(1),
    table.background.color = "#0a0e1a",
    data_row.padding = px(10),
    heading.title.font.size = 18,
    heading.subtitle.font.size = 14,
    heading.padding = px(12),
    heading.border.bottom.style = "solid",
    heading.border.bottom.width = px(2),
    heading.border.bottom.color = "#00e5ff",
    footnotes.padding = px(10),
    footnotes.font.size = 13,
    source_notes.font.size = 13,
    source_notes.padding = px(10)
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboraci√≥n propia basada en agrupamiento Ward de componentes principales")
  )

resumen_clusters
```

```{r clusters-scatter-cyber, fig.width=12, fig.height=8.2, out.width="100%"}
cluster_plot <- plot_ly(
  cluster_df,
  x = ~Dim1,
  y = ~Dim2,
  color = ~Cluster,
  colors = c("1" = "#00e676", "2" = "#0084ff", "3" = "#ffd600"),
  text = ~paste0(
    "<b style='color:#00e5ff; font-size:13px;'>", Pais, "</b><br>",
    "<span style='color:#a259ff; font-size:12px;'><b>Cluster:</b> ", Cluster, "</span><br>",
    "<span style='color:#8b92a0; font-size:11px;'>Dim1: ", round(Dim1, 3), "</span><br>",
    "<span style='color:#8b92a0; font-size:11px;'>Dim2: ", round(Dim2, 3), "</span>"
  ),
  type = "scatter",
  mode = "markers",
  marker = list(
    size = 10,
    opacity = 0.8,
    line = list(width = 1.5, color = "#ffffff")
  ),
  hovertemplate = "%{text}<extra></extra>"
) %>%
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:18px;'>Figura 18: Clusters en el Espacio de Componentes Principales</b><br>
              <span style='color:#8b92a0; font-size:12px;'>Proyecci√≥n Dim1 vs Dim2 | Agrupamiento Ward (k=3)</span>",
      x = 0.5,
      xanchor = "center",
      y = 0.98
    ),
    xaxis = list(
      title = "<b style='color:#e0e6ed; font-size:13px;'>Dimensi√≥n 1</b>",
      gridcolor = "#12161f",
      gridwidth = 0.5,
      showgrid = TRUE,
      zeroline = TRUE,
      zerolinecolor = "rgba(0, 229, 255, 0.3)",
      zerolinewidth = 1,
      tickfont = list(color = "#8b92a0", size = 11),
      titlefont = list(color = "#e0e6ed", size = 12),
      linecolor = "#00e5ff",
      linewidth = 1
    ),
    yaxis = list(
      title = "<b style='color:#e0e6ed; font-size:13px;'>Dimensi√≥n 2</b>",
      gridcolor = "#12161f",
      gridwidth = 0.5,
      showgrid = TRUE,
      zeroline = TRUE,
      zerolinecolor = "rgba(0, 229, 255, 0.3)",
      zerolinewidth = 1,
      tickfont = list(color = "#8b92a0", size = 11),
      titlefont = list(color = "#e0e6ed", size = 12),
      linecolor = "#00e5ff",
      linewidth = 1
    ),
    plot_bgcolor = "#000000",
    paper_bgcolor = "#0a0e1a",
    font = list(
      family = "Arial, sans-serif",
      color = "#e0e6ed",
      size = 12
    ),
    hovermode = "closest",
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 12, family = "Arial")
    ),
    margin = list(l = 100, r = 50, b = 100, t = 140),
    legend = list(
      title = list(text = "<b style='color:#00e5ff; font-size:12px;'>Cluster</b>"),
      bgcolor = "rgba(10, 14, 26, 0.9)",
      bordercolor = "#00e5ff",
      borderwidth = 1.5,
      font = list(color = "#e0e6ed", size = 11),
      x = 0.98,
      y = 0.98,
      xanchor = "right",
      yanchor = "top"
    )
  ) %>%
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "clusters_pca",
      width = 1400,
      height = 900
    )
  )

cluster_plot
```

El Cluster 2 (puntos azul) se distribuye ampliamente en la regi√≥n central-derecha del plano, con mayor concentraci√≥n en PC1 entre +1 y +3 (desarrollo intermedio) y PC2 entre -2 y +2 (diversidad de modelos econ√≥micos). Esta dispersi√≥n amplia confirma la heterogeneidad interna del Cluster 2: incluye desde pa√≠ses latinoamericanos con desarrollo intermedio hasta econom√≠as asi√°ticas emergentes con distintas trayectorias de industrializaci√≥n. Algunos pa√≠ses del Cluster 2 con PC1 \>3 se posicionan muy cerca de frontera con Cluster 1, sugiriendo que est√°n en transici√≥n hacia desarrollo consolidado.

El Cluster 3 (puntos amarillos) se concentra en la regi√≥n izquierda del plano (PC1 negativo desde -2 hasta -6), confirmando su posicionamiento en el polo de menor desarrollo humano. Verticalmente, el Cluster 3 muestra dispersi√≥n amplia en PC2 (desde -2 hasta +2), reflejando que pa√≠ses en rezago tienen modelos econ√≥micos diversos: algunos dependen de remesas (PC2 positivo), otros tienen industria extractiva limitada (PC2 negativo moderado). La separaci√≥n visual entre Cluster 3 y Clusters 1-2 es clara, con solapamiento m√≠nimo, validando que la segmentaci√≥n captura diferencias estructurales genuinas.

```{r clusters-dim3-dim4-cyber, fig.width=12, fig.height=8.2, out.width="100%"}
cluster_plot1 <- plot_ly(
  cluster_df,
  x = ~Dim3,
  y = ~Dim4,
  color = ~Cluster,
  colors = c("1" = "#00e676", "2" = "#0084ff", "3" = "#ffd600"),
  text = ~paste0(
    "<b style='color:#00e5ff; font-size:13px;'>", Pais, "</b><br>",
    "<span style='color:#a259ff; font-size:12px;'><b>Cluster:</b> ", Cluster, "</span><br>",
    "<span style='color:#8b92a0; font-size:11px;'>Dim3: ", round(Dim3, 3), "</span><br>",
    "<span style='color:#8b92a0; font-size:11px;'>Dim4: ", round(Dim4, 3), "</span>"
  ),
  type = "scatter",
  mode = "markers",
  marker = list(
    size = 10,
    opacity = 0.8,
    line = list(width = 1.5, color = "#ffffff")
  ),
  hovertemplate = "%{text}<extra></extra>"
) %>%
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:18px;'>Figura 19: Clusters en el Espacio de Componentes Principales</b><br>
              <span style='color:#8b92a0; font-size:12px;'>Proyecci√≥n Dim3 vs Dim4 | Agrupamiento Ward (k=3)</span>",
      x = 0.5,
      xanchor = "center",
      y = 0.98
    ),
    xaxis = list(
      title = "<b style='color:#e0e6ed; font-size:13px;'>Dimensi√≥n 3</b>",
      gridcolor = "#12161f",
      gridwidth = 0.5,
      showgrid = TRUE,
      zeroline = TRUE,
      zerolinecolor = "rgba(0, 229, 255, 0.3)",
      zerolinewidth = 1,
      tickfont = list(color = "#8b92a0", size = 11),
      titlefont = list(color = "#e0e6ed", size = 12),
      linecolor = "#00e5ff",
      linewidth = 1
    ),
    yaxis = list(
      title = "<b style='color:#e0e6ed; font-size:13px;'>Dimensi√≥n 4</b>",
      gridcolor = "#12161f",
      gridwidth = 0.5,
      showgrid = TRUE,
      zeroline = TRUE,
      zerolinecolor = "rgba(0, 229, 255, 0.3)",
      zerolinewidth = 1,
      tickfont = list(color = "#8b92a0", size = 11),
      titlefont = list(color = "#e0e6ed", size = 12),
      linecolor = "#00e5ff",
      linewidth = 1
    ),
    plot_bgcolor = "#000000",
    paper_bgcolor = "#0a0e1a",
    font = list(
      family = "Arial, sans-serif",
      color = "#e0e6ed",
      size = 12
    ),
    hovermode = "closest",
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 12, family = "Arial")
    ),
    margin = list(l = 100, r = 50, b = 100, t = 140),
    legend = list(
      title = list(text = "<b style='color:#00e5ff; font-size:12px;'>Cluster</b>"),
      bgcolor = "rgba(10, 14, 26, 0.9)",
      bordercolor = "#00e5ff",
      borderwidth = 1.5,
      font = list(color = "#e0e6ed", size = 11),
      x = 0.98,
      y = 0.98,
      xanchor = "right",
      yanchor = "top"
    )
  ) %>%
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "clusters_dim3_dim4",
      width = 1400,
      height = 900
    )
  )

cluster_plot1
```

Plano PC3-PC4 (Apertura Comercial vs. Base Territorial): El gr√°fico PC3-PC4 proyecta pa√≠ses en dimensiones ortogonales que capturan aspectos complementarios. El Cluster 1 (rojo) muestra dispersi√≥n muy amplia en PC3 (desde -5 hasta +6), reflejando que desarrollo avanzado no implica modelo comercial √∫nico: micro-Estados como Malta, Luxemburgo, Singapur tienen PC3 extremadamente positivo (hiperglobalizados), mientras que econom√≠as grandes como Jap√≥n, Estados Unidos tienen PC3 cercano a cero (menos abiertos relativamente). En PC4, Cluster 1 var√≠a moderadamente (desde -4 hasta +6), indicando que incluye tanto micro-Estados con territorio limitado (PC4 muy positivo) como pa√≠ses con territorio extenso y recursos naturales diversos.

El Cluster 2 (azul) se concentra en la regi√≥n central de ambos ejes (PC3 entre -2 y +2, PC4 entre -2 y +2), confirmando que son econom√≠as intermedias tanto en apertura comercial como en dotaci√≥n territorial. Algunos pa√≠ses del Cluster 2 muestran PC3 ligeramente negativo, indicando apertura moderada; otros muestran PC4 positivo, indicando presi√≥n demogr√°fica sobre recursos. El Cluster 3 (amarillo) tiene dispersi√≥n moderada en PC3 (desde -3 hasta +2) y PC4 (desde -2 hasta +2.5), reflejando variabilidad en estrategias de apertura comercial y uso del suelo entre pa√≠ses en rezago.

```{r mapa-clusters-cyber, fig.height=7, fig.width=12, out.width="100%"}
world <- ne_countries(scale = "medium", returnclass = "sf")

Base_2022_con_cluster <- Base_2022 %>%
  mutate(Cluster = clusters) %>%  
  select(Codigo, Cluster, Pais)   

Base_con_mapa <- world %>%
  left_join(Base_2022_con_cluster, by = c("iso_a3" = "Codigo")) %>%
  filter(!is.na(Cluster))  

nombres_clusters <- c("1" = "Cluster 1", "2" = "Cluster 2", "3" = "Cluster 3")

pal <- colorFactor(
  palette = c("1" = "#00e676", "2" = "#0084ff", "3" = "#ffd600"), 
  domain = 1:3,
  na.color = "#1a1a2e"
)

mapa_clusters <- leaflet(
  Base_con_mapa,
  width = "100%",
  height = "600px",
  options = leafletOptions(
    minZoom = 2,
    maxZoom = 7,
    worldCopyJump = TRUE
  )
) %>%
  setView(lng = 15, lat = 20, zoom = 2.2) %>%
  addProviderTiles("CartoDB.DarkMatter") %>%
  addPolygons(
    fillColor = ~pal(Cluster),
    weight = 1.2,
    opacity = 0.9,
    color = "#00e5ff",
    fillOpacity = 0.75,
    popup = ~paste0(
      "<div style='font-family: Arial; background: rgba(10, 14, 26, 0.95); padding: 12px; border-radius: 6px; border: 1px solid #00e5ff;'>",
      "<strong style='color: #00e5ff; font-size: 14px;'>", Pais, "</strong><br/>",
      "<span style='color: #8b92a0; font-size: 12px;'>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span><br/>",
      "<span style='color: #e0e6ed; font-size: 12px;'><b>Cl√∫ster:</b></span><br/>",
      "<strong style='color: ", pal(Cluster), "; font-size: 13px;'>", nombres_clusters[as.character(Cluster)], "</strong>",
      "</div>"
    ),
    popupOptions = popupOptions(
      closeButton = TRUE,
      className = "leaflet-popup-cyber"
    ),
    highlight = highlightOptions(
      weight = 2.5,
      color = "#00ffff",
      fillOpacity = 0.9,
      bringToFront = TRUE
    ),
    label = ~Pais,
    labelOptions = labelOptions(
      style = list(
        "background" = "rgba(10, 14, 26, 0.95)",
        "border" = "2px solid #00e5ff",
        "border-radius" = "6px",
        "padding" = "8px 12px",
        "box-shadow" = "0 0 15px rgba(0, 229, 255, 0.6)",
        "color" = "#00e5ff",
        "font-weight" = "bold",
        "font-size" = "12px"
      ),
      textsize = "12px"
    )
  ) %>%
  addLegend(
    "bottomright",
    pal = pal,
    values = ~Cluster,
    title = "<span style='color: #00e5ff; font-weight: bold; text-transform: uppercase;'> Cl√∫steres</span>",
    labFormat = function(type, cuts, p) {
      paste0(nombres_clusters[cuts])
    },
    opacity = 0.9,
    className = "leaflet-legend-cyber"
  )

mapa_clusters <- mapa_clusters %>%
  htmlwidgets::onRender("
    function(el, x) {
      // Estilizar leyenda
      setTimeout(function() {
        var legend = document.querySelector('.leaflet-legend-cyber');
        if (legend) {
          legend.style.background = 'linear-gradient(135deg, #0a0e1a, #12161f)';
          legend.style.border = '2px solid #00e5ff';
          legend.style.borderRadius = '10px';
          legend.style.padding = '18px';
          legend.style.boxShadow = '0 8px 32px rgba(0, 0, 0, 0.9)';
          legend.style.fontFamily = 'Arial, sans-serif';
        }
        
        // Estilizar items de leyenda
        var legendItems = document.querySelectorAll('.leaflet-legend-cyber span');
        legendItems.forEach(function(item) {
          item.style.color = '#e0e6ed';
          item.style.fontSize = '12px';
          item.style.fontWeight = '600';
        });
        
        // Estilizar etiquetas de leyenda (colores)
        var legendLabels = document.querySelectorAll('.leaflet-legend-cyber label');
        legendLabels.forEach(function(label) {
          label.style.color = '#e0e6ed';
          label.style.fontSize = '12px';
          label.style.fontWeight = '500';
          label.style.margin = '6px 0';
        });
        
        // Estilizar t√≠tulo
        var legendTitle = document.querySelector('.leaflet-legend-cyber .legend-title');
        if (legendTitle) {
          legendTitle.style.color = '#00e5ff';
          legendTitle.style.fontWeight = 'bold';
          legendTitle.style.fontSize = '13px';
          legendTitle.style.marginBottom = '10px';
          legendTitle.style.textTransform = 'uppercase';
          legendTitle.style.textShadow = '0 0 10px rgba(0, 229, 255, 0.5)';
        }
        
        // Estilizar popup
        var popup = document.querySelector('.leaflet-popup-cyber');
        if (popup) {
          popup.style.background = 'rgba(10, 14, 26, 0.95)';
          popup.style.border = '2px solid #00e5ff';
          popup.style.borderRadius = '8px';
          popup.style.boxShadow = '0 8px 32px rgba(0, 229, 255, 0.6)';
        }
      }, 500);
    }
  ")

htmltools::tagList(
  htmltools::HTML(
    '<div style=\"
      text-align: center;
      color: #00e5ff;
      font-size: 22px;
      font-weight: bold;
      margin-bottom: 20px;
      text-shadow: 0 0 15px rgba(0, 229, 255, 0.5);
      text-transform: uppercase;
      letter-spacing: 2px;
      font-family: Arial, sans-serif;
    \">
      Figura 20: Distribuci√≥n Geoespacial de Cl√∫steres de Desarrollo
    </div>'
  ),
  mapa_clusters
)
```

El mapa mundial con pa√≠ses coloreados seg√∫n cluster confirma visualmente los patrones geogr√°ficos. Europa aparece predominantemente en Cluster 1 (azul oscuro) y parcialmente Cluster 2 (verde), reflejando consolidaci√≥n de desarrollo en occidente y transici√≥n en oriente. Am√©rica del Norte aparece Cluster 1 (Estados Unidos, Canad√°); Am√©rica Latina aparece mezcla de Cluster 2 (verde: Brasil, M√©xico, Argentina, Chile) y algunos Cluster 1 si pa√≠ses caribe√±os peque√±os est√°n incluidos. Asia muestra heterogeneidad extrema: Jap√≥n, Corea del Sur en Cluster 1; China, India, Sudeste Asi√°tico en Cluster 2; Asia Sur/Central potencialmente en Cluster 3. √Åfrica subsahariana aparece predominantemente Cluster 3 (morado/rosa), con casos aislados de Cluster 2 en sur y este (Botswana, Mauricio, Sud√°frica verde). Ocean√≠a muestra Australia-Nueva Zelanda en Cluster 1; islas del Pac√≠fico potencialmente Cluster 2-3.

Esta distribuci√≥n geogr√°fica valida que desarrollo no es aleatoriamente distribuido sino que presenta patrones espaciales claros asociados con historia econ√≥mica, instituciones, geograf√≠a f√≠sica, y legados coloniales. La concentraci√≥n de Cluster 3 en √Åfrica subsahariana y la consolidaci√≥n de Cluster 1 en Europa Occidental-Am√©rica del Norte-Asia Oriental confirma la persistencia de brechas globales estructurales (Banco Mundial, 2023; Acemoglu & Robinson, 2012).

## Resultados e interpretaci√≥n

### Caracterizacion de los componentes principales

#### Componente Principal 1: "Desarrollo Humano y Conectividad Digital" (24.3% de varianza)

El primer componente principal explica casi un cuarto de toda la variabilidad en desarrollo internacional, capturando la dimensi√≥n m√°s fundamental que diferencia a pa√≠ses ricos de pobres. Se define por esperanza de vida (loading: 0.413), uso de internet (0.4126), acceso a electricidad (0.3709) contrapuestos a mortalidad infantil (-0.4083). Estas variables covar√≠an porque todas requieren sistemas de salud consolidados, riqueza econ√≥mica, infraestructura tecnol√≥gica y estabilidad pol√≠tica‚Äîes decir, reflejan la capacidad institucional de una sociedad para garantizar bienestar multidimensional. Pa√≠ses que han logrado esperanzas de vida de 80+ a√±os han realizado d√©cadas de inversi√≥n en salud p√∫blica, educaci√≥n universal y desarrollo econ√≥mico; simult√°neamente, estos mismos pa√≠ses inevitablemente desarrollaron infraestructuras digitales avanzadas porque sus econom√≠as postindustriales dependen de servicios e innovaci√≥n tecnol√≥gica.

San Marino lidera el extremo positivo de PC1 con coordenada 4.609, siendo una micro-rep√∫blica de 34,000 habitantes enclavada en Italia con esperanza de vida de \~85 a√±os, PIB per c√°pita superior a \$50,000 USD, mortalidad infantil menor a 5 por 1,000, y acceso digital pr√°cticamente universal. Malta (3.608) es otro micro-Estado mediterr√°neo con esperanza de vida de \~83 a√±os que transit√≥ desde econom√≠a agraria a hub financiero y tecnol√≥gico. Irlanda (3.457) representa el "milagro celta" que transform√≥ una econom√≠a de subsistencia agraria en los 1950s hacia hub tecnol√≥gico global con esperanza de vida de \~82 a√±os. Suiza (3.444) y Noruega (2.913) completan el quinteto de √©lite con sus sistemas de salud universales, educaci√≥n de calidad, estabilidad pol√≠tica, y econom√≠as basadas en servicios financieros, manufactura de precisi√≥n, tecnolog√≠a y recursos petroleros.

En el extremo opuesto, N√≠ger encabeza con coordenada -5.599, siendo un pa√≠s saheliano sin salida al mar donde 85% del territorio es desierto del Sahara, con esperanza de vida apenas de 62 a√±os, mortalidad infantil de 85 por 1,000, uso de internet inferior a 10%, y acceso a electricidad de apenas 18%. Burundi (-4.797), una peque√±a naci√≥n densamente poblada devastada por conflictos √©tnicos, muestra esperanza de vida de 61 a√±os y PIB per c√°pita de apenas \$270 USD. Rep√∫blica Democr√°tica del Congo (-4.619) posee recursos naturales valorados en trillones de d√≥lares pero permanece atrapada en pobreza extrema debido a conflictos armados recurrentes y corrupci√≥n sist√©mica, resultando en esperanza de vida de 60 a√±os, mortalidad infantil de 68 por 1,000, y acceso a electricidad inferior a 20%. Sierra Leona (-4.406) y Madagascar (-4.393) completan este quinteto de vulnerabilidad extrema, compartiendo fragilidad institucional, dependencia de agricultura de subsistencia y sistemas de salud colapsados. La brecha cuantitativa es asombrosa: 30 a√±os de diferencia en esperanza de vida, mortalidad infantil 17 veces mayor, acceso digital multiplicado por 10, y riqueza econ√≥mica 200 veces inferior entre los extremos (Banco Mundial, 2023; PNUD, 2023).

#### Componente Principal 2: "Modelo Econ√≥mico-Institucional" (13.5% de varianza)

El segundo componente, ortogonal al primero, captura una dimensi√≥n m√°s sutil: la estructura econ√≥mica independiente del nivel absoluto de riqueza. Se define por industria negativa (-0.5145, cos¬≤: 0.2648), crecimiento poblacional negativo (-0.4365, cos¬≤: 0.1906), contrapuestos a remesas (0.3465, cos¬≤: 0.12), gasto en salud (0.3038, cos¬≤: 0.0923), importaciones (0.2842, cos¬≤: 0.0808) y tierra cultivable (0.2415, cos¬≤: 0.0583). Esta estructura revela un contraste profundo: el extremo negativo representa econom√≠as industrializadas maduras que han completado transiciones demogr√°ficas con capacidad productiva aut√≥noma; el extremo positivo representa econom√≠as peque√±as vulnerables dependientes de transferencias externas de poblaci√≥n emigrada.

Qatar encabeza el extremo negativo con coordenada -5.768 como peque√±o emirato con poblaci√≥n de 2.9 millones (90% migrantes temporales) donde la industria petrolera representa 66% del PIB, generando PIB per c√°pita de \~\$61,000 USD a trav√©s de extracci√≥n de gas natural licuado. Kuwait (-5.102) y Arabia Saudita (-4.487) presentan patrones similares de econom√≠as extractivas con industria petroqu√≠mica representando 50-70% del PIB, crecimiento poblacional controlado artificialmente mediante pol√≠ticas migratorias restrictivas, y no reciben remesas porque funcionan como exportadores netos de trabajadores. Om√°n (-4.455) e Iraq (-3.224), a pesar de la inestabilidad que afecta a Iraq, mantienen industria petrolera significativa que define sus estructuras econ√≥micas.

En el extremo opuesto, Islas Marshall lideran con coordenada 4.210, siendo micro-naci√≥n insular del Pac√≠fico con poblaci√≥n de 60,000 habitantes donde casi 30% de los marshaleses viven en Estados Unidos, enviando remesas que representan 15-20% del PIB dom√©stico. Tonga (3.513), peque√±a naci√≥n polinesia, tiene aproximadamente 50% de sus ciudadanos viviendo en el exterior, generando remesas que constituyen 40% de su PIB‚Äîla proporci√≥n m√°s alta del mundo. Moldavia (3.041), antigua rep√∫blica sovi√©tica sin salida al mar, es una de las naciones m√°s pobres de Europa donde \~25% de su poblaci√≥n trabaja en Rusia o Italia, con remesas representando 16% del PIB como principal fuente de divisas. Samoa (2.898) y L√≠bano (2.750) completan este grupo dependiente de transferencias externas: Samoa recibe remesas principalmente de Australia y Nueva Zelanda, mientras L√≠bano, devastado por crisis financiera y explosiones, depende cr√≠ticamente de remesas de su di√°spora global (\~\$7 mil millones anuales, representando 15% del PIB). Este componente revela una paradoja fascinante: no todos los pa√≠ses ricos dependen de industrializaci√≥n, y no todos los pa√≠ses dependientes de transferencias son pobres‚Äîreflejando que distintos modelos institucionales pueden coexistir con diferentes resultados de desarrollo (Banco Mundial, 2023; FMI, 2023).

#### Componente Principal 3: "Integraci√≥n Comercial Global" (9.1% de varianza)

El tercer componente captura la dimensi√≥n de apertura e integraci√≥n en cadenas globales de valor, definida por importaciones (0.5187, cos¬≤: 0.269), exportaciones (0.5084, cos¬≤: 0.2584), inversi√≥n extranjera directa (0.3714, cos¬≤: 0.138) y crecimiento del PIB (0.2562, cos¬≤: 0.0657) positivos, contrapuestos a √°rea boscosa (-0.273, cos¬≤: 0.0745) y poblaci√≥n (-0.263, cos¬≤: 0.0692) negativos. Esta estructura refleja que la globalizaci√≥n contempor√°nea ha permitido que econom√≠as peque√±as adopten estrategias de hiperespecializaci√≥n e hiperaperrura insert√°ndose en nichos de cadenas globales, mientras que econom√≠as continentales grandes pueden mantener mayor autosuficiencia porque sus mercados internos masivos absorben la mayor parte de la producci√≥n dom√©stica.

Malta lidera el extremo positivo con la coordenada m√°s extrema de todos los componentes (7.072), siendo archipi√©lago mediterr√°neo de 500 km¬≤ con 530,000 habitantes donde importaciones representan 120% del PIB y exportaciones 140%, sumando comercio total superior a 260% del PIB. Malta funciona como hub financiero offshore, centro de servicios digitales (iGaming, blockchain), y base log√≠stica para comercio regional, con inversi√≥n extranjera directa representando \~15% del PIB anualmente. Djibouti (5.246), peque√±o pa√≠s del Cuerno de √Åfrica sin recursos naturales significativos pero posicionado estrat√©gicamente en el Mar Rojo, maneja 95% del comercio exterior de Etiop√≠a (poblaci√≥n: 120 millones sin salida al mar), con importaciones y exportaciones combinadas superando 100% del PIB djiboutiano e ingresos de \~\$200 millones anuales de alquiler de bases militares. San Marino (4.819) e Irlanda (2.588) completan el extremo de hiperglobalizaci√≥n: San Marino con comercio total \>300% PIB, Irlanda como hub tecnol√≥gico y farmac√©utico con exportaciones \>100% PIB.

En el extremo negativo, China encabeza con coordenada -3.651 a pesar de ser la "f√°brica del mundo" y mayor exportador global en t√©rminos absolutos (\$3.6 billones USD en 2022), porque su econom√≠a es tan masiva (\$17.9 billones USD) que el comercio total representa apenas 37% del PIB. India (-2.453), a pesar de exportaciones de \~\$770 mil millones USD, tiene comercio exterior representando apenas 22% de su PIB de \$3.5 billones. Federaci√≥n Rusa (-2.560), aunque es gran exportadora de petr√≥leo, gas y armamento, tiene comercio total de \~45% del PIB porque su econom√≠a continental es relativamente aut√°rquica. Este componente revela la paradoja fundamental de la globalizaci√≥n: los m√°s globalizados son los m√°s peque√±os y vulnerables; los m√°s grandes pueden permitirse mayor independencia comercial (Baldwin, 2016; Rodrik, 2011).

#### Componente Principal 4: "Presi√≥n Territorial y Recursos Naturales" (7.5% de varianza)

El cuarto componente captura el trade-off fundamental entre conservaci√≥n ambiental y expansi√≥n agr√≠cola, definido por √°rea boscosa (0.5134, cos¬≤: 0.2635) positiva, contrapuesta a tierra cultivable (-0.5539, cos¬≤: 0.3068) y poblaci√≥n (-0.4713, cos¬≤: 0.2221) negativas. El extremo positivo representa pa√≠ses con ecosistemas naturales preservados y baja presi√≥n demogr√°fica; el extremo negativo representa pa√≠ses con presi√≥n demogr√°fica masiva que ha forzado sacrificar bosques por tierra agr√≠cola para seguridad alimentaria.

Timor-Leste encabeza el extremo positivo con coordenada 3.921, siendo joven naci√≥n independiente donde \~70% del territorio es bosque tropical monta√±oso con agricultura limitada a \~10% debido a escarpado terreno, poblaci√≥n peque√±a (\~1.3 millones) y presi√≥n demogr√°fica moderada. Finlandia (1.736) tambi√©n en este extremo tiene \~73% de cobertura boscosa boreal, uno de los porcentajes m√°s altos de Europa, con poblaci√≥n de apenas 5.5 millones en territorio de 338,000 km¬≤. Islas Salom√≥n (2.273) y Rep√∫blica del Congo (2.259) tienen cobertura boscosa de \~80% y \~65% respectivamente, manteni√©ndola debido a baja densidad poblacional relativa.

India lidera el extremo negativo con coordenada -5.813, teniendo 1,400 millones de habitantes en 3.3 millones de km¬≤ (densidad: \~420 hab/km¬≤), lo que ha convertido \~60% del territorio en tierra cultivable para arroz, trigo, algod√≥n, ca√±a de az√∫car, reduciendo bosques a apenas 23%. China (-3.891) y Bangladesh (-3.049) presentan patrones similares: Bangladesh tiene densidad de \~1,250 hab/km¬≤ con \~70% tierra cultivable y bosques reducidos a 11%; China, aunque menos densamente poblada (\~145 hab/km¬≤), tiene 1,400 millones de habitantes que han transformado casi toda tierra disponible en agricultura intensiva. Este componente revela el dilema del desarrollo: presi√≥n demogr√°fica extrema obliga sacrificar ecosistemas naturales por seguridad alimentaria; solo pa√≠ses con baja densidad pueden permitirse preservar naturaleza (Banco Mundial, 2023).

```{r caracterizacion_componentes, warning=FALSE, message=FALSE}

caracterizacion_componentes <- data.frame(
  Componente = c("PC1", "PC2", "PC3", "PC4"),
  
  Nombre = c(
    "Desarrollo Humano y Conectividad Digital",
    "Modelo Econ√≥mico-Institucional",
    "Integraci√≥n Comercial Global",
    "Presi√≥n Territorial y Recursos Naturales"
  ),
  
  Varianza_Explicada = c("24.3%", "13.5%", "9.1%", "7.5%"),
  
  Variables_Positivas = c(
    "Esperanza de vida (0.413), Uso de internet (0.413), Acceso a electricidad (0.371)",
    "Remesas (0.347), Gasto en salud (0.304), Importaciones (0.284), Tierra cultivable (0.241)",
    "Importaciones (0.519), Exportaciones (0.508), Inversi√≥n extranjera (0.371), Crecimiento PIB (0.256)",
    "√Årea boscosa (0.513)"
  ),
  
  Variables_Negativas = c(
    "Mortalidad infantil (-0.408)",
    "Industria (-0.515), Crecimiento poblacional (-0.437)",
    "√Årea boscosa (-0.273), Poblaci√≥n (-0.263)",
    "Tierra cultivable (-0.554), Poblaci√≥n (-0.471)"
  ),
  
  Interpretaci√≥n = c(
    "Pa√≠ses desarrollados con alta esperanza de vida, conectividad digital e infraestructura sanitaria vs pa√≠ses en desarrollo con sistemas sanitarios fr√°giles",
    "Econom√≠as industriales maduras vs econom√≠as dependientes de transferencias externas y remesas",
    "Econom√≠as peque√±as ultra-abiertas (hubs comerciales) vs econom√≠as grandes con mercados internos dominantes",
    "Pa√≠ses con ecosistemas preservados vs pa√≠ses con alta presi√≥n agr√≠cola y demogr√°fica"
  )
)

tabla_componentes <- caracterizacion_componentes %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 19**"),
    subtitle = "Caracterizaci√≥n de Componentes Principales del An√°lisis de Desarrollo Global"
  ) %>%
  cols_label(
    Componente = md("**Comp.**"),
    Nombre = md("**Dimensi√≥n Identificada**"),
    Varianza_Explicada = md("**% Varianza**"),
    Variables_Positivas = md("**Variables Positivas**"),
    Variables_Negativas = md("**Variables Negativas**"),
    Interpretaci√≥n = md("**Interpretaci√≥n Conceptual**")
  ) %>%
  cols_align(
    align = "left",
    columns = everything()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium", color = "#000000"),
      cell_fill(color = "#00e5ff")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "#00e5ff",
      weight = px(2)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "#00e5ff",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Componente, Nombre, Varianza_Explicada, Variables_Positivas, Variables_Negativas))
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#0a0e1a"),
      cell_text(color = "#e0e6ed")
    ),
    locations = cells_body()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff"),
      cell_fill(color = "#12161f")
    ),
    locations = cells_body(columns = Componente)
  ) %>%
  tab_style(
    style = cell_text(weight = "bold", color = "#00e5ff"),
    locations = cells_body(columns = Varianza_Explicada)
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff", size = "large")
    ),
    locations = cells_title(groups = "title")
  ) %>%
  tab_style(
    style = list(
      cell_text(color = "#8b92a0", size = "medium")
    ),
    locations = cells_title(groups = "subtitle")
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "solid",
    column_labels.border.top.color = "#00e5ff",
    column_labels.border.top.width = px(3),
    column_labels.border.bottom.style = "solid",
    column_labels.border.bottom.width = px(3),
    column_labels.border.bottom.color = "#00e5ff",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    table_body.hlines.style = "solid",
    table_body.hlines.color = "#00e5ff",
    table_body.hlines.width = px(1),
    table.background.color = "#0a0e1a",
    data_row.padding = px(12),
    heading.title.font.size = 18,
    heading.subtitle.font.size = 14,
    heading.padding = px(12),
    heading.border.bottom.style = "solid",
    heading.border.bottom.width = px(2),
    heading.border.bottom.color = "#00e5ff",
    footnotes.padding = px(10),
    footnotes.font.size = 13,
    source_notes.font.size = 13,
    source_notes.padding = px(10)
  ) %>%
  tab_source_note(
    source_note = md("**Fuente:** Elaboraci√≥n propia con base en el An√°lisis de Componentes Principales de indicadores de desarrollo global (Banco Mundial, 2022)")
  ) %>%
  tab_footnote(
    footnote = "Los valores en par√©ntesis representan las cargas (loadings) de cada variable en el componente principal",
    locations = cells_body(
      rows = c(1, 2, 3, 4),
      columns = Variables_Positivas
    )
  )

tabla_componentes
```

### Prediccion

Tras construir el modelo ACP con aproximadamente 180 pa√≠ses de entrenamiento, se proyectaron cinco pa√≠ses adicionales (Angola, Belice, Jordania, Luxemburgo, Uruguay) sobre el espacio factorial ya definido. La proyecci√≥n utiliza las medias y varianzas del conjunto de entrenamiento para estandarizar los nuevos datos, evitando que cambien la estructura de componentes. Se calcularon las coordenadas de estos cinco pa√≠ses en los cuatro primeros componentes principales, cuantificando su posici√≥n relativa respecto al espacio multidimensional de desarrollo ya identificado (Hastie et al., 2009).

```{r Prediccion-CYBER-STYLE}

Prediccion <- read_csv("f36a5086-3311-4b1a-9f0c-bda5cd4718df_Series - Metadata.csv",
                 show_col_types = FALSE) %>%
  select(
    Pais = `Country Name`,
    Codigo = `Country Code`,
    PIB_per = `GDP per capita (current US$) [NY.GDP.PCAP.CD]`,
    Poblacion = `Population, total [SP.POP.TOTL]`,
    `Esperanza vida` = `Life expectancy at birth, total (years) [SP.DYN.LE00.IN]`,
    `Acceso electricidad` = `Access to electricity (% of population) [EG.ELC.ACCS.ZS]`,
    `Area boscosa` = `Forest area (% of land area) [AG.LND.FRST.ZS]`,
    `Suscripciones movil` = `Mobile cellular subscriptions (per 100 people) [IT.CEL.SETS.P2]`,
    `Crecimiento PIB` = `GDP growth (annual %) [NY.GDP.MKTP.KD.ZG]`,
    `Mortalidad infantil` = `Mortality rate, infant (per 1,000 live births) [SP.DYN.IMRT.IN]`,
    `Inversion extranjera` = `Foreign direct investment, net inflows (% of GDP) [BX.KLT.DINV.WD.GD.ZS]`,
    `Gasto salud` = `Current health expenditure (% of GDP) [SH.XPD.CHEX.GD.ZS]`,
    `Uso internet` = `Individuals using the Internet (% of population) [IT.NET.USER.ZS]`,
    Importaciones = `Imports of goods and services (% of GDP) [NE.IMP.GNFS.ZS]`,
    Exportaciones = `Exports of goods and services (% of GDP) [NE.EXP.GNFS.ZS]`,
    `Tierra cultivable` = `Arable land (% of land area) [AG.LND.ARBL.ZS]`,
    `Crecimiento poblacion` = `Population growth (annual %) [SP.POP.GROW]`,
    Industria = `Industry (including construction), value added (% of GDP) [NV.IND.TOTL.ZS]`,
    Remesas = `Personal remittances, received (% of GDP) [BX.TRF.PWKR.DT.GD.ZS]`
  ) %>%
  filter(Pais %in% c("Uruguay","Belize","Luxembourg","Jordan","Angola"))

ind.test <- Prediccion[, 3:19] %>%
  mutate(across(everything(), as.numeric))

ind.test_clean <- ind.test %>%
  mutate(across(everything(), ~ifelse(is.na(.), mean(., na.rm = TRUE), .)))

ind.test.coord <- predict(res.pca, newdata = ind.test_clean)

coordenadas_paises <- data.frame(
  Pa√≠s = Prediccion$Pais,
  `C√≥digo Pa√≠s` = Prediccion$Codigo,
  `Dimensi√≥n 1 - Desarrollo Humano` = round(ind.test.coord[, 1], 4),
  `Dimensi√≥n 2 - Industrializaci√≥n` = round(ind.test.coord[, 2], 4),
  `Dimensi√≥n 3 - Apertura Comercial` = round(ind.test.coord[, 3], 4),
  `Dimensi√≥n 4 - Recursos Naturales` = round(ind.test.coord[, 4], 4)
)

tabla_coordenadas <- coordenadas_paises %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 20**"),
    subtitle = "Coordenadas de Pa√≠ses en Componentes Principales"
  ) %>%
  cols_label(
    Pa√≠s = md("**Pa√≠s**"),
    `C√≥digo.Pa√≠s` = md("**C√≥digo**"),
    `Dimensi√≥n.1...Desarrollo.Humano` = md("**Dim 1<br>Desarrollo**"),
    `Dimensi√≥n.2...Industrializaci√≥n` = md("**Dim 2<br>Industrializaci√≥n**"),
    `Dimensi√≥n.3...Apertura.Comercial` = md("**Dim 3<br>Comercio**"),
    `Dimensi√≥n.4...Recursos.Naturales` = md("**Dim 4<br>Recursos**")
  ) %>%
  cols_align(
    align = "center",
    columns = c(`Dimensi√≥n.1...Desarrollo.Humano`, `Dimensi√≥n.2...Industrializaci√≥n`,
                `Dimensi√≥n.3...Apertura.Comercial`, `Dimensi√≥n.4...Recursos.Naturales`)
  ) %>%
  cols_align(
    align = "left",
    columns = c(Pa√≠s, `C√≥digo.Pa√≠s`)
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium", color = "#000000"),
      cell_fill(color = "#00e5ff")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "#00e5ff",
      weight = px(2)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "#00e5ff",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Pa√≠s, `C√≥digo.Pa√≠s`, `Dimensi√≥n.1...Desarrollo.Humano`, 
                                       `Dimensi√≥n.2...Industrializaci√≥n`, `Dimensi√≥n.3...Apertura.Comercial`))
  ) %>%
  tab_style(
    style = list(
      cell_fill(color = "#0a0e1a"),
      cell_text(color = "#e0e6ed")
    ),
    locations = cells_body()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff"),
      cell_fill(color = "#12161f")
    ),
    locations = cells_body(columns = Pa√≠s)
  ) %>%
  tab_style(
    style = cell_text(weight = "bold", color = "#00e676"),
    locations = cells_body(columns = c(`Dimensi√≥n.1...Desarrollo.Humano`, `Dimensi√≥n.2...Industrializaci√≥n`,
                                       `Dimensi√≥n.3...Apertura.Comercial`, `Dimensi√≥n.4...Recursos.Naturales`))
  ) %>%
  tab_style(
    style = cell_text(size = "small"),
    locations = cells_body(columns = `C√≥digo.Pa√≠s`)
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", color = "#00e5ff", size = "large")
    ),
    locations = cells_title(groups = "title")
  ) %>%
  tab_style(
    style = list(
      cell_text(color = "#8b92a0", size = "medium")
    ),
    locations = cells_title(groups = "subtitle")
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "solid",
    column_labels.border.top.color = "#00e5ff",
    column_labels.border.top.width = px(3),
    column_labels.border.bottom.style = "solid",
    column_labels.border.bottom.width = px(3),
    column_labels.border.bottom.color = "#00e5ff",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    table_body.hlines.style = "solid",
    table_body.hlines.color = "#00e5ff",
    table_body.hlines.width = px(1),
    table.background.color = "#0a0e1a",
    data_row.padding = px(12),
    heading.title.font.size = 18,
    heading.subtitle.font.size = 14,
    heading.padding = px(12),
    heading.border.bottom.style = "solid",
    heading.border.bottom.width = px(2),
    heading.border.bottom.color = "#00e5ff",
    footnotes.padding = px(10),
    footnotes.font.size = 13,
    source_notes.font.size = 13,
    source_notes.padding = px(10)
  ) %>%
  tab_source_note(
    source_note = md("**Fuente:** Elaboraci√≥n propia con base en proyecci√≥n PCA de indicadores del Banco Mundial (2022)")
  ) %>%
  tab_footnote(
    footnote = "Proyecci√≥n de pa√≠ses seleccionados sobre los cuatro componentes principales del an√°lisis",
    locations = cells_title(groups = "subtitle")
  )

tabla_coordenadas

coordenadas_originales <- as.data.frame(res.pca$x)
coordenadas_originales$Pais <- rownames(coordenadas_originales)
coordenadas_originales$Tipo <- "Original"

coordenadas_predichas <- as.data.frame(ind.test.coord)
coordenadas_predichas$Pais <- Prediccion$Pais
coordenadas_predichas$Tipo <- "Predicho"

colnames(coordenadas_originales)[1:4] <- c("PC1", "PC2", "PC3", "PC4")
colnames(coordenadas_predichas)[1:4] <- c("PC1", "PC2", "PC3", "PC4")

datos_completos <- rbind(
  coordenadas_originales[, c("Pais", "PC1", "PC2", "PC3", "PC4", "Tipo")],
  coordenadas_predichas[, c("Pais", "PC1", "PC2", "PC3", "PC4", "Tipo")]
)
```

```{r prediccion_animado_reorganizado, message=FALSE, warning=FALSE, fig.height=7.5, fig.width=12, out.width="100%"}

p_animado <- plot_ly() %>%
  
  add_trace(
    data = datos_completos[datos_completos$Tipo == "Original", ],
    x = ~PC1, y = ~PC2,
    type = 'scatter',
    mode = 'markers',
    marker = list(
      color = '#8b92a0',
      size = 8,
      opacity = 0.6,
      line = list(width = 1, color = '#e0e6ed')
    ),
    name = "Pa√≠ses originales",
    hoverinfo = 'text',
    hovertext = ~paste(
      "<b style='color:#00e5ff; font-size:13px;'>", Pais, "</b><br>",
      "<span style='color:#8b92a0; font-size:11px;'><b>Tipo:</b> Original</span><br>",
      "<b style='color:#00e676;'>Dim 1:</b> ", round(PC1, 3), "<br>",
      "<b style='color:#00e5ff;'>Dim 2:</b> ", round(PC2, 3)
    )
  ) %>%
  
  add_trace(
    data = datos_completos[datos_completos$Tipo == "Predicho", ],
    x = ~PC1, y = ~PC2,
    type = 'scatter',
    mode = 'markers',
    marker = list(
      color = '#00e5ff',
      size = 14,
      opacity = 0.95,
      symbol = 'star',
      line = list(width = 2, color = '#ffffff')
    ),
    name = "Pa√≠ses predichos",
    hoverinfo = 'text',
    hovertext = ~paste(
      "<b style='color:#ffd600; font-size:13px;'>", Pais, "</b><br>",
      "<span style='color:#a259ff; font-size:11px;'><b>Tipo:</b> Predicho</span><br>",
      "<b style='color:#00e676;'>Dim 1:</b> ", round(PC1, 3), "<br>",
      "<b style='color:#00e5ff;'>Dim 2:</b> ", round(PC2, 3)
    ),
    visible = FALSE
  ) %>%
  
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:20px;'>Figura 21: Proyecci√≥n PCA Dim 1 vs Dim 2</b><br>
             <span style='color:#8b92a0; font-size:12px;'>Pa√≠ses originales (gris) y predichos (cyan)</span>",
      x = 0.5,
      xanchor = 'center',
      y = 0.98
    ),
    xaxis = list(
      title = "<b style='color:#e0e6ed; font-size:13px;'>Dimensi√≥n 1 - Desarrollo Humano y Tecnol√≥gico (24.3%)</b>",
      zeroline = TRUE,
      zerolinecolor = "rgba(0, 229, 255, 0.3)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      tickfont = list(color = '#8b92a0', size = 11),
      titlefont = list(color = '#e0e6ed', size = 12)
    ),
    yaxis = list(
      title = "<b style='color:#e0e6ed; font-size:13px;'>Dimensi√≥n 2 - Modelo Econ√≥mico (13.5%)</b>",
      zeroline = TRUE,
      zerolinecolor = "rgba(0, 229, 255, 0.3)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      tickfont = list(color = '#8b92a0', size = 11),
      titlefont = list(color = '#e0e6ed', size = 12)
    ),
    hovermode = "closest",
    plot_bgcolor = '#000000',
    paper_bgcolor = '#0a0e1a',
    font = list(family = "Arial, sans-serif", color = '#e0e6ed', size = 12),
    margin = list(l = 100, r = 80, b = 100, t = 140),
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 12, family = "Arial")
    ),
    legend = list(
      bgcolor = "rgba(10, 14, 26, 0.9)",
      bordercolor = "#00e5ff",
      borderwidth = 1.5,
      x = 0.02,
      y = 0.55,
      xanchor = "left",
      yanchor = "middle",
      font = list(size = 11, color = "#e0e6ed")
    ),
    updatemenus = list(
      list(
        type = "buttons",
        direction = "vertical",
        x = 0.95,
        y = 0.05,
        xanchor = "right",
        yanchor = "bottom",
        buttons = list(
          list(
            method = "update",
            args = list(
              list(visible = c(TRUE, FALSE)),
              list(title = "<b style='color:#00e5ff; font-size:20px;'>Figura 21: Proyecci√≥n PCA Dim 1 vs Dim 2</b><br>
                             <span style='color:#8b92a0; font-size:12px;'>Solo pa√≠ses originales</span>")
            ),
            label = "Solo Originales"
          ),
          list(
            method = "update",
            args = list(
              list(visible = c(TRUE, TRUE)),
              list(title = "<b style='color:#00e5ff; font-size:20px;'>Figura 21: Proyecci√≥n PCA Dim 1 vs Dim 2</b><br>
                             <span style='color:#8b92a0; font-size:12px;'>Pa√≠ses originales (gris) y predichos (cyan)</span>")
            ),
            label = "Mostrar Predichos"
          )
        ),
        bgcolor = "rgba(0, 229, 255, 0.15)",
        bordercolor = "#00e5ff",
        borderwidth = 1.5,
        font = list(size = 10, color = "#00e5ff", family = "Arial")
      )
    )
  ) %>%
  
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "pca_prediccion_dim1_dim2",
      width = 1400,
      height = 900
    )
  )

p_animado

p_animado1 <- plot_ly() %>%
  
  add_trace(
    data = datos_completos[datos_completos$Tipo == "Original", ],
    x = ~PC3, y = ~PC4,
    type = 'scatter',
    mode = 'markers',
    marker = list(
      color = '#8b92a0',
      size = 8,
      opacity = 0.6,
      line = list(width = 1, color = '#e0e6ed')
    ),
    name = "Pa√≠ses originales",
    hoverinfo = 'text',
    hovertext = ~paste(
      "<b style='color:#00e5ff; font-size:13px;'>", Pais, "</b><br>",
      "<span style='color:#8b92a0; font-size:11px;'><b>Tipo:</b> Original</span><br>",
      "<b style='color:#00e676;'>Dim 3:</b> ", round(PC3, 3), "<br>",
      "<b style='color:#00e5ff;'>Dim 4:</b> ", round(PC4, 3)
    )
  ) %>%
  
  add_trace(
    data = datos_completos[datos_completos$Tipo == "Predicho", ],
    x = ~PC3, y = ~PC4,
    type = 'scatter',
    mode = 'markers',
    marker = list(
      color = '#ffd600',
      size = 14,
      opacity = 0.95,
      symbol = 'star',
      line = list(width = 2, color = '#ffffff')
    ),
    name = "Pa√≠ses predichos",
    hoverinfo = 'text',
    hovertext = ~paste(
      "<b style='color:#ffd600; font-size:13px;'>", Pais, "</b><br>",
      "<span style='color:#a259ff; font-size:11px;'><b>Tipo:</b> Predicho</span><br>",
      "<b style='color:#00e676;'>Dim 3:</b> ", round(PC3, 3), "<br>",
      "<b style='color:#00e5ff;'>Dim 4:</b> ", round(PC4, 3)
    ),
    visible = FALSE
  ) %>%
  
  layout(
    title = list(
      text = "<b style='color:#00e5ff; font-size:20px;'>Figura 22: Proyecci√≥n PCA Dim 3 vs Dim 4</b><br>
             <span style='color:#8b92a0; font-size:12px;'>Pa√≠ses originales (gris) y predichos (dorado)</span>",
      x = 0.5,
      xanchor = 'center',
      y = 0.98
    ),
    xaxis = list(
      title = "<b style='color:#e0e6ed; font-size:13px;'>Dimensi√≥n 3 - Integraci√≥n Comercial Global (9.1%)</b>",
      zeroline = TRUE,
      zerolinecolor = "rgba(0, 229, 255, 0.3)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      tickfont = list(color = '#8b92a0', size = 11),
      titlefont = list(color = '#e0e6ed', size = 12)
    ),
    yaxis = list(
      title = "<b style='color:#e0e6ed; font-size:13px;'>Dimensi√≥n 4 - Presi√≥n Territorial (7.5%)</b>",
      zeroline = TRUE,
      zerolinecolor = "rgba(0, 229, 255, 0.3)",
      zerolinewidth = 2,
      gridcolor = '#12161f',
      showgrid = TRUE,
      tickfont = list(color = '#8b92a0', size = 11),
      titlefont = list(color = '#e0e6ed', size = 12)
    ),
    hovermode = "closest",
    plot_bgcolor = '#000000',
    paper_bgcolor = '#0a0e1a',
    font = list(family = "Arial, sans-serif", color = '#e0e6ed', size = 12),
    margin = list(l = 100, r = 80, b = 100, t = 140),
    hoverlabel = list(
      bgcolor = "rgba(10, 14, 26, 0.95)",
      bordercolor = "#00e5ff",
      font = list(color = "#e0e6ed", size = 12, family = "Arial")
    ),
    legend = list(
      bgcolor = "rgba(10, 14, 26, 0.9)",
      bordercolor = "#00e5ff",
      borderwidth = 1.5,
      x = 0.02,
      y = 0.55,
      xanchor = "left",
      yanchor = "middle",
      font = list(size = 11, color = "#e0e6ed")
    ),
    updatemenus = list(
      list(
        type = "buttons",
        direction = "vertical",
        x = 0.95,
        y = 0.05,
        xanchor = "right",
        yanchor = "bottom",
        buttons = list(
          list(
            method = "update",
            args = list(
              list(visible = c(TRUE, FALSE)),
              list(title = "<b style='color:#00e5ff; font-size:20px;'>Figura 22: Proyecci√≥n PCA Dim 3 vs Dim 4</b><br>
                             <span style='color:#8b92a0; font-size:12px;'>Solo pa√≠ses originales</span>")
            ),
            label = "Solo Originales"
          ),
          list(
            method = "update",
            args = list(
              list(visible = c(TRUE, TRUE)),
              list(title = "<b style='color:#00e5ff; font-size:20px;'>Figura 19: Proyecci√≥n PCA Dim 3 vs Dim 4</b><br>
                             <span style='color:#8b92a0; font-size:12px;'>Pa√≠ses originales (gris) y predichos (dorado)</span>")
            ),
            label = "Mostrar Predichos"
          )
        ),
        bgcolor = "rgba(0, 229, 255, 0.15)",
        bordercolor = "#00e5ff",
        borderwidth = 1.5,
        font = list(size = 10, color = "#00e5ff", family = "Arial")
      )
    )
  ) %>%
  
  config(
    responsive = TRUE,
    displayModeBar = TRUE,
    displaylogo = FALSE,
    modeBarButtonsToRemove = list('lasso2d', 'select2d'),
    toImageButtonOptions = list(
      format = "png",
      filename = "pca_prediccion_dim3_dim4",
      width = 1400,
      height = 900
    )
  )

p_animado1

```

Luxemburgo obtiene coordenada 2.9075 en PC1 (desarrollo extremo), junto a San Marino en la √©lite ultra-desarrollada, confirmando su posici√≥n como micro-Estado financiero con esperanza de vida de 85 a√±os e hiperconectividad digital. Uruguay (1.4145 en PC1) se posiciona como pa√≠s emergente latinoamericano con desarrollo humano consolidado. Jordania (0.1673) y Belice (-0.4472) son casos intermedios de ingresos medios con vulnerabilidades persistentes. Angola (-3.6127) lidera el rezago extremo, caracterizada por baja esperanza de vida (61 a√±os), alta mortalidad infantil (56 por 1,000) y acceso limitado a servicios. En Dimensi√≥n 2, Luxemburgo (-1.0540) representa industrializaci√≥n postindustrial consolidada; Angola (-1.7126) representa industrializaci√≥n petroqu√≠mica sin beneficios distributivos. En Dimensi√≥n 3, Luxemburgo (-7.6090) es hiperglobalizado (comercio \>300% PIB); Angola (-0.1232) es b√°sicamente cerrada con dependencia petrolera. En Dimensi√≥n 4, Luxemburgo (4.9379) tiene escasa presi√≥n demogr√°fica; Angola (1.7885) tiene tierra cultivable disponible pero sin transformaci√≥n agr√≠cola.

### Caracteristicas de los clusters

El an√°lisis de clusterizaci√≥n jer√°rquica mediante el m√©todo de Ward identific√≥ tres grupos coherentes de pa√≠ses que trascienden clasificaciones geogr√°ficas tradicionales. La segmentaci√≥n produjo una distribuci√≥n desigual: el Cluster 1 agrupa 84 pa√≠ses (61.8% del total), el Cluster 2 agrupa 32 pa√≠ses (23.5%), y el Cluster 3 agrupa 20 pa√≠ses (14.7%).

Cluster 1: Desarrollo Humano Avanzado y Conectividad Digital Consolidada (61.8% de pa√≠ses) Este grupo se caracteriza por valores extremadamente altos en indicadores de desarrollo humano e infraestructura tecnol√≥gica. La esperanza de vida promedio es de 77.44 a√±os, el nivel m√°s alto entre los tres clusters, indicando sistemas sanitarios consolidados, nutrici√≥n adecuada y estabilidad sociopol√≠tica. El acceso a electricidad alcanza 99.16%, reflejando electrificaci√≥n pr√°cticamente universal que define a econom√≠as desarrolladas. El uso de internet es 86.05%, el m√°s elevado, confirmando que la conectividad digital es caracter√≠stica definitoria de este grupo.

La mortalidad infantil es apenas 7.85 por cada 1,000 nacidos vivos, la m√°s baja entre los clusters, reflejando que los sistemas de salud materno-infantil funcionan eficientemente. El PIB per c√°pita promedio es 26,489.97 USD, demostrando riqueza econ√≥mica consolidada. El gasto en salud representa 7.62% del PIB, el m√°s alto, validando inversi√≥n sustancial en sistemas de salud universales.

Desde la perspectiva econ√≥mica, las exportaciones representan 55.30% del PIB e importaciones 54.55%, indicando que estos pa√≠ses son hubs comerciales internacionales. La industria representa 28.53% del PIB, confirmando que aunque estas econom√≠as son postindustriales basadas en servicios, mantienen capacidad manufacturera significativa. La inversi√≥n extranjera directa es 5.08% del PIB, indicando que son destinos atractivos para capitales internacionales. El crecimiento poblacional es apenas 0.73% anual, reflejando que han completado transiciones demogr√°ficas con poblaciones envejecidas.

Composici√≥n geogr√°fica: Incluye principalmente naciones europeas desarrolladas (Alemania, Francia, Italia, Espa√±a, Reino Unido, Suecia, Dinamarca, Finlandia, Noruega, Pa√≠ses Bajos), naciones norteamericanas (Estados Unidos, Canad√°), econom√≠as asi√°ticas avanzadas (Jap√≥n, Corea del Sur, Singapur, Hong Kong), y destinos de desarrollo consolidado (Australia, Nueva Zelanda, Israel).

Cluster 2: Desarrollo Intermedio Heterog√©neo con Vulnerabilidades Persistentes (23.5% de pa√≠ses)

Este grupo representa pa√≠ses con desarrollo humano intermedio pero altamente heterog√©neo internamente. La esperanza de vida promedio es de 64.29 a√±os, sustancialmente menor que Cluster 1 (13 a√±os de diferencia), indicando que estos pa√≠ses han logrado avances en salud b√°sica pero enfrentan desaf√≠os significativos. El acceso a electricidad es 54.59%, apenas por encima de la mitad, reflejando que la electrificaci√≥n es incompleta, especialmente en zonas rurales. El uso de internet es 35.04%, menos de la mitad de Cluster 1, confirmando que la brecha digital es significativa.

La mortalidad infantil es 40.97 por cada 1,000, aproximadamente 5 veces mayor que Cluster 1, indicando que los sistemas de salud materno-infantil enfrentan capacidades limitadas. El PIB per c√°pita promedio es 1,578.46 USD, dram√°ticamente menor que Cluster 1 (95% de diferencia), confirmando que estos son pa√≠ses de ingresos medios-bajos a medios. El crecimiento poblacional es 2.31% anual, significativamente m√°s alto que Cluster 1, reflejando que est√°n en transiciones demogr√°ficas incompletas donde la natalidad sigue siendo elevada.

Las remesas recibidas representan 4.94% del PIB, indicando dependencia moderada de transferencias de migrantes. La inversi√≥n extranjera es 3.65% del PIB, inferior a Cluster 1, sugiriendo que son menos atractivos para capitales internacionales. El gasto en salud es 5.10% del PIB, menor que Cluster 1, limitando recursos disponibles para sistemas de salud. La tierra cultivable es 20.60%, la m√°s alta entre clusters, reflejando que muchos son econom√≠as donde la agricultura sigue siendo importante.

Composici√≥n geogr√°fica: Incluye principalmente econom√≠as latinoamericanas emergentes (Brasil, M√©xico, Colombia, Argentina, Chile, Per√∫), econom√≠as asi√°ticas en transici√≥n (Vietnam, Tailandia, Indonesia, Filipinas, India en su mayor√≠a), econom√≠as africanas moderadamente desarrolladas (Botswana, Mauricio, Sud√°frica), y pa√≠ses del Oriente Medio con ingresos medios (Turqu√≠a, Jordania, L√≠bano).

Cluster 3: Rezago Extremo y Vulnerabilidad Multidimensional (14.7% de pa√≠ses) Este grupo presenta caracter√≠sticas parad√≥jicas que requieren interpretaci√≥n cuidadosa. La esperanza de vida promedio es 71.59 a√±os, aparentemente intermedia, pero esta cifra oculta volatilidad extrema: mientras algunos pa√≠ses tienen 75 a√±os, otros tienen 55-58 a√±os, con mortalidad adulta severamente elevada por VIH, conflictos armados y enfermedades tropicales. El acceso a electricidad es 96.42%, aparentemente alto, pero esta cifra promedio se distorsiona porque algunos pa√≠ses tienen cobertura urbana buena mientras zonas rurales est√°n completamente sin electricidad.

La mortalidad infantil es 18.11 por cada 1,000, intermedia entre Cluster 1 (7.85) y Cluster 2 (40.97), sugiriendo que este cluster contiene algunos pa√≠ses que han logrado mejoras en salud infantil. El uso de internet es 61.08%, sorprendentemente alto comparado con Cluster 2 (35.04%), pero se explica porque algunos pa√≠ses han adoptado tecnolog√≠a m√≥vil masivamente sin infraestructura de electricidad o salud consolidada.

El PIB per c√°pita es 3,776.68 USD, intermedio entre Cluster 2 (1,578) y Cluster 1 (26,489), contradictorio con la caracterizaci√≥n de rezago extremo, pero refleja que algunos pa√≠ses tienen petr√≥leo (Angola) o recursos (Zambia) que generan ingresos nominales sin beneficios distributivos amplios. Las remesas recibidas son 22.09% del PIB, el porcentaje m√°s alto, reflejando que estas econom√≠as est√°n severamente dependientes de transferencias de di√°sporas en el exterior. El gasto en salud es 7.44% del PIB, similar a Cluster 1, pero esta cifra es enga√±osa porque presupuestos limitados resultan en servicios muy deficientes.

La paradoja del Cluster 3: Algunas m√©tricas (esperanza de vida 71.59, acceso electricidad 96.42, gasto salud 7.44%) parecen intermedias, no rezagadas. Esto refleja que el cluster contiene mezcla heterog√©nea: pa√≠ses como Angola (productor petrolero con ingresos altos nominales pero servicios colapsados) coexisten con pa√≠ses como Etiop√≠a o Uganda. La vulnerabilidad real radica en fragilidad institucional, volatilidad, dependencia de remesas (22.09% vs. 2.47% en Cluster 1), y que indicadores altos coexisten con servicios p√∫blicos disfuncionales.

### Patrones interesantes

El an√°lisis revela m√∫ltiples patrones fascinantes que trascienden clasificaciones geogr√°ficas tradicionales y desaf√≠an expectativas convencionales sobre desarrollo internacional.

Patrones que Trascienden Fronteras Geogr√°ficas El hallazgo m√°s sorprendente es que la geograf√≠a no determina el desarrollo. Uruguay y Chile en Sudam√©rica comparten caracter√≠sticas similares en desarrollo humano con pa√≠ses europeos orientales como Estonia y Polonia, mientras que econom√≠as asi√°ticas como Malasia y Tailandia exhiben perfiles comparables a pa√≠ses latinoamericanos de renta media alta como M√©xico y Colombia. Este patr√≥n confirma que existen perfiles globales de desarrollo que operan independientemente de proximidad territorial o herencia cultural compartida.

Vietnam en Asia comparte caracter√≠sticas similares con Colombia en Sudam√©rica en t√©rminos de industrializaci√≥n y conectividad digital, a pesar de estar separados por oc√©anos y tener historias completamente diferentes. Botswana en √Åfrica muestra indicadores comparables a algunos pa√≠ses de Europa del Este, demostrando que pa√≠ses africanos pueden alcanzar desarrollo intermedio cuando implementan pol√≠ticas correctas.

La Paradoja de Costa Rica: Alto Desarrollo con Recursos Limitados Costa Rica emerge como caso emblem√°tico de desarrollo inteligente. Este pa√≠s tiene esperanza de vida de 80 a√±os (comparable a Alemania o Jap√≥n), mortalidad infantil de 7.4 por cada 1,000 nacidos (similar a pa√≠ses europeos), y cobertura forestal del 52% (una de las m√°s altas del mundo). Sin embargo, su PIB per c√°pita es apenas 12,500 USD, dram√°ticamente menor que los 40,000+ USD de Europa Occidental.

¬øC√≥mo logra Costa Rica esto? Inversi√≥n estrat√©gica sostenida en salud p√∫blica, educaci√≥n universal, y conservaci√≥n ambiental durante d√©cadas, incluso cuando no era el pa√≠s m√°s rico de la regi√≥n. Este patr√≥n demuestra emp√≠ricamente que desarrollo humano alto no requiere riqueza econ√≥mica absoluta, sino decisiones pol√≠ticas deliberadas sobre priorizaci√≥n de gasto p√∫blico.

Qatar, Kuwait y Emiratos √Årabes Unidos tienen PIB per c√°pita entre los m√°s altos del mundo (40,000-100,000 USD), superando dram√°ticamente a econom√≠as europeas consolidadas. Sin embargo, el an√°lisis revela fragilidad estructural profunda: dependencia cr√≠tica de un √∫nico sector (petr√≥leo representa 50-70% del PIB), estructuras demogr√°ficas distorsionadas (90% de poblaci√≥n son migrantes temporales sin ciudadan√≠a), y nula diversificaci√≥n productiva.

Cuando los precios del petr√≥leo caen, estas econom√≠as enfrentan crisis severas porque carecen de sectores alternativos. En contraste, Singapur y Corea del Sur‚Äîque carecen completamente de petr√≥leo‚Äîhan construido econom√≠as mucho m√°s resilientes mediante diversificaci√≥n industrial, educaci√≥n masiva, y exportaciones de alta tecnolog√≠a.

El an√°lisis identifica un cluster de pa√≠ses cuyas econom√≠as dependen cr√≠ticamente de remesas enviadas por ciudadanos trabajando en el exterior: Tonga (40% del PIB), Tayikist√°n (35%), Kirguist√°n (30%), Hait√≠ (25%), Honduras (20%). Estas transferencias superan ampliamente la ayuda externa y la inversi√≥n extranjera directa combinadas.

Este patr√≥n revela una realidad invisible en estad√≠sticas convencionales: millones de familias sobreviven porque alg√∫n miembro emigr√≥ y env√≠a dinero mensualmente. Moldavia, una de las naciones m√°s pobres de Europa, tiene 25% de su poblaci√≥n trabajando en Rusia o Italia, con remesas representando 16% del PIB como principal fuente de divisas. La vulnerabilidad es evidente: cuando pa√≠ses receptores (Estados Unidos, Europa, Golfo P√©rsico) enfrentan recesiones, los flujos de remesas colapsan instant√°neamente.

poblacional han sacrificado sistem√°ticamente bosques por tierra cultivable para seguridad alimentaria. India lidera este extremo con 1,400 millones de habitantes en 3.3 millones de km¬≤ (densidad 420 hab/km¬≤), habiendo convertido 60% del territorio en tierra cultivable y reducido bosques a apenas 23%.

Bangladesh presenta el caso m√°s extremo: densidad de 1,250 hab/km¬≤, 70% de tierra cultivable, y bosques reducidos a 11%. China, aunque menos densamente poblada (145 hab/km¬≤), tiene 1,400 millones de habitantes que han transformado casi toda tierra disponible en agricultura intensiva.

En contraste, pa√≠ses con baja densidad poblacional preservan naturaleza: Finlandia (73% bosques, 5.5 millones de habitantes), Surinam (93% bosques), Guyana (84% bosques). Este patr√≥n no es coincidencia sino evidencia de que presi√≥n demogr√°fica extrema obliga sacrificar ecosistemas por supervivencia.

Malta, Luxemburgo, Singapur e Irlanda exhiben comercio exterior superior al 200-300% del PIB‚Äîes decir, importan y exportan valores que duplican o triplican su econom√≠a completa. Malta alcanza 260% del PIB en comercio total, funcionando como hub financiero offshore, centro de servicios digitales (iGaming, blockchain), y base log√≠stica regional.

En el extremo opuesto, China e India‚Äîlos mayores exportadores absolutos del mundo‚Äîtienen comercio exterior representando apenas 37% y 22% de sus PIB respectivamente, porque sus econom√≠as internas son tan masivas que absorben la mayor parte de la producci√≥n dom√©stica. Este patr√≥n revela la paradoja de la globalizaci√≥n: los m√°s globalizados son los m√°s peque√±os y vulnerables; los m√°s grandes pueden permitirse mayor independencia.

Europa muestra patrones mixtos: Europa Occidental aparece consolidada en Cluster 1 (desarrollo avanzado), mientras Europa del Este est√° en transici√≥n entre Cluster 1 y Cluster 2, reflejando cicatrices del comunismo sovi√©tico que persisten 35 a√±os despu√©s del colapso.

Am√©rica Latina exhibe heterogeneidad extrema: Uruguay, Chile y Costa Rica aparecen con indicadores cercanos a pa√≠ses europeos; Brasil, M√©xico, Argentina y Colombia ocupan posiciones intermedias; mientras Honduras, Nicaragua y Hait√≠ permanecen rezagados severamente.

Asia muestra la mayor diversidad del planeta: Jap√≥n y Corea del Sur est√°n en la √©lite global; China e India son gigantes emergentes con desarrollo intermedio; mientras Bangladesh, Myanmar y Afganist√°n enfrentan rezagos cr√≠ticos.

√Åfrica Subsahariana permanece concentrada en Cluster 3 (rezago extremo), con excepciones notables: Botswana, Mauricio y Sud√°frica han logrado desarrollo intermedio mediante pol√≠ticas de gobernanza relativamente s√≥lidas y diversificaci√≥n econ√≥mica.

------------------------------------------------------------------------

# Concluciones

El principal hallazgo es que el desarrollo mundial no funciona de manera lineal ni se puede reducir a una sola caracter√≠stica. Por el contrario, existe un orden invisible que organiza a los pa√≠ses seg√∫n cuatro dimensiones principales que explican m√°s de la mitad de las diferencias que observamos entre ellos.

Estas cuatro dimensiones son: primero, acceso a salud, educaci√≥n y tecnolog√≠a (esperanza de vida, acceso a internet, mortalidad infantil); segundo, tipo de econom√≠a que tiene cada pa√≠s (si depende del petr√≥leo, de la agricultura o de m√∫ltiples industrias); tercero, qu√© tan abierto est√° el pa√≠s al comercio internacional; y cuarto, el equilibrio entre poblaci√≥n y naturaleza (cu√°ntos bosques quedan, cu√°nta presi√≥n hay sobre los recursos naturales).

El an√°lisis identific√≥ tres grupos claros de pa√≠ses: un grupo de pa√≠ses ricos con indicadores muy buenos en salud, educaci√≥n y tecnolog√≠a (Europa, Am√©rica del Norte, Jap√≥n, Corea del Sur); un grupo intermedio de pa√≠ses emergentes que est√°n mejorando pero a√∫n tienen brechas (Brasil, M√©xico, Tailandia, Sud√°frica); y un tercer grupo de pa√≠ses con desaf√≠os estructurales profundos, principalmente en √Åfrica, donde la salud, educaci√≥n y acceso a tecnolog√≠a a√∫n son limitados.

S√≠, el an√°lisis permiti√≥ identificar patrones claros y sorprendentes. Lo m√°s importante es que estos patrones no siguen las l√≠neas geogr√°ficas que esperar√≠amos. Por ejemplo, Uruguay (en Sudam√©rica) se parece m√°s a pa√≠ses europeos del este como Polonia en c√≥mo est√° organizado su desarrollo, mientras que Vietnam (en Asia) comparte caracter√≠sticas similares con Colombia (en Sudam√©rica). Esto muestra que la geograf√≠a no es destino.

Un caso muy revelador es Costa Rica: este pa√≠s tiene una esperanza de vida de 80 a√±os (igual que Alemania o Jap√≥n), pero su PIB per c√°pita es mucho menor. ¬øC√≥mo es posible? Porque Costa Rica invirti√≥ fuertemente en salud y educaci√≥n p√∫blica aunque no fuera el pa√≠s m√°s rico. Esto demuestra que no hay una √∫nica forma de desarrollarse. Algunos pa√≠ses ricos lo lograron por industria, otros por finanzas, otros por turismo y agricultura sostenible.

Tambi√©n descubrimos que algunos pa√≠ses aparentemente exitosos (como Qatar) tienen una fragilidad oculta: sus econom√≠as dependen casi completamente del petr√≥leo. Cuando bajan los precios del petr√≥leo, estos pa√≠ses se hunden. En cambio, pa√≠ses como Singapur o Corea del Sur diversificaron sus econom√≠as y por eso son m√°s estables.

El patr√≥n fundamental que emerge es que los pa√≠ses que logran buen desarrollo son aquellos que invierten simult√°neamente en tres cosas: salud, educaci√≥n, y diversificaci√≥n econ√≥mica. Puede hacerse en diferentes √≥rdenes y con diferentes estrategias, pero estos tres pilares aparecen una y otra vez en los pa√≠ses exitosos del an√°lisis.

Este tipo de an√°lisis tiene aplicaciones concretas y muy pr√°cticas para los gobiernos y organismos internacionales:

Primero, dise√±ar pol√≠ticas adaptadas a cada tipo de pa√≠s. En lugar de que organismos como el Banco Mundial digan a todos los pa√≠ses lo mismo (por ejemplo "reduzcan el gasto p√∫blico"), podr√≠an identificar qu√© tipo de problema tiene cada pa√≠s espec√≠ficamente y dise√±ar soluciones adaptadas. Un pa√≠s con crisis de salud infantil necesita expandir hospitales, no reducir gasto. Un pa√≠s que depende solo del petr√≥leo necesita crear nuevas industrias, no seguir extrayendo m√°s petr√≥leo

Segundo, aprender de pares exitosos en tu propia situaci√≥n. Si Bolivia quiere mejorar su sistema de salud, en lugar de escuchar a expertos europeos, podr√≠a estudiar c√≥mo Costa Rica o Cuba lo hicieron con presupuestos similares. Si Sud√°frica quiere reducir la corrupci√≥n, podr√≠a aprender de Uruguay que lo logr√≥ en contexto latinoamericano similar. Este tipo de aprendizaje entre pares funciona mejor que imposiciones externas.

Tercero, identificar riesgos ocultos antes de que se conviertan en crisis. Los gobiernos y bancos multilaterales podr√≠an usar este an√°lisis para detectar que un pa√≠s se est√° volviendo muy dependiente de una sola industria, o que aunque tenga n√∫meros macroecon√≥micos buenos, su sistema de salud se est√° colapsando. Con esta informaci√≥n temprana, podr√≠an actuar preventivamente.

Cuarto, priorizar inversiones de forma inteligente. Cuando un pa√≠s tiene presupuesto limitado, necesita saber d√≥nde invertir para obtener m√°ximos beneficios. Este an√°lisis muestra que invertir en educaci√≥n y salud simult√°neamente genera un efecto multiplicador: gente m√°s sana estudia mejor, gente educada hace mejores decisiones sobre salud. As√≠ que gastar en ambas cosas a la vez genera m√°s impacto que gastar en una sola.

Quinto, monitorear el progreso hacia objetivos globales. Las Naciones Unidas tienen un conjunto de 17 Objetivos de Desarrollo Sostenible que todos los pa√≠ses deber√≠an alcanzar (acabar pobreza, garantizar salud, educaci√≥n, etc.). Este an√°lisis permite ver objetivamente si un pa√≠s est√° avanzando hacia estos objetivos o se est√° alejando, y cu√°les son sus mayores brechas comparado con pa√≠ses similares.

En conclusi√≥n, este ejercicio acad√©mico prueba que el desarrollo de las naciones es un fen√≥meno complejo que requiere an√°lisis sofisticados, pero una vez que lo entendemos, podemos actuar de manera mucho m√°s efectiva. No existe una sola receta para el √©xito, pero s√≠ existen patrones que se repiten. Los pa√≠ses que tienen √©xito son los que invierten equilibradamente en su gente (salud y educaci√≥n), diversifican su econom√≠a, y toman decisiones conscientes sobre cu√°nto comerciar con el mundo y c√≥mo proteger su ambiente.

Para gobiernos, este an√°lisis es √∫til porque les muestra en qu√© est√°n bien y en qu√© deben mejorar comparados con pa√≠ses similares. Para organismos internacionales, es √∫til porque permite dise√±ar ayuda realmente adaptada a necesidades espec√≠ficas. Y para la sociedad en general, es √∫til porque explica por qu√© algunos pa√≠ses prosperan y otros no‚Äîno es misterio ni destino, sino resultado de decisiones pol√≠ticas concretas que otros pa√≠ses ya han tomado exitosamente.

------------------------------------------------------------------------

# Bibliografia

Acemoglu, D., & Robinson, J. A. (2012). Why nations fail: The origins of power, prosperity, and poverty. Crown Publishers.

Agencia Presidencial de Cooperaci√≥n Internacional de Colombia. (2023). Estrategia Nacional de Cooperaci√≥n Internacional. <https://www.apccolombia.gov.co>

Andini, M., Ciani, E., de Blasio, G., D'Ignazio, A., & Salvestrini, V. (2018a). Targeting with machine learning: An application to a tax rebate program in Italy. Journal of Economic Behavior & Organization, 156, 86-102.

Andini, M., Ciani, E., de Blasio, G., D'Ignazio, A., & Salvestrini, V. (2018b). Targeting policy with machine learning. VoxEU CEPR. <https://voxeu.org/article/targeting-policy-machine-learning>

ArcGIS. (2024). Distancia euclidiana: C√≥mo funciona. Environmental Systems Research Institute. <https://pro.arcgis.com>

Athey, S. (2017). Beyond prediction: Using big data for policy problems. Science, 355(6324), 483-485.

Athey, S., & Imbens, G. W. (2016). Recursive partitioning for heterogeneous causal effects. Proceedings of the National Academy of Sciences, 113(27), 7353-7360.

Banco Interamericano de Desarrollo. (2022). Informe macroecon√≥mico de Am√©rica Latina y el Caribe 2022: El sendero hacia la recuperaci√≥n. BID.

Banco Mundial. (2022). Perspectivas econ√≥micas mundiales 2022: Crisis superpuestas. Grupo Banco Mundial.

Behar, A., & Mok, J. (2024). The World Development Indicators database: Structure, coverage, and quality assurance. World Bank Technical Paper.

Brookings Institution. (2016). Making sense of clusters: Regional competitiveness and economic development. Metropolitan Policy Program.

Centro de Documentaci√≥n de Barcelona. (2022). Econom√≠a global 2022: Perspectivas post-pandemia. CIDOB.

Cervellati, M., Esposito, E., Sunde, U., & Valmori, S. (2022). Long-term growth and demographic change. CEPR Discussion Paper, DP17385.

Charrad, M., Ghazzali, N., Boiteau, V., & Niknafs, A. (2014). NbClust: An R package for determining the relevant number of clusters in a data set. Journal of Statistical Software, 61(6), 1-36.

Ciencia de Datos. (2016). Estandarizaci√≥n de variables: Importancia en machine learning. <https://www.cienciadedatos.net>

Comisi√≥n Econ√≥mica para Am√©rica Latina y el Caribe. (2023). Balance preliminar de las econom√≠as de Am√©rica Latina y el Caribe 2023. CEPAL.

European Central Bank. (2018). Foreign direct investment and economic growth. ECB Economic Bulletin, Issue 4/2018.

Fondo Monetario Internacional. (2023). Perspectivas de la econom√≠a mundial: Resiliencia en tiempos de incertidumbre. FMI.

Fritz, M., & Koch, M. (2016). Economic development and prosperity patterns around the world: Structural challenges for a global steady-state economy. Global Environmental Change, 38, 41-48.

Hastie, T., Tibshirani, R., & Friedman, J. (2009). The elements of statistical learning: Data mining, inference, and prediction (2nd ed.). Springer.

Hidalgo, C. A. (2022). The policy implications of economic complexity. arXiv preprint arXiv:2205.02164.

Jeanty, P. W. (2010). A guide to interpreting the World Development Indicators. World Bank Data Group Working Paper.

Jolliffe, I. T. (2002). Principal component analysis (2nd ed.). Springer.

KeepCoding. (2025). ¬øQu√© es el an√°lisis de componentes principales (PCA)? <https://keepcoding.io/blog/que-es-pca/>

Kim, Y. K. (2017). Patterns of economic development: Correlations affecting economic growth. Korean Journal of Policy Studies, 32(2), 1-24.

Kleinberg, J., Ludwig, J., Mullainathan, S., & Obermeyer, Z. (2015). Prediction policy problems. American Economic Review, 105(5), 491-495.

LinkedIn Learning. (2023). Estandarizaci√≥n y normalizaci√≥n en an√°lisis de datos. <https://www.linkedin.com/learning>

Mullainathan, S., & Spiess, J. (2017). Machine learning: An applied econometric approach. Journal of Economic Perspectives, 31(2), 87-106.

OpenWebinars. (2025). Tutorial de an√°lisis de componentes principales en R. <https://openwebinars.net>

Organizaci√≥n para la Cooperaci√≥n y el Desarrollo Econ√≥micos. (2024). Health at a Glance 2024: OECD indicators. OECD Publishing.

Piketty, T. (2022). Una breve historia de la igualdad. Editorial Planeta.

Programa de las Naciones Unidas para el Desarrollo. (2023). Informe sobre Desarrollo Humano 2023-2024. PNUD.

Sachs, J. D., Lafortune, G., Fuller, G., & Drumm, E. (2022). Sustainable Development Report 2022. Cambridge University Press.

Saraiva, M. V., Ferreira, F. A., Pais, M. C., & Ferreira, N. C. (2025). Clustering analysis on Sustainable Development Goal indicators for forty-five Asian countries. Sustainability, 15(7), 5728.

Shkolnikov, V. M., Andreev, E. M., McKee, M., & Leon, D. A. (2019). Components and possible determinants of the decrease in Russian mortality in 2004-2010. Demographic Research, 28, 917-950.

TIBCO Software. (2024). Ward's hierarchical clustering method. Statistica Documentation. <https://docs.tibco.com>

Conferencia de las Naciones Unidas sobre Comercio y Desarrollo. (2021). Technology and Innovation Report 2021: Catching technological waves. UNCTAD.

Universidad de Granada. (2016). Medidas de similitud y distancia en an√°lisis multivariante. Departamento de Estad√≠stica e Investigaci√≥n Operativa.

Ward, J. H. (1963). Hierarchical grouping to optimize an objective function. Journal of the American Statistical Association, 58(301), 236-244.

Wikipedia. (2013). Ward's method. <https://en.wikipedia.org/wiki/Ward%27s_method>

Wolman, H., & Hincapie, D. (2014). Clusters and cluster-based development policy. Economic Development Quarterly, 29(2), 135-149.

World Bank. (2015). World Development Report 2015: Mind, society, and behavior. World Bank Publications.

World Bank. (2019). World Development Indicators: Methodology and compilation practices. World Bank Data Group.

World Bank. (2023). World Development Indicators 2023. World Bank Open Data. <https://data.worldbank.org>

World Health Organization. (2020). World Health Statistics 2020: Monitoring health for the SDGs. WHO Press.

------------------------------------------------------------------------

::: footer
<strong>Universidad del Valle</strong> \| <em>Facultad de Ingenier√≠a</em> \| Gesti√≥n de Datos<br> Profesor: Orlando Joaqui Barandica \| `r format(Sys.Date(), '%Y')`
:::
