---
title: "Pruebas de texto"
author: "Joan Aguirre"
date: "`r format(Sys.Date(), '%d de %B de %Y')`"
output: 
  html_document:
    theme: flatly
    highlight: textmate
    toc: true
    toc_float: true
    toc_depth: 3
    number_sections: true
    fig_width: 10
    fig_height: 6
    css: styles.css
    code_folding: hide
---

```{=html}
<style type="text/css">
/* Estilos personalizados con texto justificado como Word */
body {
    font-family: 'Times New Roman', Times, serif;
    font-size: 16px;
    line-height: 1.6;
    color: #2c3e50;
    background-color: #fafafa;
    text-align: justify;
    hyphens: auto;
}

.main-container {
    max-width: 1000px;
    margin: 0 auto;
    background: white;
    box-shadow: 0 0 25px rgba(0,0,0,0.08);
    border-radius: 5px;
    overflow: hidden;
    padding: 20px;
}

.header-section {
    background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
    color: white;
    padding: 50px 0;
    margin: -20px -20px 30px -20px;
    text-align: center;
    border-bottom: 5px solid #bdc3c7;
}

.title {
    font-size: 2.8em;
    font-weight: 400;
    margin-bottom: 15px;
    color: white;
    font-family: 'Times New Roman', Times, serif;
    letter-spacing: 1px;
    text-align: center;
}

.subtitle {
    font-size: 1.3em;
    font-weight: 300;
    opacity: 0.95;
    font-style: italic;
    text-align: center;
}

.section {
    padding: 30px 40px;
    border-bottom: 1px solid #ecf0f1;
    text-align: justify;
}

.section:last-child {
    border-bottom: none;
}

h1, h2, h3, h4 {
    color: #2c3e50;
    font-weight: 400;
    text-align: center;
    font-family: 'Times New Roman', Times, serif;
    margin-bottom: 25px;
}

h1 {
    font-size: 2.2em;
    border-bottom: 2px solid #bdc3c7;
    padding-bottom: 15px;
    margin-top: 40px;
    margin-bottom: 30px;
    text-align: center;
}

h2 {
    font-size: 1.8em;
    color: #34495e;
    margin-top: 35px;
    text-align: center;
}

h3 {
    font-size: 1.4em;
    color: #7f8c8d;
    margin-top: 30px;
    text-align: center;
}

p {
    text-align: justify;
    margin: 15px 0;
    line-height: 1.7;
    text-justify: inter-word;
}

.content-block {
    text-align: justify;
    margin: 20px 0;
    line-height: 1.7;
}

.table-container {
    margin: 20px auto;
    text-align: center;
}

.table {
    border-collapse: collapse;
    margin: 25px auto;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    text-align: center;
    font-size: 0.95em;
}

.table th {
    background-color: #34495e;
    color: white;
    padding: 14px 18px;
    text-align: center;
    font-weight: 500;
    border: 1px solid #2c3e50;
}

.table td {
    padding: 12px 16px;
    border: 1px solid #ecf0f1;
    text-align: center;
}

.table tr:nth-child(even) {
    background-color: #f8f9fa;
}

.table tr:hover {
    background-color: #e8f4f8;
}

pre {
    background-color: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 4px;
    padding: 20px;
    font-size: 0.9em;
    text-align: left;
    margin: 25px auto;
    max-width: 90%;
}

.code {
    background-color: #f8f9fa;
    padding: 3px 8px;
    border-radius: 3px;
    font-family: 'Courier New', monospace;
    font-size: 0.9em;
    border: 1px solid #e9ecef;
}

.blockquote {
    border-left: 4px solid #bdc3c7;
    padding: 20px 30px;
    margin: 30px 0;
    font-style: italic;
    color: #7f8c8d;
    background-color: #f8f9fa;
    text-align: justify;
    border-radius: 0 5px 5px 0;
    border-left: 5px solid #3498db;
}

.footer {
    text-align: center;
    padding: 40px;
    background-color: #2c3e50;
    color: white;
    margin-top: 40px;
    margin: 30px -20px -20px -20px;
    font-size: 0.95em;
}

.footer p {
    text-align: center;
    margin: 8px 0;
}

/* Estilos para gráficos y figuras */
.figure {
    text-align: center;
    margin: 35px auto;
    display: block;
}

.caption {
    font-style: italic;
    color: #7f8c8d;
    margin-top: 12px;
    text-align: center;
    font-size: 0.95em;
}

/* Listas justificadas */
ul, ol {
    text-align: justify;
    margin: 20px 0;
    padding-left: 40px;
}

li {
    margin: 12px 0;
    line-height: 1.7;
    text-align: justify;
}

li p {
    text-align: justify;
}

/* Mejoras para la tabla de contenidos */
#TOC {
    text-align: left;
    margin: 20px auto;
    display: inline-block;
}

.toc-content {
    text-align: justify;
}

.highlight-section {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-left: 5px solid #3498db;
    padding: 25px;
    margin: 25px 0;
    text-align: justify;
    border-radius: 5px;
}

/* Estilo para párrafos con sangría como en Word */
.indented {
    text-indent: 2em;
    text-align: justify;
}

/* Justificación mejorada */
.justified-text {
    text-align: justify;
    text-justify: inter-word;
    line-height: 1.7;
}
</style>
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  message = FALSE,
  fig.align = "center",
  fig.width = 10,
  fig.height = 6,
  out.width = "90%"
)
library(gt)
library(ggplot2)
library(dplyr)
library(knitr)
library(DT)
library(tidyverse)
```

# Introducción

En el corazón de la economía global existe una paradoja fundamental: mientras que algunos indicadores sugieren una relación lineal y predecible entre el desarrollo económico y el bienestar social, la realidad es mucho más compleja y matizada. Tomemos un ejemplo: Costa Rica tiene una esperanza de vida comparable a la de países europeos desarrollados, pero con un PIB per cápita significativamente menor; Qatar, por su parte, lidera en PIB per cápita pero no encabeza necesariamente en todos los indicadores de bienestar social (Shkolnikov et al., 2019). Estas "anomalías" no son excepciones sino revelaciones de una verdad fundamental: el desarrollo no es unidimensional.

El problema central que motiva este trabajo es fundamental: ¿Cuáles son realmente los "tipos" de desarrollo que caracterizan la economía mundial cuando se analiza simultáneamente un conjunto amplio de 17 indicadores económicos, sociales, tecnológicos y ambientales? No se trata de responder cuál país es más "rico", sino algo más profundo: descubrir si existen estructuras ocultas en los datos que agrupen países con perfiles similares más allá de la geografía o las clasificaciones convencionales. Específicamente, la pregunta es: ¿Colombia y Uruguay podrían compartir más similitudes con algunos países asiáticos que con sus propios vecinos latinoamericanos? ¿Existe realmente un "grupo de países con baja renta pero alto acceso tecnológico"? ¿Las características ambientales y demográficas se alinean con la riqueza económica o presentan patrones independientes?

Históricamente, el desarrollo internacional se ha medido mediante indicadores aislados. El PIB per cápita domina los rankings; la esperanza de vida se analiza independientemente; la conectividad digital se observa separadamente. Este enfoque fragmentado es problemático porque el desarrollo no es unidimensional: un país puede ser económicamente exitoso pero frágil en salud pública, o tener excelente conectividad digital pero vulnerabilidad ambiental crítica (Jolliffe, 2002; World Bank, 2023). Los datos del año 2022 capturan un momento único en la historia económica global: post-pandemia de COVID-19, con efectos heterogéneos según país. Algunos recuperaron rápidamente su dinamismo; otros enfrentaron cicatrices estructurales persistentes en empleo, salud y finanzas públicas (World Bank, 2023).

El Banco Mundial proporciona 17 indicadores reconocidos internacionalmente que miden dimensiones distintas: factores económicos (PIB per cápita, crecimiento del PIB, inversión extranjera, remesas, industria, comercio), indicadores de salud y bienestar (esperanza de vida, mortalidad infantil, gasto en salud), variables de conectividad tecnológica (acceso a electricidad, uso de internet, suscripciones móviles) y aspectos ambientales y demográficos (área boscosa, tierra cultivable, crecimiento poblacional) (World Bank, 2023). Analizar estas 17 variables de forma independiente genera ruido; analizarlas de manera integrada puede revelar patrones coherentes que informan políticas públicas, estrategias de cooperación internacional y decisiones de inversión.

El desafío es modelar una pregunta sin respuesta predefinida: ¿Qué agrupamientos naturales de países emergen cuando se analiza simultáneamente esta multiplicidad de indicadores? Este es precisamente el rol del aprendizaje no supervisado—un conjunto de técnicas que descubren patrones en datos sin etiquetas previas, sin clasificaciones arbitrarias impuestas externamente (Charrad et al., 2014; Jolliffe, 2002).

Lo que sigue es una cartografía multidimensional de la economía global en el contexto post-pandemia: no solo se responde "¿en qué grupos se dividen los países?", sino, más profundamente, "¿qué revelan estos grupos sobre mecanismos reales del desarrollo, oportunidades compartidas, restricciones comunes y trayectorias viables para diferentes sociedades?" Los resultados no serán una clasificación administrativa sino un descubrimiento empírico basado en lo que los datos de 180 países en 2022 efectivamente revelan.

# Metodologia

## Base de datos

La base de datos utilizada en este análisis proviene de la compilación World Development Indicators (WDI) del Banco Mundial, considerada la principal fuente internacional de estadísticas comparables sobre desarrollo económico y social (World Bank, 2023). Los WDI representan el esfuerzo más comprehensivo del Banco Mundial para consolidar indicadores de desarrollo de fuentes oficialmente reconocidas, incluyendo oficinas nacionales de estadística, bancos centrales, agencias de las Naciones Unidas, instituciones de investigación y contribuyentes del sector privado (World Bank, 2023; Jeanty, 2010).

La base WDI contiene aproximadamente 1,600 indicadores de series temporales para 217 economías y más de 40 grupos de países, con datos para muchos indicadores que se remontan más de 50 años (World Bank, 2023). Los datos son compilados mediante metodologías estandarizadas que garantizan comparabilidad internacional, transparencia metodológica y robustez estadística (World Bank, 2019). El proceso de selección de indicadores del WDI sigue cuatro criterios fundamentales: facilidad de uso (accesibilidad y claridad para usuarios diversos), confiabilidad (reputación y credibilidad de la fuente), cobertura (amplitud geográfica y temporal), y calidad (rigor metodológico y precisión) (Behar & Mok, 2024).

Para este análisis, se filtro información exclusivamente para países individuales (eliminando bloques regionales o agrupaciones económicas) del año 2022. El dataset resultante contiene aproximadamente 180-200 países, según la disponibilidad de datos completos, donde cada observación representa una unidad soberana comparable en un único punto temporal.

El año 2022 marca un punto de inflexión crítico en la economía global, representa el momento post-pandemia en que las trayectorias de recuperación de cada país se hacen visibles y diferenciadas. Mientras algunos países desarrollados con capacidad fiscal recuperaron o superaron niveles pre-COVID-19, economías emergentes enfrentaban cicatrices estructurales persistentes en empleo, inflación descontrolada, y aumento de deuda pública (Banco Mundial, 2022; FMI, 2023; CEPAL, 2023). La desigualdad global se amplió drásticamente: el crecimiento proyectado para América Latina en 2022 era apenas 2.6%, mientras la desigualdad de ingresos aumentó significativamente después de dos décadas de mejoras (BID, 2022).

En este contexto, 2022 funciona como un "revelador" excepcional de vulnerabilidades y fortalezas estructurales subyacentes de los países: aquellos con sistemas de salud robustos, infraestructura tecnológica consolidada y economías diversificadas mostraron resiliencia; los que enfrentaban fragilidades estructurales experimentaron impactos persistentes (Banco Mundial, 2022; CIDOB, 2022). Por tanto, 2022 es un año extraordinariamente informativo para identificar perfiles reales de desarrollo, ya que las diferencias entre países se magnificaron visiblemente, permitiendo observar no clasificaciones arbitrarias sino estructuras auténticas de capacidad nacional.

## Descripción de las variables

El dataset construido para este análisis integra 17 variables cuantitativas que capturan las múltiples dimensiones del desarrollo contemporáneo. Estas variables se organizan en cinco áreas temáticas que, en conjunto, ofrecen una perspectiva comprehensiva del desempeño socioeconómico, tecnológico y ambiental de cada país. A continuación, se presenta una descripción detallada de cada variable según su área temática.

### Dimensión economica

La inclusión de variables económicas es fundamental porque el desarrollo ha sido históricamente conceptualizado como un proceso de transformación estructural impulsado por el crecimiento económico (World Bank, 2023; Piketty, 2022). Sin embargo, el crecimiento económico no es unidimensional: requiere tanto un nivel absoluto de riqueza (PIB per cápita) como dinamismo y expansión (crecimiento del PIB), diversificación productiva (industria), y capacidad de atracción de inversión internacional (IED) que transfiera conocimiento y capital (ECB, 2018). Además, las economías contemporáneas están integradas globalmente, por lo que exportaciones, importaciones y remesas son transmisores clave de oportunidades y vulnerabilidades económicas (World Bank, 2023)., en la tabla 1 las observamos.

```{r Variables economicas}
variables_economicas <- data.frame(
  Variable = c(
    "PIB per cápita (US$)",
    "Crecimiento del PIB (% anual)",
    "Inversión extranjera directa (% PIB)",
    "Remesas recibidas (% PIB)",
    "Industria (% PIB)",
    "Exportaciones (% PIB)",
    "Importaciones (% PIB)"
  ),
  
  Descripción = c(
    "PIB dividido por población, en dólares corrientes. Indicador principal del nivel de ingreso y producción económica por persona.",
    "Tasa de variación anual del PIB en precios constantes. Refleja la expansión o contracción económica de un país.",
    "Flujos netos de inversión con interés gerencial duradero. Fuente crucial de financiamiento externo y transferencia tecnológica.",
    "Transferencias personales de migrantes que trabajan en el extranjero. Flujo financiero clave para muchas economías en desarrollo.",
    "Valor agregado del sector industrial. Refleja el grado de industrialización y la estructura productiva de una economía.",
    "Valor de bienes y servicios vendidos al exterior. Mide el grado de apertura comercial y oportunidades de crecimiento.",
    "Valor de bienes y servicios comprados al exterior. Indica la dependencia de la economía respecto al comercio internacional."
  ),
  
  Interpretación = c(
    ">20,000 USD: economía desarrollada\n5,000-20,000 USD: economía emergente\n<5,000 USD: economía en desarrollo",
    ">3%: crecimiento robusto\n0-3%: crecimiento moderado\n<0%: recesión económica",
    ">5%: alta atracción de IED\n2-5%: nivel moderado\n<2%: baja atracción de inversión",
    ">10%: alta dependencia\n2-10%: contribución significativa\n<2%: impacto limitado",
    ">30%: economía industrializada\n20-30%: sector industrial sólido\n<20%: base industrial reducida", 
    ">50%: economía muy abierta\n30-50%: apertura moderada\n<30%: economía relativamente cerrada",
    ">40%: alta dependencia importaciones\n25-40%: nivel moderado\n<25%: autosuficiencia relativa"
  )
)

tabla_1 <- variables_economicas %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 1**"),
    subtitle = "Variables Macroeconómicas y su Interpretación"
  ) %>%
  cols_label(
    Variable = md("**Variable**"),
    Descripción = md("**Descripción**"),
    Interpretación = md("**Interpretación**")
  ) %>%
  cols_align(
    align = "left",
    columns = everything()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium"),
      cell_fill(color = "white")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "black",
      weight = px(1)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "gray80",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Variable, Descripción))
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = Variable)
  ) %>%
  tab_style(
    style = cell_text(size = "small"),
    locations = cells_body(columns = c(Descripción, Interpretación))
  ) %>%
  tab_options(
    table.font.names = "Times New Roman",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "none",
    column_labels.border.bottom.width = px(2),
    column_labels.border.bottom.color = "black",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    data_row.padding = px(8),
    heading.title.font.size = 14,
    heading.subtitle.font.size = 12,
    heading.padding = px(4),
    footnotes.padding = px(4)
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboración propia con base en World Bank (2023), UN (2015), ECB (2018)")
  ) %>%
  tab_footnote(
    footnote = "Los umbrales de interpretación son referenciales y pueden variar según el contexto regional y temporal",
    locations = cells_title(groups = "subtitle")
  )

tabla_1
```

### Dimension de salud y bienestar

La inclusión de variables sanitarias responde a que el desarrollo no es puramente económico sino que debe reflejarse en mejoras sustantivas en la calidad de vida, particularmente en indicadores de salud poblacional (Sachs et al., 2022; World Bank, 2023). La esperanza de vida es considerada por organismos internacionales como el indicador sintético más robusto de desarrollo humano, capturando tanto el acceso a servicios de salud como condiciones generales de vida (OECD, 2024). La mortalidad infantil es particularmente sensible a la calidad del sistema sanitario, y el gasto en salud refleja el esfuerzo institucional de un país por asegurar bienestar poblacional (World Bank, 2023)., en la tabla 2 las observamos.

```{r Variables bienestar}

variables_salud <- data.frame(
  Variable = c(
    "Esperanza de vida al nacer (años)",
    "Mortalidad infantil (por cada 1,000 nacidos vivos)",
    "Gasto en salud (% del PIB)"
  ),
  
  Descripción = c(
    "Número promedio de años que se espera que viva un recién nacido si los patrones de mortalidad prevalecientes al momento de su nacimiento permanecen constantes a lo largo de su vida. Es uno de los indicadores más robustos para medir el estado de salud poblacional, reflejando la calidad del sistema sanitario, acceso a servicios médicos, condiciones de vida, nutrición y factores ambientales.",
    "Número de muertes de niños menores de un año por cada 1,000 nacimientos vivos. Es un indicador sensible de la calidad de atención sanitaria materno-infantil, condiciones sanitarias, acceso a agua potable y nutrición adecuada, funcionando como proxy de desarrollo social y capacidad institucional del sistema de salud.",
    "Gasto corriente en salud expresado como porcentaje del PIB, incluyendo tanto gasto público como privado. Refleja la prioridad presupuestaria que un país asigna al sector salud y su capacidad de financiar infraestructura sanitaria, siendo un determinante clave de resultados de salud poblacional."
  ),
  
  Interpretación = c(
    ">75 años: salud poblacional avanzada\n70-75 años: nivel medio de desarrollo sanitario\n<70 años: desafíos significativos en salud pública",
    "<10: excelentes condiciones sanitarias\n10-25: condiciones moderadas\n>25: necesidades críticas en salud infantil",
    ">8%: alta prioridad en salud\n5-8%: compromiso moderado\n<5%: recursos sanitarios limitados"
  )
)

tabla_2 <- variables_salud %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 2**"),
    subtitle = "Indicadores de Salud Pública y su Interpretación"
  ) %>%
  cols_label(
    Variable = md("**Variable**"),
    Descripción = md("**Descripción**"),
    Interpretación = md("**Interpretación**")
  ) %>%
  cols_align(
    align = "left",
    columns = everything()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium"),
      cell_fill(color = "white")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "black",
      weight = px(1)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "gray80",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Variable, Descripción))
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = Variable)
  ) %>%
  tab_style(
    style = cell_text(size = "small"),
    locations = cells_body(columns = c(Descripción, Interpretación))
  ) %>%
  tab_options(
    table.font.names = "Times New Roman",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "none",
    column_labels.border.bottom.width = px(2),
    column_labels.border.bottom.color = "black",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    data_row.padding = px(8),
    heading.title.font.size = 14,
    heading.subtitle.font.size = 12,
    heading.padding = px(4),
    footnotes.padding = px(4)
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboración propia con base en WHO (2020), OECD (2024), World Bank (2023)")
  ) %>%
  tab_footnote(
    footnote = "Los umbrales de interpretación son referenciales y pueden variar según el contexto regional y nivel de desarrollo",
    locations = cells_title(groups = "subtitle")
  ) %>%
  tab_style(
    style = cell_text(whitespace = "normal"),
    locations = cells_body()
  )

tabla_2

```

### Dimension tecnologica y de conectividad

La inclusión de variables tecnológicas es justificada por la importancia creciente de la transformación digital en el desarrollo contemporáneo (UNCTAD, 2021; World Bank, 2023). La acceso a electricidad, internet y telefonía móvil no son lujos sino infraestructuras esenciales que habilitan participación en la economía del conocimiento, acceso a información, servicios financieros y oportunidades económicas (UNCTAD, 2021). La brecha digital ha emergido como una nueva dimensión de desigualdad internacional, donde países con penetración digital menor enfrentan desventajas competitivas significativas (World Bank, 2023)., en la tabla 3 las observamos.

```{r Variables tecnologicas}
variables_tecnologia <- data.frame(
  Variable = c(
    "Acceso a electricidad (% de la población)",
    "Uso de internet (% de la población)",
    "Suscripciones móviles (por cada 100 personas)"
  ),
  
  Descripción = c(
    "Porcentaje de la población con acceso a electricidad. Indicador fundamental de infraestructura energética básica, condición necesaria para actividad económica moderna, educación, salud y conectividad digital.",
    "Porcentaje de individuos que han utilizado internet en los últimos 3 meses. Proxy de conectividad digital, acceso a información, y participación en la economía del conocimiento, siendo cada vez más relevante para productividad económica y reducción de brechas informativas.",
    "Número de suscripciones a servicios de telefonía celular móvil por cada 100 habitantes. Refleja la penetración de tecnología móvil, que ha sido un vector fundamental de inclusión digital y acceso a servicios financieros en economías en desarrollo."
  ),
  
  Interpretación = c(
    ">95%: cobertura eléctrica universal\n80-95%: acceso extendido\n<80%: déficit significativo de infraestructura",
    ">70%: sociedad digitalmente integrada\n30-70%: adopción media de internet\n<30%: brecha digital significativa",
    ">100: alta penetración móvil\n80-100: cobertura adecuada\n<80: oportunidades de expansión del mercado"
  )
)

tabla_3 <- variables_tecnologia %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 3**"),
    subtitle = "Indicadores de Infraestructura y Tecnología"
  ) %>%
  cols_label(
    Variable = md("**Variable**"),
    Descripción = md("**Descripción**"),
    Interpretación = md("**Interpretación**")
  ) %>%
  cols_align(
    align = "left",
    columns = everything()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium"),
      cell_fill(color = "white")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "black",
      weight = px(1)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "gray80",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Variable, Descripción))
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = Variable)
  ) %>%
  tab_style(
    style = cell_text(size = "small"),
    locations = cells_body(columns = c(Descripción, Interpretación))
  ) %>%
  tab_options(
    table.font.names = "Times New Roman",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "none",
    column_labels.border.bottom.width = px(2),
    column_labels.border.bottom.color = "black",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    data_row.padding = px(8),
    heading.title.font.size = 14,
    heading.subtitle.font.size = 12,
    heading.padding = px(4),
    footnotes.padding = px(4)
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboración propia con base en World Bank (2023)")
  ) %>%
  tab_footnote(
    footnote = "Los valores superiores a 100 en suscripciones móviles indican múltiples suscripciones por persona",
    locations = cells_body(
      rows = 3,
      columns = Interpretación
    )
  ) %>%
  tab_footnote(
    footnote = "Los umbrales de interpretación son referenciales y pueden variar según el nivel de desarrollo regional",
    locations = cells_title(groups = "subtitle")
  )

tabla_3

```

### Dimension ambiental y de recursos

La inclusión de variables ambientales responde al creciente reconocimiento de que el desarrollo sostenible debe integrar consideraciones ecológicas (PNUD, 2023; World Bank, 2023). Aunque el crecimiento económico tradicional ha sido alcanzado frecuentemente mediante degradación ambiental, la sostenibilidad del desarrollo requiere preservación de capital natural, particularmente bosques (para captura de carbono y biodiversidad) y tierra cultivable (para seguridad alimentaria) (PNUD, 2023; World Bank, 2023), en la tabla 4 las vemos.

```{r Variables ambiental}
variables_ambientales <- data.frame(
  Variable = c(
    "Área boscosa (% del área terrestre)",
    "Tierra cultivable (% del área terrestre)"
  ),
  
  Descripción = c(
    "Porcentaje del territorio nacional cubierto por bosques. Es un indicador de conservación ambiental, biodiversidad y sostenibilidad, siendo relevante tanto para mitigación del cambio climático como para servicios ecosistémicos.",
    "Porcentaje de tierra apta para cultivos agrícolas. Refleja el potencial agrícola y la base de recursos naturales para producción de alimentos, siendo particularmente relevante para economías con sectores agrícolas significativos."
  ),
  
  Interpretación = c(
    ">30%: alta cobertura forestal\n15-30%: cobertura media\n<15%: deforestación significativa",
    ">20%: alta disponibilidad agrícola\n10-20%: capacidad moderada\n<10%: limitaciones para agricultura"
  )
)

tabla_4 <- variables_ambientales %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 4**"),
    subtitle = "Indicadores Ambientales y de Uso de la Tierra"
  ) %>%
  cols_label(
    Variable = md("**Variable**"),
    Descripción = md("**Descripción**"),
    Interpretación = md("**Interpretación**")
  ) %>%
  cols_align(
    align = "left",
    columns = everything()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium"),
      cell_fill(color = "white")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "black",
      weight = px(1)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "gray80",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Variable, Descripción))
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = Variable)
  ) %>%
  tab_style(
    style = cell_text(size = "small"),
    locations = cells_body(columns = c(Descripción, Interpretación))
  ) %>%
  tab_options(
    table.font.names = "Times New Roman",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "none",
    column_labels.border.bottom.width = px(2),
    column_labels.border.bottom.color = "black",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    data_row.padding = px(8),
    heading.title.font.size = 14,
    heading.subtitle.font.size = 12,
    heading.padding = px(4),
    footnotes.padding = px(4)
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboración propia con base en World Bank (2023)")
  ) %>%
  tab_footnote(
    footnote = "Los servicios ecosistémicos incluyen regulación hídrica, conservación de biodiversidad y secuestro de carbono",
    locations = cells_body(
      rows = 1,
      columns = Descripción
    )
  ) %>%
  tab_footnote(
    footnote = "La tierra cultivable incluye tierras arables, cultivos permanentes y pastos permanentes",
    locations = cells_body(
      rows = 2,
      columns = Descripción
    )
  ) %>%
  tab_footnote(
    footnote = "Los umbrales de interpretación pueden variar según las características geográficas y ecológicas de cada región",
    locations = cells_title(groups = "subtitle")
  )

tabla_4


```

### Dimension demografica

La inclusión de variables demográficas es justificada porque la dinámica poblacional condiciona fundamentalmente los desafíos y oportunidades de desarrollo: presión sobre recursos, mercado laboral, demanda por servicios públicos, y sostenibilidad fiscal (CEPAL, 2023; World Bank, 2023). Países con crecimiento poblacional acelerado enfrentan distintos desafíos que aquellos con envejecimiento poblacional, impactando tasas de ahorro, inversión, y provisión de servicios (CEPAL, 2023), vemos las variables en la tabla 5.

```{r Variables demograficas}
variables_demograficas <- data.frame(
  Variable = c(
    "Población total",
    "Crecimiento poblacional (% anual)"
  ),
  
  Descripción = c(
    "Número total de habitantes de un país a mitad de año. El tamaño poblacional determina tanto el mercado interno como la escala de demanda por servicios públicos y recursos naturales.",
    "Tasa de variación porcentual anual de la población. Refleja la presión demográfica y sus implicaciones para sostenibilidad, mercados laborales, y provisión de servicios públicos."
  ),
  
  Interpretación = c(
    ">100M: país muy poblado\n10-100M: población media\n<10M: país poco poblado",
    ">2%: crecimiento rápido\n0.5-2%: crecimiento moderado\n<0.5%: crecimiento lento"
  )
)

tabla_5 <- variables_demograficas %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 5**"),
    subtitle = "Indicadores Demográficos Básicos"
  ) %>%
  cols_label(
    Variable = md("**Variable**"),
    Descripción = md("**Descripción**"),
    Interpretación = md("**Interpretación**")
  ) %>%
  cols_align(
    align = "left",
    columns = everything()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium"),
      cell_fill(color = "white")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "black",
      weight = px(1)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "gray80",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Variable, Descripción))
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = Variable)
  ) %>%
  tab_style(
    style = cell_text(size = "small"),
    locations = cells_body(columns = c(Descripción, Interpretación))
  ) %>%
  tab_options(
    table.font.names = "Times New Roman",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "none",
    column_labels.border.bottom.width = px(2),
    column_labels.border.bottom.color = "black",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    data_row.padding = px(8),
    heading.title.font.size = 14,
    heading.subtitle.font.size = 12,
    heading.padding = px(4),
    footnotes.padding = px(4)
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboración propia con base en World Bank (2023)")
  ) %>%
  tab_footnote(
    footnote = "La población se refiere a residentes totales independientemente de su estatus legal o ciudadanía",
    locations = cells_body(
      rows = 1,
      columns = Descripción
    )
  ) %>%
  tab_footnote(
    footnote = "El crecimiento poblacional incluye nacimientos, muertes y migración neta",
    locations = cells_body(
      rows = 2,
      columns = Descripción
    )
  ) %>%
  tab_footnote(
    footnote = "Los umbrales de interpretación son referenciales y pueden variar según el contexto regional y nivel de desarrollo",
    locations = cells_title(groups = "subtitle")
  )

tabla_5
```

## Base de datos del modelo

A continuacion, se muestra la base de datos que se usara para el modelo de aprendizaje no supervisado.

```{r Base de datos, warning=FALSE,message=FALSE}
Base_2022 <- read_csv("f36a5086-3311-4b1a-9f0c-bda5cd4718df_Series - Metadata.csv",
                 show_col_types = FALSE) %>%
  select(
    Pais = `Country Name`,
    Codigo = `Country Code`,
    PIB_per = `GDP per capita (current US$) [NY.GDP.PCAP.CD]`,
    Poblacion = `Population, total [SP.POP.TOTL]`,
    `Esperanza vida` = `Life expectancy at birth, total (years) [SP.DYN.LE00.IN]`,
    `Acceso electricidad` = `Access to electricity (% of population) [EG.ELC.ACCS.ZS]`,
    `Area boscosa` = `Forest area (% of land area) [AG.LND.FRST.ZS]`,
    `Suscripciones movil` = `Mobile cellular subscriptions (per 100 people) [IT.CEL.SETS.P2]`,
    `Crecimiento PIB` = `GDP growth (annual %) [NY.GDP.MKTP.KD.ZG]`,
    `Mortalidad infantil` = `Mortality rate, infant (per 1,000 live births) [SP.DYN.IMRT.IN]`,
    `Inversion extranjera` = `Foreign direct investment, net inflows (% of GDP) [BX.KLT.DINV.WD.GD.ZS]`,
    `Gasto salud` = `Current health expenditure (% of GDP) [SH.XPD.CHEX.GD.ZS]`,
    `Uso internet` = `Individuals using the Internet (% of population) [IT.NET.USER.ZS]`,
    Importaciones = `Imports of goods and services (% of GDP) [NE.IMP.GNFS.ZS]`,
    Exportaciones = `Exports of goods and services (% of GDP) [NE.EXP.GNFS.ZS]`,
    `Tierra cultivable` = `Arable land (% of land area) [AG.LND.ARBL.ZS]`,
    `Crecimiento poblacion` = `Population growth (annual %) [SP.POP.GROW]`,
    Industria = `Industry (including construction), value added (% of GDP) [NV.IND.TOTL.ZS]`,
    Remesas = `Personal remittances, received (% of GDP) [BX.TRF.PWKR.DT.GD.ZS]`
  )%>%
  filter(!Pais %in% c("World", "High income", "Low income", "European Union",
                      "Latin America & Caribbean", "Middle income", "OECD members",
                      "East Asia & Pacific", "Sub-Saharan Africa", "South Asia",
                      "North America", "Euro area", "Arab World", "West Bank and Gaza",
                      "Lower middle income", "Upper middle income", 
                      "Least developed countries: UN classification",
                      "Fragile and conflict affected situations", 
                      "Heavily indebted poor countries (HIPC)",
                      "IDA total", "Low & middle income", "Middle East & North Africa",
                      "Pacific island small states", "Small states", 
                      "Caribbean small states", "Other small states", 
                      "IDA & IBRD total", "IDA only", "IBRD only",
                      "Pre-demographic dividend", "Post-demographic dividend", 
                      "Early-demographic dividend", "Late-demographic dividend")) %>% 
  mutate(across(3:19, as.numeric)) %>% drop_na()%>% 
  filter(Pais != c( "Luxembourg","	Uruguay", "Angola","Jordan","Belize")) %>% 
  filter(Codigo != "BLZ",Codigo!="JOR",Codigo!="URY")


tabla_inicial <- datatable(
  Base_2022,
  extensions = c('Buttons', 'Scroller', 'Responsive', 'FixedHeader'),
  options = list(
    dom = '<"top"lBf>rt<"bottom"ip><"clear">',
    buttons = list(
      list(extend = 'copy', text = 'Copiar', className = 'btn-outline-primary'),
      list(extend = 'csv', text = 'CSV', className = 'btn-outline-secondary'),
      list(extend = 'excel', text = 'Excel', className = 'btn-outline-success'),
      list(extend = 'pdf', text = 'PDF', className = 'btn-outline-danger'),
      list(extend = 'print', text = 'Imprimir', className = 'btn-outline-warning')
    ),
    pageLength = 12,
    lengthMenu = list(c(8, 12, 20, 50, -1), 
                     c('8', '12', '20', '50', 'Todos')),
    scrollX = TRUE,
    scrollY = "550px",
    scroller = TRUE,
    deferRender = TRUE,
    language = list(
      url = '//cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json',
      search = "Buscar:",
      lengthMenu = "Mostrar _MENU_ registros",
      info = "_START_ - _END_ de _TOTAL_",
      paginate = list(
        first = "Primero",
        last = "Último",
        `next` = "Siguiente",
        previous = "Anterior"
      )
    ),
    autoWidth = TRUE,
    fixedHeader = TRUE,
    searchHighlight = TRUE
  ),
  rownames = FALSE,
  filter = 'top',
  class = c('display', 'compact', 'hover'),
  caption = 'Indicadores Económicos y Sociales Globales 2022'
) %>%
  formatCurrency(
    columns = 'PIB_per', 
    currency = "$", 
    digits = 0,
    before = TRUE
  ) %>%
  formatRound(
    columns = 'Poblacion', 
    digits = 0,
    mark = ","
  ) %>%
  formatRound(
    columns = c('Esperanza vida', 'Acceso electricidad', 'Area boscosa',
               'Suscripciones movil', 'Crecimiento PIB', 'Inversion extranjera', 
               'Gasto salud', 'Uso internet', 'Importaciones', 'Exportaciones', 
               'Tierra cultivable', 'Crecimiento poblacion', 'Industria', 'Remesas'), 
    digits = 2
  ) %>%
  formatRound(
    columns = 'Mortalidad infantil',
    digits = 1
  ) %>%
  formatStyle(
    columns = names(Base_2022),
    fontSize = '12px',
    fontFamily = 'Arial, sans-serif'
  ) %>%
  formatStyle(
    columns = names(Base_2022),
    target = 'cell',
    fontWeight = 'bold'
  )  


tabla_inicial

```

## Descripción del modelo

La implementación del análisis se estructura en cuatro etapas secuenciales, cada una construida sobre los resultados de la anterior, garantizando que la información y patrones descubiertos se preserven y amplifiquen a través del pipeline de análisis.

### Preparación y Estandarización de Datos

Previo a cualquier análisis multivariado, es fundamental estandarizar las variables originales para garantizar que todas contribuyan en igualdad de condiciones al cálculo de componentes principales (KeepCoding, 2025). La estandarización se realizó mediante la transformación z-score: $Z_i = \frac{X_i - \mu_i}{\sigma_i}$ donde $Z_i$ es la variable estandarizada, $X_i$ la variable original, $\mu_i$ la media y $\sigma_i$ la desviación estándar.

Esta estandarización es crítica porque el análisis de componentes principales se fundamenta en la varianza de los datos: sin estandarizar, variables con escalas numéricas mayores (como población total en millones) dominarían el cálculo de componentes, distorsionando la interpretación y otorgando influencia desproporcionada a magnitudes en lugar de patrones (LinkedIn, 2023; Ciencia de Datos, 2016). Adicionalmente, la estandarización garantiza que el análisis capture relaciones entre variables y no simplemente diferencias en escala.

### Análisis de Componentes Principales (ACP)

Con las 17 variables estandarizadas, se aplica el Análisis de Componentes Principales para transformar el conjunto de variables originales, potencialmente correlacionadas, en un conjunto menor de componentes principales ortogonales (Jolliffe, 2002; OpenWebinars, 2025). El ACP identifica las direcciones en el espacio de datos donde la varianza es máxima, creando nuevas dimensiones (componentes) que son combinaciones lineales ponderadas de las variables originales (Jolliffe, 2002; KeepCoding, 2025).

Matemáticamente, el ACP comienza construyendo la matriz de covarianza $C$ de las variables estandarizadas, cuyas entradas representan cómo varían conjuntamente pares de variables (KeepCoding, 2025). Los vectores propios de esta matriz de covarianza definen las direcciones principales (componentes), ordenados según sus correspondientes valores propios, que representan la cantidad de varianza explicada en cada dirección (Jolliffe, 2002). El primer componente principal captura la máxima varianza; el segundo, la máxima varianza restante sujeto a ortogonalidad respecto al primero; y así sucesivamente (Jolliffe, 2002).

El criterio para determinar el número óptimo de componentes se basó en el principio de parsimonia, buscando maximizar la reducción dimensional manteniendo una representación significativa de la estructura original de los datos.

### Cálculo de Distancias Euclidianas

Una vez obtenidos los componentes principales, se utiliza la distancia euclidiana como métrica de disimilaridad entre países. Para cada par de países, la distancia euclidiana se calcula como:

$$ d_{ij} = \sqrt{\sum_{k=1}^{p} (PC_{ik} - PC_{jk})^2} $$ Donde:

-   $d_{ij}$ = Distancia euclidiana entre los países $i$ y $j$
-   $p$ = Número de componentes principales utilizados
-   $PC_{ik}$ = Valor del $k$-ésimo componente principal para el país $i$
-   $PC_{jk}$ = Valor del $k$-ésimo componente principal para el país $j$

Esta distancia mide la proximidad multidimensional entre países: distancias pequeñas indican perfiles similares, distancias grandes indican disimilaridad (Universidad de Granada, 2016; ArcGIS, 2024).

La distancia euclidiana es particularmente apropiada para el método de Ward porque, en su implementación aglomerativa, se utiliza el cuadrado de la distancia euclidiana—formalmente conocida como "distancia euclidiana semicuadrada"—como medida de disimilaridad (Ward, 1963; Wikipedia, 2013; TIBCO, 2024).

### Clusterización Jerárquica Aglomerativa con Método de Ward

Tras la reducción dimensional mediante Análisis de Componentes Principales, se aplicó una clusterización jerárquica aglomerativa mediante el método de Ward sobre las coordenadas de los países en el espacio reducido de k componentes principales. Esta estrategia metodológica aplicar clustering sobre componentes principales en lugar de variables originales estándar en análisis multivariado porque ofrece ventajas técnicas significativas: elimina multicolinealidad entre variables, asegurando que cada componente captura variabilidad independiente; reduce ruido estadístico al descartar componentes posteriores que explican varianza residual mínima; mejora la estabilidad numérica del algoritmo de clustering al trabajar con matrices de dimensionalidad reducida.

El método de Ward es un algoritmo jerárquico aglomerativo que opera iterativamente sobre el conjunto de observaciones para formar una jerarquía de clusters. El procedimiento inicia considerando cada país como un cluster individual independiente, creando aproximadamente 180 grupos iniciales. En cada iteración subsecuente, el algoritmo identifica el par de clusters más próximos y los fusiona en un único cluster más grande.

El método de Ward minimiza específicamente la suma total de cuadrados dentro de los clusters (WCSS). Formalmente, en cada paso Ward selecciona el par de clusters cuya fusión produce el incremento mínimo en la varianza total intra-cluster. El algoritmo se ejecuta recursivamente hasta que todos los países quedan englobados en un único cluster jerárquico global.

El resultado del método de Ward es un dendrograma—diagrama en forma de árbol invertido—que visualiza el proceso completo de fusión jerárquica. En el dendrograma, el eje horizontal representa la serie de países como hojas basales del árbol, el eje vertical representa la altura de fusión medida en unidades de distancia de Ward, las ramas internas conectan países o sub-clusters que se fusionan, y la altura de cada nodo indica el nivel de disimilaridad en el cual ocurrió esa fusión específica.

### Prediccion

Con el objetivo de validar la robustez del modelo de clusterización y demostrar su capacidad predictiva, se procedió a proyectar cinco países adicionales no incluidos en el conjunto de entrenamiento original sobre el espacio factorial de componentes principales. Estos países fueron: Luxemburgo, Uruguay, Belice, Jordania y Angola. La proyección de nuevas observaciones sobre el espacio factorial permite evaluar cómo cada país se posiciona relativamente respecto a los clusters identificados, prediciendo su asignación más probable basada en similitud multidimensional (Hastie et al., 2009; Jolliffe, 2002).

# Analisis descriptivo de los indicadores

# Resultados del modelo

## Analisis de componentes principales (ACP)

### Matriz de correlaciones

Antes de aplicar el Análisis de Componentes Principales, es fundamental examinar la estructura de correlaciones entre las 17 variables para identificar redundancias potenciales y validar la pertinencia de la reducción de dimensionalidad. La matriz de correlación de Pearson revela las asociaciones lineales entre pares de variables, proporcionando una visión exploratoria de cómo las dimensiones del desarrollo se interrelacionan. (Jolliffe, 2002).

```{r Matriz de correlaciones}
library(tidyverse)     
library(FactoClass)    
library(ade4)          
library(factoextra)    
library(cluster)       
library(dendextend)    
library(ggrepel)      
library(kableExtra)    
library(ggforce)    
library(plotly)        
library(sf)            
library(leaflet)       
library(rnaturalearth)
library(RColorBrewer)  
library(ellipse)

datos_analisis <- Base_2022 %>%
  select(-Codigo) %>%
  column_to_rownames("Pais")

library(ggcorrplot)

matriz_cor <- cor(datos_analisis, use = "complete.obs")

# Nombres completos para mejor legibilidad
nombres_completos <- c(
  "PIB_per" = "PIB per cápita",
  "Poblacion" = "Población total",
  "Esperanza vida" = "Esperanza de vida",
  "Acceso electricidad" = "Acceso electricidad",
  "Area boscosa" = "Área boscosa",
  "Suscripciones movil" = "Suscripciones móviles",
  "Crecimiento PIB" = "Crecimiento PIB",
  "Mortalidad infantil" = "Mortalidad infantil",
  "Inversion extranjera" = "Inversión extranjera",
  "Gasto salud" = "Gasto en salud",
  "Uso internet" = "Uso de internet",
  "Importaciones" = "Importaciones",
  "Exportaciones" = "Exportaciones",
  "Tierra cultivable" = "Tierra cultivable",
  "Crecimiento poblacion" = "Crecimiento población",
  "Industria" = "Industria",
  "Remesas" = "Remesas"
)

# Aplicar nombres completos
rownames(matriz_cor) <- nombres_completos[rownames(matriz_cor)]
colnames(matriz_cor) <- nombres_completos[colnames(matriz_cor)]

# Crear heatmap interactivo
heatmap_interactivo <- plot_ly(
  x = colnames(matriz_cor),
  y = rownames(matriz_cor),
  z = matriz_cor,
  type = "heatmap",
  colors = colorRamp(c("#6D9EC1", "white", "#E46726")),
  hoverinfo = "text",
  text = matrix(
    paste(
      "Variable X:", rep(colnames(matriz_cor), each = nrow(matriz_cor)),
      "<br>Variable Y:", rep(rownames(matriz_cor), times = ncol(matriz_cor)),
      "<br>Correlación:", round(c(matriz_cor), 3)
    ),
    nrow = nrow(matriz_cor),
    ncol = ncol(matriz_cor)
  ),
  colorbar = list(
    title = "Correlación",
    titleside = "right"
  )
) %>%
  layout(
    title = list(
      text = "<b>Matriz de Correlaciones Interactiva - 17 Variables de Desarrollo</b>",
      x = 0.05,
      font = list(size = 16)
    ),
    xaxis = list(
      title = "",
      tickangle = -45,
      tickfont = list(size = 10),
      showgrid = FALSE
    ),
    yaxis = list(
      title = "",
      tickfont = list(size = 10),
      showgrid = FALSE
    ),
    margin = list(l = 150, r = 50, b = 150, t = 80),
    annotations = list(
      list(
        x = 0.5,
        y = -0.15,
        text = "Haz clic y arrastra para zoom • Pasa el cursor para ver valores",
        showarrow = FALSE,
        xref = "paper",
        yref = "paper",
        font = list(size = 10, color = "gray")
      )
    )
  )

heatmap_interactivo
matriz_cor <- cor(datos_analisis, use = "complete.obs")

matriz_cor_long <- matriz_cor %>%
  as.data.frame() %>%
  rownames_to_column("Variable1") %>%
  pivot_longer(
    cols = -Variable1,
    names_to = "Variable2",
    values_to = "Correlacion"
  ) %>%
  filter(Variable1 != Variable2) %>%
  mutate(Correlacion = round(Correlacion, 3))

nombres_abreviados <- c(
  "PIB_per" = "PIB pc",
  "Poblacion" = "Población",
  "Esperanza vida" = "Esp. vida",
  "Acceso electricidad" = "Electricidad",
  "Area boscosa" = "Bosques",
  "Suscripciones movil" = "Móvil",
  "Crecimiento PIB" = "Crec. PIB",
  "Mortalidad infantil" = "Mort. inf.",
  "Inversion extranjera" = "IED",
  "Gasto salud" = "Salud",
  "Uso internet" = "Internet",
  "Importaciones" = "Import.",
  "Exportaciones" = "Export.",
  "Tierra cultivable" = "Cultivable",
  "Crecimiento poblacion" = "Crec. pob.",
  "Industria" = "Industria",
  "Remesas" = "Remesas"
)

cor_significativas <- matriz_cor_long %>%
  mutate(
    Variable1_abr = nombres_abreviados[Variable1],
    Variable2_abr = nombres_abreviados[Variable2]
  ) %>%
  filter(abs(Correlacion) > 0.5) %>%
  arrange(desc(abs(Correlacion))) %>%
  select(Variable1_abr, Variable2_abr, Correlacion) %>%
  distinct()

tabla_cor <- cor_significativas %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 12**"),
    subtitle = "Matriz de Correlaciones - Correlaciones Significativas (|r| > 0.5)"
  ) %>%
  cols_label(
    Variable1_abr = md("**Variable 1**"),
    Variable2_abr = md("**Variable 2**"),
    Correlacion = md("**Correlación (r)**")
  ) %>%
  cols_align(
    align = "center",
    columns = everything()
  ) %>%
  fmt_number(
    columns = Correlacion,
    decimals = 3
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium"),
      cell_fill(color = "white")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "black",
      weight = px(1)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "gray80",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Variable1_abr, Variable2_abr))
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = c(Variable1_abr, Variable2_abr))
  ) %>%
  tab_style(
    style = cell_fill(color = "#E8F5E8"),
    locations = cells_body(
      rows = Correlacion > 0.7
    )
  ) %>%
  tab_style(
    style = cell_fill(color = "#FFE6E6"),
    locations = cells_body(
      rows = Correlacion < -0.7
    )
  ) %>%
  tab_options(
    table.font.names = "Times New Roman",
    table.width = pct(80),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "none",
    column_labels.border.bottom.width = px(2),
    column_labels.border.bottom.color = "black",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    data_row.padding = px(6),
    heading.title.font.size = 14,
    heading.subtitle.font.size = 12,
    heading.padding = px(4),
    footnotes.padding = px(4)
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboración propia con base en World Bank (2023)")
  ) %>%
  tab_footnote(
    footnote = "Correlaciones positivas fuertes (r > 0.7) en verde claro",
    locations = cells_body(
      rows = 1
    )
  ) %>%
  tab_footnote(
    footnote = "Correlaciones negativas fuertes (r < -0.7) en rojo claro",
    locations = cells_body(
      rows = nrow(cor_significativas)
    )
  )

tabla_cor



```

La matriz de correlación entre todas las variables de desarrollo es fundamental porque exhibe patrones predecibles: variables económicas tienden a correlacionarse positivamente entre sí (PIB per cápita, crecimiento del PIB, inversión extranjera), variables de bienestar social correlacionan positivamente (esperanza de vida, acceso a electricidad, uso de internet), y existe una correlación positiva sustancial entre estas dos dimensiones generales (Hastie et al., 2009). Adicionalmente, se observan correlaciones negativas entre indicadores de rezago (mortalidad infantil, tierra cultivable) y variables de desarrollo avanzado, reflejando que países con mayor riqueza y bienestar exhiben menores tasas de mortalidad y menor dependencia agrícola. La presencia de correlaciones altas (superiores a 0.7) entre múltiples pares de variables justifica plenamente la aplicación del ACP: la reducción dimensional elimina redundancia sin perder información esencial (Jolliffe, 2002; Hastie et al., 2009).

### ACP

El Análisis de Componentes Principales fue aplicado al conjunto de 17 variables estandarizadas para identificar las dimensiones latentes subyacentes de variabilidad en el desarrollo internacional. El procedimiento consiste en la descomposición espectral de la matriz de covarianza estandarizada, identificando vectores propios (componentes) ordenados según sus valores propios (autovalores) en orden descendente. Cada componente principal es una combinación lineal ortogonal de las variables originales, diseñada para capturar la máxima varianza posible de manera sucesiva (Jolliffe, 2002; Hastie et al., 2009).

```{r ACP}
#cambios
res.pca <- prcomp(datos_analisis, scale = TRUE)
acp_temp <- dudi.pca(datos_analisis, center = TRUE, scale = TRUE, scannf = FALSE, nf = ncol(datos_analisis))
varianza_acum <- cumsum(acp_temp$eig) / sum(acp_temp$eig) * 100
factores <- acp_temp$li

```

```{r Tabla varianza}
#cambios
varianza_df <- data.frame(
  Componente = factor(1:length(acp_temp$eig)),
  Varianza = acp_temp$eig / sum(acp_temp$eig) * 100,
  VarianzaAcum = varianza_acum
) %>%  gt() %>%
  tab_header(
    title = md("**Tabla 5**"),
    subtitle = "Varianza Explicada por Componentes Principales"
  ) %>%
  cols_label(
    Componente = md("**Componente**"),
    Varianza = md("**Varianza (%)**"),
    VarianzaAcum = md("**Varianza Acumulada (%)**")
  ) %>%
  cols_align(
    align = "left",
    columns = everything()
  ) %>%
  fmt_number(
    columns = c(Varianza, VarianzaAcum),
    decimals = 2
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium"),
      cell_fill(color = "white")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "black",
      weight = px(1)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "gray80",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Componente, Varianza))
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = Componente)
  ) %>%
  tab_style(
    style = cell_text(size = "small"),
    locations = cells_body(columns = c(Varianza, VarianzaAcum))
  ) %>%
  tab_options(
    table.font.names = "Times New Roman",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "none",
    column_labels.border.bottom.width = px(2),
    column_labels.border.bottom.color = "black",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    data_row.padding = px(8),
    heading.title.font.size = 14,
    heading.subtitle.font.size = 12,
    heading.padding = px(4),
    footnotes.padding = px(4)
  ) %>%
  tab_source_note(
    source_note = md("**Fuentes:** Elaboración propia con base en los resultados del ACP")
  ) %>%
  tab_footnote(
    footnote = "Porcentaje de varianza explicada individualmente por cada componente principal",
    locations = cells_body(
      rows = 1,
      columns = Varianza
    )
  ) %>%
  tab_footnote(
    footnote = "Porcentaje acumulado de varianza explicada por los componentes hasta el actual",
    locations = cells_body(
      rows = 1,
      columns = VarianzaAcum
    )
  ) %>%
  tab_footnote(
    footnote = "Los componentes principales se ordenan de mayor a menor varianza explicada",
    locations = cells_title(groups = "subtitle")
  )

varianza_df 

varianza_df <- data.frame(
  Componente = paste0("PC", 1:length(acp_temp$eig)),
  Varianza = acp_temp$eig / sum(acp_temp$eig) * 100,
  VarianzaAcum = varianza_acum
)

pc1_var <- round(varianza_df$Varianza[1], 1)
pc2_var <- round(varianza_df$Varianza[2], 1)
pc3_var <- round(varianza_df$Varianza[3], 1)
pc4_var <- round(varianza_df$Varianza[4], 1)


pc1_acum <- round(varianza_df$VarianzaAcum[1], 1)
pc2_acum <- round(varianza_df$VarianzaAcum[2], 1)
pc3_acum <- round(varianza_df$VarianzaAcum[3], 1)
pc4_acum <- round(varianza_df$VarianzaAcum[4], 1)



```

En este análisis, el primer componente (**PC1**) capturó un **`r pc1_var`%** de la varianza total, lo que indica que existe una dimensión principal que diferencia fundamentalmente a los países. Los componentes posteriores capturan variabilidad subsidiaria: el segundo componente (**PC2**) explica **`r pc2_var`%** (acumulando **`r pc2_acum`%**), el tercero (**PC3**) **`r pc3_var`%** (acumulando **`r pc3_acum`%**), el cuarto (**PC4**) **`r pc4_var`%** (acumulando **`r pc4_acum`%**).

### Grafico de sedimentacion

El gráfico de sedimentación visualiza el concepto del "codo" (elbow) introducido por Kaiser (1960). La curva de los eigenvalores (representada como barras) exhibe un descenso pronunciado en los primeros componentes, indicando que capturan varianza sustancial. A partir de cierto componente, la pendiente se aplana significativamente, entrando en un régimen donde componentes posteriores explican proporciones cada vez menores de varianza residual (Hastie et al., 2009).

```{r sedimentacion, message =FALSE}
res.pca <- prcomp(datos_analisis, scale = TRUE)


eig.val <- get_eigenvalue(res.pca)
fviz_eig(res.pca,
         addlabels = TRUE,
         ylim = c(0, max(get_eigenvalue(res.pca)[, 2]) + 5),
         choice = "variance") +
  labs(
    title = "Varianza Explicada por Componente Principal",
    subtitle = "Autovalores del análisis de componentes principales",
    x = "Componentes Principales",
    y = "Porcentaje de Varianza Explicada (%)"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5, color = "#2C5F8D"),
    plot.subtitle = element_text(size = 11, hjust = 0.5, color = "gray40"),
    axis.title = element_text(face = "bold", size = 12, color = "#2C5F8D"),
    axis.text = element_text(size = 10, color = "gray30"),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_line(color = "gray92", size = 0.3),
    panel.background = element_rect(fill = "white"),
    plot.background = element_rect(fill = "white")
  ) +
  scale_fill_manual(values = "#2C5F8D") +
  scale_color_manual(values = "#2C5F8D")
```

```{r, include=FALSE}
res.var <- get_pca_var(res.pca)
res.var$coord         
res.var$contrib        
res.var$cos2  
```

El punto donde esta curvatura cambia de pronunciada a plana (el "codo") indica aproximadamente el número de componentes que retienen información relevante; componentes posteriores al codo tienden a capturar principalmente ruido estadístico (Jolliffe, 2002). Y se selecciona 4 componentes ya que a partir de $k=4$ se comienza a aplanar la varianza explicada.

### Contribución de Variables a Componentes Principales

La comprensión de cómo cada variable original contribuye a la definición de los componentes principales es esencial para interpretar las dimensiones latentes descubiertas. La contribución de una variable a un componente cuantifica el grado en el cual esa variable particular "explica" o "define" la dirección de ese componente en el espacio multidimensional original. Matemáticamente, la contribución se expresa como porcentaje de la varianza del componente que puede atribuirse a cada variable (Hastie et al., 2009; Jolliffe, 2002).

<!-- cambios -->

Adicionalmente, la calidad de representación ( $cos²$ ) de una variable en un componente indica qué proporción de la variabilidad total de esa variable es capturada por el componente. Un $cos²$ cercano a 1 significa que la variable está casi completamente explicada por ese componente; un $cos²$ cercano a 0 significa que la variable requiere componentes posteriores para ser bien representada (Jolliffe, 2002). Estas dos medidas—contribución y $cos^2$—son complementarias: la primera explica la importancia relativa de una variable en definir un componente; la segunda explica qué tan bien ese componente explica la variable (Hastie et al., 2009).

```{r contribucion}
#cambios
contribuciones <- as.data.frame(res.pca$rotation)  
contribuciones$Variable <- rownames(contribuciones)

cos2_df <- as.data.frame(res.pca$rotation^2)  
cos2_df$Variable <- rownames(cos2_df)

crear_tabla_contribucion <- function(componente_num, contrib_df, cos2_df, titulo, tabla_num) {
  comp_col <- paste0("PC", componente_num)
  
  comp_data <- contrib_df %>%
    select(Variable, all_of(comp_col)) %>%
    rename(Loading = all_of(comp_col))
  
  cos2_data <- cos2_df %>%
    select(Variable, all_of(comp_col)) %>%
    rename(Cos2 = all_of(comp_col))
  
  comp_data <- comp_data %>%
    left_join(cos2_data, by = "Variable") %>%
    mutate(LoadingAbs = abs(Loading)) %>%
    arrange(desc(LoadingAbs)) %>%
    select(-LoadingAbs) %>%
    mutate(
      Loading = round(Loading, 4),
      Cos2 = round(Cos2, 4)
    )
  descripciones <- c(
    "PIB_per" = "PIB per cápita (US$)",
    "Poblacion" = "Población total",
    "Esperanza.vida" = "Esperanza de vida al nacer (años)",  # Posiblemente con punto
    "Esperanza vida" = "Esperanza de vida al nacer (años)",  # O con espacio
    "Acceso.electricidad" = "Acceso a electricidad (% población)",
    "Acceso electricidad" = "Acceso a electricidad (% población)",
    "Area.boscosa" = "Área boscosa (% territorio)",
    "Area boscosa" = "Área boscosa (% territorio)",
    "Suscripciones.movil" = "Suscripciones móviles (cada 100 hab.)",
    "Suscripciones movil" = "Suscripciones móviles (cada 100 hab.)",
    "Crecimiento.PIB" = "Crecimiento del PIB (% anual)",
    "Crecimiento PIB" = "Crecimiento del PIB (% anual)",
    "Mortalidad.infantil" = "Mortalidad infantil (cada 1,000 nac.)",
    "Mortalidad infantil" = "Mortalidad infantil (cada 1,000 nac.)",
    "Inversion.extranjera" = "Inversión extranjera (% PIB)",
    "Inversion extranjera" = "Inversión extranjera (% PIB)",
    "Gasto.salud" = "Gasto en salud (% PIB)",
    "Gasto salud" = "Gasto en salud (% PIB)",
    "Uso.internet" = "Uso de internet (% población)",
    "Uso internet" = "Uso de internet (% población)",
    "Importaciones" = "Importaciones (% PIB)",
    "Exportaciones" = "Exportaciones (% PIB)",
    "Tierra.cultivable" = "Tierra cultivable (% territorio)",
    "Tierra cultivable" = "Tierra cultivable (% territorio)",
    "Crecimiento.poblacion" = "Crecimiento poblacional (% anual)",
    "Crecimiento poblacion" = "Crecimiento poblacional (% anual)",
    "Industria" = "Industria (% PIB)",
    "Remesas" = "Remesas recibidas (% PIB)"
  )
  
  comp_data <- comp_data %>%
    mutate(
      Descripcion = ifelse(
        Variable %in% names(descripciones), 
        descripciones[Variable], 
        Variable  
      ),
      Interpretacion = paste0(
        "Loading: ", Loading, 
        " | Cos²: ", Cos2,
        case_when(
          abs(Loading) >= 0.8 ~ " (Contribución muy fuerte)",
          abs(Loading) >= 0.6 ~ " (Contribución fuerte)", 
          abs(Loading) >= 0.4 ~ " (Contribución moderada)",
          abs(Loading) >= 0.2 ~ " (Contribución débil)",
          TRUE ~ " (Contribución muy débil)"
        )
      )
    ) %>%
    select(Variable, Descripcion, Interpretacion)
  
  tabla <- comp_data %>%
    gt() %>%
    tab_header(
      title = md(paste0("**Tabla ", tabla_num, "**")),
      subtitle = titulo
    ) %>%
    cols_label(
      Variable = md("**Variable**"),
      Descripcion = md("**Descripción**"),
      Interpretacion = md("**Interpretación**")
    ) %>%
    cols_align(
      align = "left",
      columns = everything()
    ) %>%
    tab_style(
      style = list(
        cell_text(weight = "bold", size = "medium"),
        cell_fill(color = "white")
      ),
      locations = cells_column_labels()
    ) %>%
    tab_style(
      style = cell_borders(
        sides = c("top", "bottom"),
        color = "black",
        weight = px(1)
      ),
      locations = list(
        cells_column_labels(),
        cells_body()
      )
    ) %>%
    tab_style(
      style = cell_borders(
        sides = "right",
        color = "gray80",
        weight = px(1)
      ),
      locations = cells_body(columns = c(Variable, Descripcion))
    ) %>%
    tab_style(
      style = cell_text(weight = "bold"),
      locations = cells_body(columns = Variable)
    ) %>%
    tab_style(
      style = cell_text(size = "small"),
      locations = cells_body(columns = c(Descripcion, Interpretacion))
    ) %>%
    tab_options(
      table.font.names = "Times New Roman",
      table.width = pct(100),
      table.border.top.style = "none",
      table.border.bottom.style = "none",
      column_labels.border.top.style = "none",
      column_labels.border.bottom.width = px(2),
      column_labels.border.bottom.color = "black",
      table_body.border.bottom.style = "none",
      table_body.border.top.style = "none",
      data_row.padding = px(8),
      heading.title.font.size = 14,
      heading.subtitle.font.size = 12,
      heading.padding = px(4),
      footnotes.padding = px(4)
    ) %>%
    tab_source_note(
      source_note = md("**Fuentes:** Elaboración propia con base en los resultados del ACP (prcomp)")
    ) %>%
    tab_footnote(
      footnote = "Loading: contribución de la variable al componente (valores absolutos >0.6 indican contribución fuerte)",
      locations = cells_title(groups = "subtitle")
    ) %>%
    tab_footnote(
      footnote = "Cos²: calidad de representación de la variable en el componente (valores cercanos a 1 indican mejor representación)",
      locations = cells_body(
        rows = 1,
        columns = Interpretacion
      )
    )
  
  return(tabla)
}

tabla_pc1 <- crear_tabla_contribucion(1, contribuciones, cos2_df,
                                     "Contribución de Variables al Componente Principal 1 (24.3% de varianza)",
                                     6)

tabla_pc2 <- crear_tabla_contribucion(2, contribuciones, cos2_df,
                                     "Contribución de Variables al Componente Principal 2 (13.5% de varianza)", 
                                     7)

tabla_pc3 <- crear_tabla_contribucion(3, contribuciones, cos2_df,
                                     "Contribución de Variables al Componente Principal 3 (9.1% de varianza)",
                                     8)

tabla_pc4 <- crear_tabla_contribucion(4, contribuciones, cos2_df,
                                     "Contribución de Variables al Componente Principal 4 (7.5% de varianza)",
                                     9)
tabla_pc1
tabla_pc2
tabla_pc3
tabla_pc4
```

### Análisis Multivariado: Interpretación de Componentes y Países

Una vez identificados los componentes principales y cuantificadas las contribuciones de cada variable, es fundamental realizar un análisis multivariado que permita interpretar simultáneamente las relaciones entre países y variables en el espacio reducido de componentes principales. Este análisis se fundamenta en visualizaciones bidimensionales que proyectan tanto países (individuos) como variables sobre los planos definidos por pares de componentes principales, revelando patrones de similitud, agrupamientos naturales y características diferenciadoras entre grupos de países (Jolliffe, 2002; Hastie et al., 2009).

<!-- cambios -->

En la Gráfica 1 observamos la proyección de los países en el espacio reducido de las dos primeras dimensiones del análisis de componentes principales.

```{r individuos DIM 1 Y DIM 2}
ind_data <- get_pca_ind(res.pca)


ind_df <- data.frame(
  Pais = rownames(ind_data$coord),
  Dim1 = ind_data$coord[, 1],
  Dim2 = ind_data$coord[, 2],
  Dim3 = ind_data$coord[, 3],
  Dim4 = ind_data$coord[, 4],
  Contrib1 = ind_data$contrib[, 1],
  Contrib2 = ind_data$contrib[, 2],
  Contrib3 = ind_data$contrib[, 3],
  Contrib4 = ind_data$contrib[, 4],
  Cos2_1 = ind_data$cos2[, 1],
  Cos2_2 = ind_data$cos2[, 2],
  Cos2_3 = ind_data$cos2[, 3],
  Cos2_4 = ind_data$cos2[, 4]
)

p1 <- plot_ly(ind_df,
              x = ~Dim1, 
              y = ~Dim2,
              color = ~Contrib1,
              colors = colorRampPalette(c("#00AFBB", "#E7B800", "#FC4E07"))(100),
              text = ~paste("<b>", Pais, "</b><br>",
                            "Dim 1:", round(Dim1, 3), "<br>",
                            "Dim 2:", round(Dim2, 3), "<br>",
                            "<b>Contribución Dim 1:</b> ", round(Contrib1, 2), "%<br>",
                            "<b>Contribución Dim 2:</b> ", round(Contrib2, 2), "%<br>",
                            "Cos2 Dim 1:", round(Cos2_1, 3), "<br>",
                            "Cos2 Dim 2:", round(Cos2_2, 3)),
              type = "scatter",
              mode = "markers",
              marker = list(size = 10, opacity = 0.8, line = list(width = 1, color = "white")),
              hovertemplate = '%{text}<extra></extra>') %>%
  
  layout(
    title = list(
      text = "Individuos: Dimensión 1 vs Dimensión 2<br><sub>Coloreado por Contribución Dim 1</sub>",
      font = list(size = 16, color = "#2C5F8D")
    ),
    xaxis = list(title = "Dimensión 1", zeroline = TRUE, zerolinecolor = "gray"),
    yaxis = list(title = "Dimensión 2", zeroline = TRUE, zerolinecolor = "gray"),
    hovermode = "closest",
    plot_bgcolor = "white",
    paper_bgcolor = "white"
  )

p1
```

<!-- cambios -->

En la dimensión 1, Níger emerge como el mayor contribuidor, posicionándose en el extremo negativo del eje que representa el déficit en desarrollo humano y conectividad tecnológica, reflejando severas limitaciones en acceso a servicios básicos, mortalidad infantil elevada y baja penetración digital. Le sigue San Marino, ubicado en el extremo positivo, representando un microestado con indicadores de bienestar consolidados en salud y esperanza de vida. En la dimensión 2, Qatar lidera como mayor contribuidor, posicionándose en el extremo inferior del eje, consolidándose como economía petroquímica ultraespecializada con estructura industrial dominada por hidrocarburos y dinámicas demográficas atípicas. Islas Marshall emerge como segundo mayor contribuidor, ubicándose en el extremo superior, caracterizándose como Estado insular vulnerable con alta dependencia de ayuda externa y servicios financieros.﻿

En la Gráfica 2 observamos la proyección de los países en el espacio reducido de las dos ultimas dimensiones del análisis de componentes principales.

```{r individuos DIM 3 Y DIM 4}

p2 <- plot_ly(ind_df,
              x = ~Dim3, 
              y = ~Dim4,
              color = ~Contrib3,
              colors = colorRampPalette(c("#00AFBB", "#E7B800", "#FC4E07"))(100),
              text = ~paste("<b>", Pais, "</b><br>",
                            "Dim 3:", round(Dim3, 3), "<br>",
                            "Dim 4:", round(Dim4, 3), "<br>",
                            "<b>Contribución Dim 3:</b> ", round(Contrib3, 2), "%<br>",
                            "<b>Contribución Dim 4:</b> ", round(Contrib4, 2), "%<br>",
                            "Cos2 Dim 3:", round(Cos2_3, 3), "<br>",
                            "Cos2 Dim 4:", round(Cos2_4, 3)),
              type = "scatter",
              mode = "markers",
              marker = list(size = 10, opacity = 0.8, line = list(width = 1, color = "white")),
              hovertemplate = '%{text}<extra></extra>') %>%
  
  layout(
    title = list(
      text = "Individuos: Dimensión 3 vs Dimensión 4<br><sub>Coloreado por Contribución Dim 3</sub>",
      font = list(size = 16, color = "#2C5F8D")
    ),
    xaxis = list(title = "Dimensión 3", zeroline = TRUE, zerolinecolor = "gray"),
    yaxis = list(title = "Dimensión 4", zeroline = TRUE, zerolinecolor = "gray"),
    hovermode = "closest",
    plot_bgcolor = "white",
    paper_bgcolor = "white"
  )

p2
```

<!-- cambios -->

En la dimensión 3, Malta emerge como el mayor contribuidor, posicionándose en el extremo positivo del eje que representa economías hiperglobalizadas con ratios comerciales excesivamente altos, reflejando su condición de centro financiero y comercial con flujos internacionales que superan significativamente su PIB. China se sitúa en el extremo negativo, evidenciando una estructura comercial más balanceada basada en exportaciones de manufactura y sostenida por una vasta base poblacional. En la dimensión 4, India se coloca en el extremo negativo, reflejando presión demográfica extrema sobre recursos naturales (1,400 millones de habitantes sobre territorio limitado generan demanda exponencial de tierra cultivable y agua). Timor-Leste se ubica en el extremo positivo, caracterizándose por baja densidad poblacional relativa y abundancia de cobertura forestal.

### Representación de Variables en el Plano de Componentes Principales

<!-- cambios -->

El círculo de correlaciones es una herramienta fundamental para interpretar las dimensiones latentes capturadas por los componentes principales. Cada una de las 17 variables originales se representa como un vector (flecha) proyectado desde el origen hacia el plano bidimensional definido por los dos primeros componentes principales. La longitud de cada flecha indica la calidad de representación de esa variable: flechas largas (próximas al círculo unitario de referencia) indican variables bien representadas los componentes principales, mientras que flechas cortas indican que la variable requiere componentes posteriores para ser completamente explicada (Jolliffe, 2002; Hastie et al., 2009).

La dirección de cada flecha—es decir, el ángulo que forma con los ejes—indica cómo esa variable se correlaciona con los componentes. Las variables posicionadas en la dirección positiva del eje PC1 (hacia la derecha del gráfico) son aquellas que correlacionan positivamente con PC1 y, por lo tanto, caracterizan el polo derecho del eje.

En la Gráfica 2, correspondiente al círculo de correlaciones, observamos la proyección de las 17 variables originales en el plano definido por los dos primeros componentes principales.

```{r Variables DIM 1 Y DIM 2}

var_data <- get_pca_var(res.pca)

var_df <- data.frame(
  Variable = rownames(var_data$coord),
  Dim1 = var_data$coord[, 1],
  Dim2 = var_data$coord[, 2],
  Dim3 = var_data$coord[, 3],
  Dim4 = var_data$coord[, 4],
  Dim5 = var_data$coord[, 5],
  Dim6 = var_data$coord[, 6],
  Contrib1 = var_data$contrib[, 1],
  Contrib2 = var_data$contrib[, 2],
  Contrib3 = var_data$contrib[, 3],
  Contrib4 = var_data$contrib[, 4],
  Contrib5 = var_data$contrib[, 5],
  Contrib6 = var_data$contrib[, 6],
  Cos2_1 = var_data$cos2[, 1],
  Cos2_2 = var_data$cos2[, 2],
  Cos2_3 = var_data$cos2[, 3],
  Cos2_4 = var_data$cos2[, 4],
  Cos2_5 = var_data$cos2[, 5],
  Cos2_6 = var_data$cos2[, 6]
)


p1 <- plot_ly(var_df,
              x = ~Dim1, 
              y = ~Dim2,
              color = ~Contrib1,
              colors = colorRampPalette(c("#00AFBB", "#E7B800", "#FC4E07"))(100),
              text = ~paste("<b>", Variable, "</b><br>",
                            "Dim 1:", round(Dim1, 3), "<br>",
                            "Dim 2:", round(Dim2, 3), "<br>",
                            "<b>Contribución Dim 1:</b> ", round(Contrib1, 2), "%<br>",
                            "<b>Contribución Dim 2:</b> ", round(Contrib2, 2), "%<br>",
                            "Cos2 Dim 1:", round(Cos2_1, 3), "<br>",
                            "Cos2 Dim 2:", round(Cos2_2, 3)),
              type = "scatter",
              mode = "markers",
              marker = list(size = 12, opacity = 0.8, line = list(width = 2, color = "white")),
              hovertemplate = '%{text}<extra></extra>') %>%
  
  add_segments(x = 0, xend = ~Dim1, y = 0, yend = ~Dim2,
               line = list(color = "rgba(100, 100, 100, 0.3)", width = 1),
               showlegend = FALSE, hoverinfo = "skip") %>%
  
  layout(
    title = list(
      text = "Variables: Dimensión 1 vs Dimensión 2<br><sub>Coloreado por Contribución Dim 1</sub>",
      font = list(size = 16, color = "#2C5F8D")
    ),
    xaxis = list(title = "Dimensión 1", zeroline = TRUE, zerolinecolor = "gray"),
    yaxis = list(title = "Dimensión 2", zeroline = TRUE, zerolinecolor = "gray"),
    hovermode = "closest",
    plot_bgcolor = "white",
    paper_bgcolor = "white"
  )

p1
```

<!-- cambios -->

En la dimensión 1, la Esperanza de vida lidera, posicionándose en el extremo positivo, consolidando un eje que representa desarrollo humano y calidad de vida. Simultáneamente, la Mortalidad infantil se posiciona en el extremo negativo, estableciendo un contraste fundamental entre naciones con alta esperanza de vida versus aquellas con elevada mortalidad neonatal refleja de sistemas de salud deficitarios. En la dimensión 2, la Industria en el extremo negativo refleja economías donde la dependencia de una única rama industrial es REDUCIDA o donde la manufactura está integrada verticalmente de manera autónoma. Las Remesas emergen como segundo vector importante en el extremo positivo, capturando economías ALTAMENTE DEPENDIENTES de transferencias de capital internacional, caracterizadas por débil base productiva propia y vulnerabilidad a ciclos externos.

<!-- cambios -->

En la Gráfica 2, correspondiente al círculo de correlaciones, observamos la proyección de las 17 variables originales en el plano definido por los componentes principales 3 y 4.

```{r Variables DIM 3 Y DIM 4}
p2 <- plot_ly(var_df,
              x = ~Dim3, 
              y = ~Dim4,
              color = ~Contrib3,
              colors = colorRampPalette(c("#00AFBB", "#E7B800", "#FC4E07"))(100),
              text = ~paste("<b>", Variable, "</b><br>",
                            "Dim 3:", round(Dim3, 3), "<br>",
                            "Dim 4:", round(Dim4, 3), "<br>",
                            "<b>Contribución Dim 3:</b> ", round(Contrib3, 2), "%<br>",
                            "<b>Contribución Dim 4:</b> ", round(Contrib4, 2), "%<br>",
                            "Cos2 Dim 3:", round(Cos2_3, 3), "<br>",
                            "Cos2 Dim 4:", round(Cos2_4, 3)),
              type = "scatter",
              mode = "markers",
              marker = list(size = 12, opacity = 0.8, line = list(width = 2, color = "white")),
              hovertemplate = '%{text}<extra></extra>') %>%
  
  add_segments(x = 0, xend = ~Dim3, y = 0, yend = ~Dim4,
               line = list(color = "rgba(100, 100, 100, 0.3)", width = 1),
               showlegend = FALSE, hoverinfo = "skip") %>%
  
  layout(
    title = list(
      text = "Variables: Dimensión 3 vs Dimensión 4<br><sub>Coloreado por Contribución Dim 3</sub>",
      font = list(size = 16, color = "#2C5F8D")
    ),
    xaxis = list(title = "Dimensión 3", zeroline = TRUE, zerolinecolor = "gray"),
    yaxis = list(title = "Dimensión 4", zeroline = TRUE, zerolinecolor = "gray"),
    hovermode = "closest",
    plot_bgcolor = "white",
    paper_bgcolor = "white"
  )

p2
```

```         
<!-- cambios -->
```

En la dimensión 3, las Importaciones se colocan en el extremo negativo del eje, que representa economías cerradas con baja intensidad comercial, reflejando limitadas importaciones, reducidas exportaciones y escasa inversión externa. Simultáneamente, el polo positivo representa el extremo opuesto, estableciendo un contraste fundamental entre economías cerradas versus aquellas altamente abiertas con flujos comerciales exponenciados e inversión transnacional abundante. En la dimensión 4, el Área boscosa se posiciona en el extremo negativo, reflejando deforestación severa donde bosques han sido masivamente convertidos en tierra cultivable. En contraste, Tierra cultivable y Población emergen en el extremo positivo, caracterizándose por equilibrio entre población y recursos territoriales, con alta disponibilidad de tierra cultivable y ausencia de presión deforestadora extrema.﻿

### Análisis Integrado de Variables y Países

El análisis combinado de las variables y los países en el espacio reducido de los componentes principales permite identificar patrones de asociación estructural que trascienden el análisis univariable. La metodología del biplot permite vincular directamente las posiciones espaciales de los países con las magnitudes observadas en las variables originales, estableciendo relaciones interpretativas que evidencian cómo las características multidimensionales de desarrollo se manifiestan diferencialmente en distintos grupos de países (Jolliffe, 2002; Hastie et al., 2009).

Para comprender la lógica interpretativa del biplot, es fundamental reconocer que la posición de un país en relación a la dirección de una flecha de variable indica el valor relativo de ese país en esa variable específica. Países ubicados en la misma dirección que una flecha exhiben valores altos en esa variable; países ubicados en dirección opuesta exhiben valores bajos; países ubicados perpendicularmente (formando ángulos de \~$90°$) exhiben valores cercanos a la media global. Esta propiedad geométrica del biplot permite realizar diagnósticos cuantitativos directamente desde la visualización gráfica, sin necesidad de consultar la base de datos original, siempre que la calidad de representación ($cos²$) sea suficientemente alta (Jolliffe, 2002).

```{r Paises y variables DIM 1 Y DIM 2}
acp_prcomp <- prcomp(datos_analisis, center = TRUE, scale. = TRUE)
ind_data <- get_pca_ind(acp_prcomp)
var_data <- get_pca_var(acp_prcomp)


ind_df <- data.frame(
  Pais = rownames(ind_data$coord),
  Dim1 = ind_data$coord[, 1],
  Dim2 = ind_data$coord[, 2],
  Dim3 = ind_data$coord[, 3],
  Dim4 = ind_data$coord[, 4],
  Contrib1 = ind_data$contrib[, 1],
  Contrib2 = ind_data$contrib[, 2],
  Contrib3 = ind_data$contrib[, 3],
  Contrib4 = ind_data$contrib[, 4]
)

var_df <- data.frame(
  Variable = rownames(var_data$coord),
  Dim1 = var_data$coord[, 1] * 3,
  Dim2 = var_data$coord[, 2] * 3,
  Dim3 = var_data$coord[, 3] * 3,
  Dim4 = var_data$coord[, 4] * 3,
  Contrib1 = var_data$contrib[, 1],
  Contrib2 = var_data$contrib[, 2],
  Contrib3 = var_data$contrib[, 3],
  Contrib4 = var_data$contrib[, 4]
)

p1 <- plot_ly() %>%
  
  add_segments(
    data = var_df,
    x = 0, xend = ~Dim1, y = 0, yend = ~Dim2,
    line = list(color = "#2E9FDF", width = 2),
    showlegend = FALSE, hoverinfo = "skip"
  ) %>%
  
  add_trace(
    data = var_df,
    x = ~Dim1, y = ~Dim2,
    text = ~paste("<b>VARIABLE: ", Variable, "</b><br>",
                  "Dim 1:", round(Dim1/3, 3), "<br>",
                  "Dim 2:", round(Dim2/3, 3), "<br>",
                  "<b>Contribución Dim 1:</b> ", round(Contrib1, 2), "%<br>",
                  "<b>Contribución Dim 2:</b> ", round(Contrib2, 2), "%"),
    type = "scatter",
    mode = "markers",
    marker = list(size = 10, color = "#2E9FDF", opacity = 0.8, line = list(width = 2, color = "white")),
    hovertemplate = '%{text}<extra></extra>',
    name = "Variables"
  ) %>%
  
  add_trace(
    data = ind_df,
    x = ~Dim1, y = ~Dim2,
    text = ~paste("<b>PAÍS: ", Pais, "</b><br>",
                  "Dim 1:", round(Dim1, 3), "<br>",
                  "Dim 2:", round(Dim2, 3), "<br>",
                  "<b>Contribución Dim 1:</b> ", round(Contrib1, 2), "%<br>",
                  "<b>Contribución Dim 2:</b> ", round(Contrib2, 2), "%"),
    type = "scatter",
    mode = "markers",
    marker = list(size = 8, color = "#696969", opacity = 0.6, line = list(width = 1, color = "white")),
    hovertemplate = '%{text}<extra></extra>',
    name = "Países"
  ) %>%
  
  layout(
    title = list(
      text = "Biplot: Dimensión 1 vs Dimensión 2<br><sub>Azul = Variables | Gris = Países</sub>",
      font = list(size = 16, color = "#2C5F8D")
    ),
    xaxis = list(title = "Dimensión 1", zeroline = TRUE, zerolinecolor = "gray"),
    yaxis = list(title = "Dimensión 2", zeroline = TRUE, zerolinecolor = "gray"),
    hovermode = "closest",
    plot_bgcolor = "white",
    paper_bgcolor = "white",
    legend = list(x = 0.02, y = 0.98)
  )

p1

```

Senegal y Burkina Faso se alinean con la flecha de mortalidad infantil, confirmando valores altos en esa variable. Egipto se alinea con crecimiento poblacional, indicando tasa de crecimiento demográfico elevada. Corea del Sur y Nueva Zelanda se alinean con exportaciones, indicando economías muy orientadas a comercio externo. Suiza se alinea con esperanza de vida, confirmando longevidad excepcional.

En dirección opuesta: países desarrollados europeos se oponen a flechas de mortalidad y rezago, reflejando valores bajos en estos indicadores negativos. Honduras y República Kirguisa se alinean con remesas, indicando dependencia crítica de transferencias de migrantes.

```{r Paises y variables DIM 3 Y DIM 4}
p2 <- plot_ly() %>%
  
  add_segments(
    data = var_df,
    x = 0, xend = ~Dim3, y = 0, yend = ~Dim4,
    line = list(color = "#2E9FDF", width = 2),
    showlegend = FALSE, hoverinfo = "skip"
  ) %>%
  
  add_trace(
    data = var_df,
    x = ~Dim3, y = ~Dim4,
    text = ~paste("<b>VARIABLE: ", Variable, "</b><br>",
                  "Dim 3:", round(Dim3/3, 3), "<br>",
                  "Dim 4:", round(Dim4/3, 3), "<br>",
                  "<b>Contribución Dim 3:</b> ", round(Contrib3, 2), "%<br>",
                  "<b>Contribución Dim 4:</b> ", round(Contrib4, 2), "%"),
    type = "scatter",
    mode = "markers",
    marker = list(size = 10, color = "#2E9FDF", opacity = 0.8, line = list(width = 2, color = "white")),
    hovertemplate = '%{text}<extra></extra>',
    name = "Variables"
  ) %>%
  
  add_trace(
    data = ind_df,
    x = ~Dim3, y = ~Dim4,
    text = ~paste("<b>PAÍS: ", Pais, "</b><br>",
                  "Dim 3:", round(Dim3, 3), "<br>",
                  "Dim 4:", round(Dim4, 3), "<br>",
                  "<b>Contribución Dim 3:</b> ", round(Contrib3, 2), "%<br>",
                  "<b>Contribución Dim 4:</b> ", round(Contrib4, 2), "%"),
    type = "scatter",
    mode = "markers",
    marker = list(size = 8, color = "#696969", opacity = 0.6, line = list(width = 1, color = "white")),
    hovertemplate = '%{text}<extra></extra>',
    name = "Países"
  ) %>%
  
  layout(
    title = list(
      text = "Biplot: Dimensión 3 vs Dimensión 4<br><sub>Azul = Variables | Gris = Países</sub>",
      font = list(size = 16, color = "#2C5F8D")
    ),
    xaxis = list(title = "Dimensión 3", zeroline = TRUE, zerolinecolor = "gray"),
    yaxis = list(title = "Dimensión 4", zeroline = TRUE, zerolinecolor = "gray"),
    hovermode = "closest",
    plot_bgcolor = "white",
    paper_bgcolor = "white",
    legend = list(x = 0.02, y = 0.98)
  )

p2
```

Guinea se posiciona en la dirección de crecimiento poblacional, indicando valores altos en esta variable. Kuwait y Djibouti se alinean con importaciones, indicando ratios elevados. Senegal e Irlanda se alinean con exportaciones, indicando orientación exportadora. Burkina Faso y Qatar se alinean con mortalidad infantil, indicando valores en esta variable. Macedonia del Norte se alinea con PIB per cápita, indicando ingreso por habitante en esa dirección.

### Caracterizacion de los componentes principales

## Segmentación: Clusterización

Sobre la base de los k componentes principales retenidos del Análisis de Componentes Principales, se aplicó el método de Ward para clusterización jerárquica aglomerativa. Este algoritmo organiza los datos con el objetivo de determinar clusters de países mediante un enfoque que se basa en la distancia entre los puntos para mostrar posibles agrupamientos. El procedimiento iterativo de fusión permite identificar estructuras naturales de similitud que trascienden clasificaciones geográficas o económicas convencionales, revelando en cambio grupos de países que comparten perfiles multidimensionales coherentes de desarrollo (Ward, 1963; Hastie et al., 2009).

El método de Ward minimiza específicamente la suma total de cuadrados dentro de clusters (*within-cluster sum of squares*, WCSS), definida matemáticamente como:

$$WCSS = \sum_{c=1}^{C} \sum_{i \in c} ||x_i - \bar{c}||^2$$

donde: - $C$ es el número de clusters, - $x_i$ es la posición de la observación $i$ en el espacio de componentes principales, - $\bar{c}$ es el centroide (promedio) del cluster $c$.

En cada paso del algoritmo, se identifican los dos clusters cuya fusión produce el incremento mínimo en WCSS total, maximizando así la homogeneidad interna de cada cluster mientras se maximiza la disimilaridad entre clusters (Ward, 1963; Hastie et al., 2009).

```{r clusters}
library(FactoClass)
library(ade4)

resultado_ACP <- FactoClass(
  datos_analisis,  
  dudi.pca,       
  nf = 4,           
  k.clust = 3,      
  scan = FALSE     
)

clusters_asignados <- resultado_ACP$cluster

NuevaBase <- data.frame(Cluster = clusters_asignados, datos_analisis)
```

### Numero optimo de clusters

La selección del número óptimo de clusters k se realizó mediante la evaluación conjunta de tres criterios complementarios: análisis del dendrograma, método del codo, y coherencia interpretativa. El dendrograma revela visualmente la estructura jerárquica de fusiones: se identifican alturas donde las fusiones producen incrementos dramáticos en disimilaridad, sugiriendo que clusters diferenciados se están uniendo. Un corte horizontal del dendrograma a altura intermedia permite definir el número de clusters finales.

```{r DENDO}
library(plotly)
library(factoextra)
library(FactoMineR)
library(cluster)
library(ggplot2)
library(dendextend)
library(ggdendro)
library(dplyr)
coordenadas_pca <- as.data.frame(resultado_ACP$dudi$li[, 1:4])
distancias <- dist(coordenadas_pca)
hc <- hclust(distancias, method = "ward.D2")
k <- 3
cluster_colors <- c("1" = "#0057B8", 
                    "2" = "#CE1126",  
                    "3" = "#FFD700")  

clusters <- cutree(hc, k = k)
dend <- as.dendrogram(hc)
dend_data <- dendro_data(dend)
leaf_x <- dend_data$labels$x
leaf_names <- as.character(dend_data$labels$label)
names(clusters) <- rownames(coordenadas_pca)

label_clusters <- clusters[match(leaf_names, names(clusters))]
if (any(is.na(label_clusters))) {
  idx_num <- suppressWarnings(as.integer(leaf_names))
  if (!all(is.na(idx_num))) {
    label_clusters[is.na(label_clusters)] <- clusters[idx_num[is.na(label_clusters)]]
  }
}
label_clusters <- as.integer(label_clusters)
dxs <- sort(unique(diff(sort(leaf_x))))
pad <- ifelse(length(dxs) > 0, dxs[1] / 2, 0.5)
max_y <- max(dend_data$segments$y, na.rm = TRUE)

cluster_rectangles <- tibble::tibble(
  cluster = integer(),
  x0 = numeric(),
  x1 = numeric(),
  y0 = numeric(),
  y1 = numeric(),
  color = character()
)

for (cl in 1:k) {
  xs_cl <- leaf_x[which(label_clusters == cl)]
  if (length(xs_cl) > 0) {
    x0 <- min(xs_cl) - pad
    x1 <- max(xs_cl) + pad
    cluster_rectangles <- cluster_rectangles %>%
      add_row(
        cluster = cl,
        x0 = x0,
        x1 = x1,
        y0 = 0,
        y1 = max_y * 0.92,
        color = cluster_colors[as.character(cl)]
      )
  }
}
tree_color <- "#0057B8"
seg_df <- dend_data$segments
seg_df$seg_col <- tree_color
dend_interactive <- plot_ly()
dend_interactive <- dend_interactive %>%
  add_segments(
    data = seg_df,
    x = ~x, xend = ~xend,
    y = ~y, yend = ~yend,
    line = list(color = tree_color, width = 2),
    hoverinfo = "none",
    showlegend = FALSE
  )
labels_df <- dend_data$labels %>%
  mutate(cluster = label_clusters,
         color = cluster_colors[as.character(cluster)])

dend_interactive <- dend_interactive %>%
  add_markers(
    data = labels_df,
    x = ~x, y = ~y,
    text = ~paste0("Etiqueta: ", label, "<br>Cluster: ", cluster),
    hoverinfo = "text",
    marker = list(size = 9, line = list(width = 1, color = "black")),
    color = ~I(color),
    showlegend = FALSE
  )
shapes_list <- lapply(seq_len(nrow(cluster_rectangles)), function(i) {
  list(
    type = "rect",
    x0 = cluster_rectangles$x0[i],
    x1 = cluster_rectangles$x1[i],
    y0 = cluster_rectangles$y0[i],
    y1 = cluster_rectangles$y1[i],
    fillcolor = cluster_rectangles$color[i],
    line = list(color = "black", width = 3),
    opacity = 0.18,
    layer = "below"
  )
})
linea_corte <- list(
  type = "line",
  x0 = min(dend_data$segments$x, na.rm = TRUE),
  x1 = max(dend_data$segments$x, na.rm = TRUE),
  y0 = 15,
  y1 = 15,
  line = list(color = "#B22222", width = 3, dash = "solid"),  
  layer = "above"
)

shapes_list <- append(shapes_list, list(linea_corte))
dend_interactive <- dend_interactive %>%
  layout(
    title = list(text = "Dendrograma interactivo </b>", x = 0.01),
    shapes = shapes_list,
    xaxis = list(title = "", showticklabels = FALSE, zeroline = FALSE, showgrid = FALSE),
    yaxis = list(title = "Distancia", zeroline = FALSE, showgrid = TRUE),
    plot_bgcolor = "white",
    paper_bgcolor = "white",
    hovermode = "closest",
    margin = list(l = 80, r = 180, t = 80, b = 80)
  ) %>%
  config(displayModeBar = TRUE, scrollZoom = TRUE, displaylogo = FALSE)
dend_interactive
```

El método del codo examina cómo disminuye WCSS (suma de cuadrados dentro de clusters) conforme aumenta el número de clusters desde $k=2$ hasta $k=10$ Inicialmente, incrementar $k$ reduce WCSS rápidamente porque se reduce heterogeneidad interna; sin embargo, a partir de cierto $k$ (el "codo"), la reducción adicional se vuelve marginal, sugiriendo que clusters posteriores no capturan estructura genuina sino que simplemente subdividen artificialmente. Típicamente, el codo se identifica en $k=3$ a $k=4$ para análisis de desarrollo internacional.

```{r dendograma-corregido, message=FALSE, warning=FALSE}

library(plotly)
library(factoextra)
library(FactoMineR)
library(cluster)
library(ggplot2)
library(dendextend)
library(plotly)
library(ggdendro)

acp_result <- resultado_ACP$dudi

p1 <- fviz_eig(acp_result, 
               addlabels = TRUE, 
               ylim = c(0, 30),
               barfill = "#2E9FDF",
               barcolor = "#2E9FDF",
               linecolor = "#FC4E07",
               main = "Varianza Explicada por Componentes Principales",
               xlab = "Componentes Principales",
               ylab = "Porcentaje de Varianza Explicada") +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
    axis.title = element_text(face = "bold")
  )

p1_interactive <- ggplotly(p1) %>%
  layout(
    title = list(
      text = "<b>Varianza Explicada por Componentes Principales</b>",
      x = 0.05
    )
  )
p1_interactive


```

La coherencia interpretativa valida que los clusters identificados tienen significado económico y social claro. En este análisis, se seleccionó $k=3$ clusters porque esta segmentación produce tres grupos conceptualmente diferenciados.

### Caracterizacion de los clusters

La segmentación produjo una distribución desigual de países entre clusters. El Cluster 1 agrupa 84 países (61.8% del total), el Cluster 2 agrupa 32 países (23.5%), y el Cluster 3 agrupa 20 países (14.7%). Esta distribución refuerza la interpretación de que existe un pequeño grupo de países ultra-desarrollados (Cluster 1), un grupo intermedio significativo de emergentes (Cluster 2), y un grupo minoritario pero vulnerable de países en rezago extremo (Cluster 3). La concentración de 61.8% en Cluster 1 sugiere que la mayoría de países han logrado algún nivel de desarrollo básico, mientras que la minoría de 14.7% en Cluster 3 representa casos de vulnerabilidad persistente y multidimensional.

```{r Tabla de distribucion}
distribucion_clusters <- table(clusters_asignados) %>%
  as.data.frame() %>%
  rename(Cluster = clusters_asignados, Frecuencia = Freq) %>%
  mutate(Porcentaje = round(Frecuencia/sum(Frecuencia)*100, 2))

tabla_distribucion <- distribucion_clusters %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 12**"),
    subtitle = "Distribución de Países por Cluster"
  ) %>%
  cols_label(
    Cluster = md("**Cluster**"),
    Frecuencia = md("**N° Países**"),
    Porcentaje = md("**Porcentaje (%)**")
  ) %>%
  fmt_number(
    columns = Porcentaje,
    decimals = 1,
    pattern = "{x}%"
  ) %>%
  tab_options(
    table.font.names = "Times New Roman"
  )

tabla_distribucion

```

```{r tablas}
library(dplyr)
library(tidyr)
library(stringr)
library(gt)

estadisticas_clusters <- NuevaBase %>%
  group_by(Cluster) %>%
  summarise(across(
    where(is.numeric),
    list(
      Media = ~round(mean(., na.rm = TRUE), 2),
      Mediana = ~round(median(., na.rm = TRUE) , 2),
      DE = ~round(sd(., na.rm = TRUE), 2),
      Min = ~round(min(., na.rm = TRUE), 2),
      Max = ~round(max(., na.rm = TRUE), 2)

    )
  )) %>%
  pivot_longer(
    cols = -Cluster,
    names_to = "Variable_Estadistica",
    values_to = "Valor"
  ) %>%
  separate(Variable_Estadistica, into = c("Variable", "Estadistica"), sep = "_") %>%
  pivot_wider(
    names_from = Estadistica,
    values_from = Valor
  )

```

```{r Grafico clusters}
nombres_variables <- c(
  "PIB_per" = "PIB per cápita (US$)",
  "Poblacion" = "Población total",
  "Esperanza.vida" = "Esperanza de vida (años)",
  "Acceso.electricidad" = "Acceso electricidad (%)",
  "Area.boscosa" = "Área boscosa (%)",
  "Suscripciones.movil" = "Suscripciones móviles",
  "Crecimiento.PIB" = "Crecimiento PIB (%)",
  "Mortalidad.infantil" = "Mortalidad infantil",
  "Inversion.extranjera" = "Inversión extranjera (%)",
  "Gasto.salud" = "Gasto en salud (%)",
  "Uso.internet" = "Uso de internet (%)",
  "Importaciones" = "Importaciones (%)",
  "Exportaciones" = "Exportaciones (%)",
  "Tierra.cultivable" = "Tierra cultivable (%)",
  "Crecimiento.poblacion" = "Crecimiento población (%)",
  "Industria" = "Industria (%)",
  "Remesas" = "Remesas (%)"
)
par(mfrow = c(2, 2), mar = c(4, 4, 2, 1))



tabla_estadisticas <- estadisticas_clusters %>%
  mutate(
    Variable_Descriptiva = nombres_variables[Variable],
    Cluster = paste("Cluster", Cluster)
  ) %>%
  select(Cluster, Variable_Descriptiva, Media,Mediana, DE, Min, Max) %>%
  arrange(Cluster, Variable_Descriptiva) %>%
  gt(groupname_col = "Cluster") %>%
  tab_header(
    title = md("**ESTADÍSTICAS DESCRIPTIVAS POR CLUSTER**"),
    subtitle = "Medias, desviaciones estándar y rangos de las variables originales"
  ) %>%
  cols_label(
    Variable_Descriptiva = md("**Variable**"),
    Media = md("**Media**"),
    DE = md("**D.E.**"),
    Min = md("**Mín**"),
    Max = md("**Máx**"),
    Mediana = md("**Mediana**")
  ) %>%
  cols_align(
    align = "center",
    columns = c(Media,Mediana, DE, Min, Max)
  ) %>%
  cols_align(
    align = "left",
    columns = Variable_Descriptiva
  ) %>%
  fmt_number(
    columns = c(Media,Mediana, DE, Min, Max),
    decimals = 2
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium"),
      cell_fill(color = "white")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "black",
      weight = px(1)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "gray80",
      weight = px(1)
    ),
    locations = cells_body(columns = c(Variable_Descriptiva, Media, DE, Min, Max))
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = Variable_Descriptiva)
  ) %>%
  tab_style(
    style = cell_fill(color = "#F0F8FF"),
    locations = cells_row_groups()
  ) %>%
  tab_options(
    table.font.names = "Times New Roman",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "none",
    column_labels.border.bottom.width = px(2),
    column_labels.border.bottom.color = "black",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    data_row.padding = px(6),
    heading.title.font.size = 16,
    heading.subtitle.font.size = 14,
    heading.padding = px(8),
    footnotes.padding = px(6)
  ) %>%
  tab_source_note(
    source_note = md("**Fuente:** Elaboración propia con base en World Bank (2023)")
  )

tabla_estadisticas
estadisticas_por_cluster <- NuevaBase %>%
  group_by(Cluster) %>%
  summarise(across(
    where(is.numeric),
    list(
      Media = ~mean(., na.rm = TRUE)
    ),
    .names = "{.col}_{.fn}"
  ))

# Convertir a formato largo
estadisticas_largas <- estadisticas_por_cluster %>%
  pivot_longer(
    cols = -Cluster,
    names_to = "Variable_Estadistica",
    values_to = "Valor"
  ) %>%
  mutate(
    # Extraer la parte después del último guión bajo
    Estadistica = str_extract(Variable_Estadistica, "[^_]+$"),
    # Extraer todo antes del último guión bajo
    Variable = str_remove(Variable_Estadistica, "_[^_]+$"),
    Valor = as.numeric(Valor)
  ) %>%
  select(-Variable_Estadistica)

# Definir los nombres descriptivos de las variables
nombres_variables <- c(
  "PIB_per" = "PIB per cápita (US$)",
  "Poblacion" = "Población total",
  "Esperanza.vida" = "Esperanza de vida (años)",
  "Acceso.electricidad" = "Acceso electricidad (%)",
  "Area.boscosa" = "Área boscosa (%)",
  "Suscripciones.movil" = "Suscripciones móviles",
  "Crecimiento.PIB" = "Crecimiento PIB (%)",
  "Mortalidad.infantil" = "Mortalidad infantil",
  "Inversion.extranjera" = "Inversión extranjera (%)",
  "Gasto.salud" = "Gasto en salud (%)",
  "Uso.internet" = "Uso de internet (%)",
  "Importaciones" = "Importaciones (%)",
  "Exportaciones" = "Exportaciones (%)",
  "Tierra.cultivable" = "Tierra cultivable (%)",
  "Crecimiento.poblacion" = "Crecimiento población (%)",
  "Industria" = "Industria (%)",
  "Remesas" = "Remesas (%)"
)

tabla_estadisticas_mejorada <- estadisticas_largas %>%
  filter(Estadistica == "Media") %>%
  mutate(
    Variable_Descriptiva = nombres_variables[Variable],
    Cluster = paste("Cluster", Cluster),
    Valor = round(Valor, 2)
  ) %>%
  select(Cluster, Variable_Descriptiva, Valor) %>%
  pivot_wider(
    names_from = Cluster,
    values_from = Valor
  ) %>%
  arrange(Variable_Descriptiva) %>%
  gt() %>%
  tab_header(
    title = md("**COMPARACIÓN DE CLUSTERS - MEDIAS POR VARIABLE**"),
    subtitle = "Análisis comparativo de las medias de cada variable entre clusters"
  ) %>%
  cols_label(
    Variable_Descriptiva = md("**Variable**")
  ) %>%
  cols_align(
    align = "center",
    columns = -Variable_Descriptiva
  ) %>%
  cols_align(
    align = "left",
    columns = Variable_Descriptiva
  ) %>%
  fmt_number(
    columns = -Variable_Descriptiva,
    decimals = 2
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium"),
      cell_fill(color = "white")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "black",
      weight = px(1)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "gray80",
      weight = px(1)
    ),
    locations = cells_body(columns = Variable_Descriptiva)
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = Variable_Descriptiva)
  )  %>%
  tab_options(
    table.font.names = "Times New Roman",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "none",
    column_labels.border.bottom.width = px(2),
    column_labels.border.bottom.color = "black",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    data_row.padding = px(6),
    heading.title.font.size = 16,
    heading.subtitle.font.size = 14,
    heading.padding = px(8)
  ) %>%
  tab_source_note(
    source_note = md("**Nota:** Colores indican valores relativos - verde para valores altos, rosa para valores bajos")
  )

# Mostrar tabla principal
tabla_estadisticas_mejorada

```

#### Cluster 1: Desarrollo Humano Avanzado y Conectividad Digital Consolidada

Perfil de variables: Cluster 1 se caracteriza por valores extremadamente altos en indicadores de desarrollo humano e infraestructura. Acceso a electricidad alcanza 99.16%, reflejando electrificación universal que define economías desarrolladas. Esperanza de vida promedio es 77.44 años, el nivel más alto entre los tres clusters, indicando sistemas sanitarios consolidados, nutrición adecuada, y estabilidad sociopolítica. Uso de internet es 86.05%, el más elevado, confirmando que la conectividad digital es característica definitoria de este grupo. Mortalidad infantil es apenas 7.85 por 1,000 nacidos vivos, la más baja, reflejando que sistemas de salud materno-infantil funcionan eficientemente. PIB per cápita promedio es \$26,489.97 USD, demostrando riqueza económica consolidada.

Simultáneamente, Cluster 1 muestra características económicas de economías maduras y globalizadas: exportaciones representan 55.30% del PIB (comercio orientado externamente), importaciones 54.55%, indicando que estos países son hubs comerciales internacionales. Crecimiento del PIB es 5.12% (moderado pero positivo), sugiriendo expansión económica sostenida. Industria representa 28.53% del PIB, confirmando que aunque estas economías son postindustriales (basadas en servicios), mantienen capacidad manufacturera significativa. Inversión extranjera directa es 5.08% del PIB, indicando que son destinos atractivos para capitales internacionales. Gasto en salud es 7.62% del PIB, el más alto, validando inversión sustancial en sistemas de salud universales. Crecimiento poblacional es apenas 0.73% anual, reflejando que han completado transiciones demográficas con poblaciones envejecidas.

Composición de países: Incluye principalmente naciones europeas desarrolladas (Alemania, Francia, Italia, España, Reino Unido, Suecia, Dinamarca, Finlandia, Noruega, Países Bajos), naciones norteamericanas (Estados Unidos, Canadá), economías asiáticas avanzadas (Japón, Corea del Sur, Singapur, Hong Kong), y destinos de desarrollo consolidado (Australia, Nueva Zelanda, Israel). La predominancia de economías OCDE valida que Cluster 1 captura efectivamente el grupo de desarrollo ultra-avanzado global (Banco Mundial, 2023).

#### Cluster 2: Desarrollo Intermedio Heterogéneo con Vulnerabilidades Persistentes

Perfil de variables: Cluster 2 representa el grupo de países con desarrollo humano intermedio pero altamente heterogéneo internamente. Esperanza de vida promedio es 64.29 años, sustancialmente menor que Cluster 1 (13 años de diferencia), pero superior a Cluster 3, indicando que estos países han logrado avances en salud básica pero enfrentan desafíos significativos. Acceso a electricidad es 54.59%, apenas por encima de la mitad, reflejando que la electrificación es incompleta especialmente en zonas rurales. Uso de internet es 35.04%, menos de la mitad de Cluster 1, confirmando que brecha digital es significativa. Mortalidad infantil es 40.97 por 1,000, aproximadamente 5 veces mayor que Cluster 1, indicando que sistemas de salud materno-infantil enfrentan capacidades limitadas.

PIB per cápita promedio es \$1,578.46 USD, dramáticamente menor que Cluster 1 (95% de diferencia), confirmando que estos son países de ingresos medios bajos a medios. Crecimiento poblacional es 2.31% anual, significativamente más alto que Cluster 1, reflejando que están en transiciones demográficas incompletas donde natalidad sigue siendo elevada. Remesas recibidas representan 4.94% del PIB, indicando dependencia moderada de transferencias de migrantes. Inversión extranjera es 3.65% del PIB (inferior a Cluster 1), sugiriendo que son menos atractivos para capitales internacionales. Gasto en salud es 5.10% del PIB (menor que Cluster 1), limitando recursos disponibles para sistemas de salud.

Heterogeneidad interna: Este cluster contiene gran variación: desde países con desarrollo relativamente avanzado (México \~\$9,500 PIB per cápita, esperanza de vida \~75 años) hasta países con rezago moderado (Kenia, Ghana, Nigeria con esperanza de vida \~65 años). Tierra cultivable es 20.60%, la más alta entre clusters, reflejando que muchos son economías donde agricultura sigue siendo importante. Suscripciones móviles son 91.59 por cada 100 habitantes, indicando penetración de tecnología móvil como vector de inclusión financiera y digital.

Composición de países: Incluye principalmente economías latinoamericanas emergentes (Brasil, México, Colombia, Argentina, Chile, Uruguay, Perú), economías asiáticas en transición (Vietnam, Tailandia, Indonesia, Filipinas, India en su mayoría), economías africanas moderadamente desarrolladas (Botswana, Mauricio, Sudáfrica), y países del Oriente Medio con ingresos medios (Turquía, Jordania, Líbano). La diversidad geográfica y económica confirma que Cluster 2 captura un espectro amplio de naciones en estado intermedio de desarrollo (Banco Mundial, 2023; PNUD, 2023).

#### Cluster 3: Rezago Extremo y Vulnerabilidad Multidimensional

Perfil de variables: Cluster 3 representa el grupo de rezago humano y económico extremo. Esperanza de vida promedio es apenas 71.59 años, superior a Cluster 2 en cifra pero esta cifra es engañosa porque oculta volatilidad extrema: mientras algunos países tienen \~75 años, otros tienen \~55-58 años, y mortalidad adulta es severamente elevada por VIH, conflictos armados, y enfermedades tropicales. Acceso a electricidad es 96.42%, aparentemente alto, pero esta cifra promedio se distorsiona por algunos países con cobertura urbana buena; zonas rurales en muchos países están completamente sin electricidad.

Mortalidad infantil es 18.11 por 1,000, intermedia entre Cluster 1 (7.85) y Cluster 2 (40.97), sugiriendo que este cluster, aunque llamado "rezago", contiene algunos países que han logrado mejoras en salud infantil. Uso de internet es 61.08%, sorprendentemente alto comparado con Cluster 2 (35.04%), pero se explica porque algunos países han adoptado tecnología móvil massivamente sin infraestructura de electricidad o salud consolidada. PIB per cápita es \$3,776.68 USD, intermedio entre Cluster 2 (\$1,578) y Cluster 1 (\$26,489), contradictorio con la caracterización de "rezago extremo", pero refleja que algunos países tienen petróleo (Angola) o recursos (Zambia) que generan ingresos nominales sin beneficios distributivos amplios.

Crecimiento poblacional es 0.79% anual, el más bajo entre clusters, indicando que están completando transiciones demográficas pero desde bases de desarrollo muy rezagadas. Remesas recibidas son 22.09% del PIB, el porcentaje más alto, reflejando que economías están severamente dependientes de transferencias de diásporas en exterior. Gasto en salud es 7.44% del PIB (similar a Cluster 1), pero esta cifra es engañosa porque presupuestos limitados resultan en servicios muy deficientes. Tierra cultivable es 15.21%, indicando que agricultura es importante pero infraestructura agrícola y productividad están severamente limitadas.

La paradoja de Cluster 3: A primera vista, algunas métricas (esperanza de vida 71.59, acceso electricidad 96.42, gasto salud 7.44%) parecen intermedias, no rezagadas. Esto refleja que el cluster contiene mezcla heterogénea: países como Angola (productor petrolero con ingresos altos nominales pero servicios colapsados) coexisten con países como Etiopía o Uganda. La vulnerabilidad real radica en fragilidad institucional, volatilidad, dependencia de remesas (22.09% vs. 2.47% en Cluster 1), y que indicadores altos coexisten con servicios públicos disfuncionales (Banco Mundial, 2023).

### Segmentacion de paises

Plano PC1-PC2 (Desarrollo Humano vs. Modelo Económico-Institucional): El gráfico PC1-PC2 muestra la distribución de clusters en el plano que explica la mayor proporción de varianza (37.8% combinada). El Cluster 1 (puntos rojos) se concentra predominantemente en el cuadrante central-derecho y ligeramente disperso verticalmente, reflejando que estos países comparten desarrollo humano avanzado (PC1 positivo moderado a alto) pero varían en estructura económica institucional (PC2 desde -4 hasta +4). Países con PC2 extremadamente negativo (como Qatar, Kuwait) representan economías petroleras industrializadas; países con PC2 cercano a cero representan economías postindustriales diversificadas europeas; países con PC2 ligeramente positivo representan economías con gasto social elevado.

```{r clusters con componentes}
coordenadas_pca <- as.data.frame(resultado_ACP$dudi$li[, 1:4])
distancias <- dist(coordenadas_pca)
hc <- hclust(distancias, method = "ward.D2")
clusters <- cutree(hc, k = 3)
cluster_df <- data.frame(
  Pais = rownames(coordenadas_pca),
  Dim1 = coordenadas_pca$Axis1,
  Dim2 = coordenadas_pca$Axis2,
  Dim3 = coordenadas_pca$Axis3,
  Dim4 = coordenadas_pca$Axis4,
  Cluster = as.factor(clusters)
)


resumen_clusters <- cluster_df %>%
  group_by(Cluster) %>%
  summarise(
    Cantidad_Paises = n(),
    Porcentaje = round(n() / nrow(cluster_df) * 100, 1),
    Paises_Ejemplo = paste(head(Pais, 5), collapse = ", "),
    .groups = 'drop'
  ) %>%
  gt() %>%
  tab_header(
    title = md("**Resumen de Clusters Identificados**"),
    subtitle = "Agrupamiento jerárquico con método Ward"
  ) %>%
  cols_label(
    Cluster = md("**Cluster**"),
    Cantidad_Paises = md("**N° Países**"),
    Porcentaje = md("**%**"),
    Paises_Ejemplo = md("**Países Representativos**")
  ) %>%
  fmt_number(
    columns = Porcentaje,
    decimals = 1,
    pattern = "{x}%"
  ) %>%
  tab_options(
    table.font.names = "Times New Roman"
  )

resumen_clusters




cluster_plot <- plot_ly(cluster_df,
                        x = ~Dim1, 
                        y = ~Dim2,
                        color = ~Cluster,
                        colors = c("red", "#00AFBB", "#E7B800"),
                        text = ~paste("<b>", Pais, "</b><br>",
                                      "Cluster:", Cluster),
                        type = "scatter",
                        mode = "markers",
                        marker = list(size = 10, opacity = 0.8),
                        hovertemplate = '%{text}<extra></extra>') %>%
  layout(
    title = list(
      text = "<b>Clusters en el Espacio de Componentes Principales</b>",
      font = list(size = 16, color = "#2C5F8D")
    ),
    xaxis = list(title = "Dimensión 1"),
    yaxis = list(title = "Dimensión 2"),
    hovermode = "closest"
  )
cluster_plot
```

El Cluster 2 (puntos azul) se distribuye ampliamente en la región central-derecha del plano, con mayor concentración en PC1 entre +1 y +3 (desarrollo intermedio) y PC2 entre -2 y +2 (diversidad de modelos económicos). Esta dispersión amplia confirma la heterogeneidad interna del Cluster 2: incluye desde países latinoamericanos con desarrollo intermedio hasta economías asiáticas emergentes con distintas trayectorias de industrialización. Algunos países del Cluster 2 con PC1 \>3 se posicionan muy cerca de frontera con Cluster 1, sugiriendo que están en transición hacia desarrollo consolidado.

El Cluster 3 (puntos amarillos) se concentra en la región izquierda del plano (PC1 negativo desde -2 hasta -6), confirmando su posicionamiento en el polo de menor desarrollo humano. Verticalmente, el Cluster 3 muestra dispersión amplia en PC2 (desde -2 hasta +2), reflejando que países en rezago tienen modelos económicos diversos: algunos dependen de remesas (PC2 positivo), otros tienen industria extractiva limitada (PC2 negativo moderado). La separación visual entre Cluster 3 y Clusters 1-2 es clara, con solapamiento mínimo, validando que la segmentación captura diferencias estructurales genuinas.

```{r grafica 2}
cluster_plot1 <- plot_ly(cluster_df,
                        x = ~Dim3, 
                        y = ~Dim4,
                        color = ~Cluster,
                        colors = c("red", "#00AFBB", "#E7B800"),
                        text = ~paste("<b>", Pais, "</b><br>",
                                      "Cluster:", Cluster),
                        type = "scatter",
                        mode = "markers",
                        marker = list(size = 10, opacity = 0.8),
                        hovertemplate = '%{text}<extra></extra>') %>%
  layout(
    title = list(
      text = "<b>Clusters en el Espacio de Componentes Principales</b>",
      font = list(size = 16, color = "#2C5F8D")
    ),
    xaxis = list(title = "Dimensión 3"),
    yaxis = list(title = "Dimensión 4"),
    hovermode = "closest"
  )

cluster_plot1
```

Plano PC3-PC4 (Apertura Comercial vs. Base Territorial): El gráfico PC3-PC4 proyecta países en dimensiones ortogonales que capturan aspectos complementarios. El Cluster 1 (rojo) muestra dispersión muy amplia en PC3 (desde -5 hasta +6), reflejando que desarrollo avanzado no implica modelo comercial único: micro-Estados como Malta, Luxemburgo, Singapur tienen PC3 extremadamente positivo (hiperglobalizados), mientras que economías grandes como Japón, Estados Unidos tienen PC3 cercano a cero (menos abiertos relativamente). En PC4, Cluster 1 varía moderadamente (desde -4 hasta +6), indicando que incluye tanto micro-Estados con territorio limitado (PC4 muy positivo) como países con territorio extenso y recursos naturales diversos.

El Cluster 2 (azul) se concentra en la región central de ambos ejes (PC3 entre -2 y +2, PC4 entre -2 y +2), confirmando que son economías intermedias tanto en apertura comercial como en dotación territorial. Algunos países del Cluster 2 muestran PC3 ligeramente negativo, indicando apertura moderada; otros muestran PC4 positivo, indicando presión demográfica sobre recursos. El Cluster 3 (amarillo) tiene dispersión moderada en PC3 (desde -3 hasta +2) y PC4 (desde -2 hasta +2.5), reflejando variabilidad en estrategias de apertura comercial y uso del suelo entre países en rezago.

```{r Mapa}
world <- ne_countries(scale = "medium", returnclass = "sf")

Base_2022_con_cluster <- Base_2022 %>%
  mutate(Cluster = clusters) %>%  
  select(Codigo, Cluster, Pais)   
Base_con_mapa <- world %>%
  left_join(Base_2022_con_cluster, by = c("iso_a3" = "Codigo")) %>%
  filter(!is.na(Cluster))  

nombres_clusters <- c("1" = "Emergente", "2" = "Desarrollados", "3" = "Subdesarrollado")

pal <- colorFactor(palette = c("#2C5F8D", "#27AE60", "#8E44AD"), 
                   domain = 1:3,
                   na.color = "transparent")

leaflet(Base_con_mapa) %>%
  addTiles() %>%  
  addPolygons(fillColor = ~pal(Cluster), 
              weight = 1, 
              opacity = 1,
              color = "white", 
              fillOpacity = 0.7,
              popup = ~paste("País:", Pais, "<br>Clúster:", nombres_clusters[as.character(Cluster)])) %>%
  addLegend("bottomright", 
            pal = pal, 
            values = ~Cluster,
            title = "Clústeres de Países",
            labFormat = function(type, cuts, p) {
              paste0(nombres_clusters[cuts])
            },
            opacity = 0.8)

```

El mapa mundial con países coloreados según cluster confirma visualmente los patrones geográficos. Europa aparece predominantemente en Cluster 1 (azul oscuro) y parcialmente Cluster 2 (verde), reflejando consolidación de desarrollo en occidente y transición en oriente. América del Norte aparece Cluster 1 (Estados Unidos, Canadá); América Latina aparece mezcla de Cluster 2 (verde: Brasil, México, Argentina, Chile) y algunos Cluster 1 si países caribeños pequeños están incluidos. Asia muestra heterogeneidad extrema: Japón, Corea del Sur en Cluster 1; China, India, Sudeste Asiático en Cluster 2; Asia Sur/Central potencialmente en Cluster 3. África subsahariana aparece predominantemente Cluster 3 (morado/rosa), con casos aislados de Cluster 2 en sur y este (Botswana, Mauricio, Sudáfrica verde). Oceanía muestra Australia-Nueva Zelanda en Cluster 1; islas del Pacífico potencialmente Cluster 2-3.

Esta distribución geográfica valida que desarrollo no es aleatoriamente distribuido sino que presenta patrones espaciales claros asociados con historia económica, instituciones, geografía física, y legados coloniales. La concentración de Cluster 3 en África subsahariana y la consolidación de Cluster 1 en Europa Occidental-América del Norte-Asia Oriental confirma la persistencia de brechas globales estructurales (Banco Mundial, 2023; Acemoglu & Robinson, 2012).

## Resultados e interpretación

### Caracterizacion de los componentes principales

#### Componente Principal 1: "Desarrollo Humano y Conectividad Digital" (24.3% de varianza)

El primer componente principal explica casi un cuarto de toda la variabilidad en desarrollo internacional, capturando la dimensión más fundamental que diferencia a países ricos de pobres. Se define por esperanza de vida (loading: 0.413), uso de internet (0.4126), acceso a electricidad (0.3709) contrapuestos a mortalidad infantil (-0.4083). Estas variables covarían porque todas requieren sistemas de salud consolidados, riqueza económica, infraestructura tecnológica y estabilidad política—es decir, reflejan la capacidad institucional de una sociedad para garantizar bienestar multidimensional. Países que han logrado esperanzas de vida de 80+ años han realizado décadas de inversión en salud pública, educación universal y desarrollo económico; simultáneamente, estos mismos países inevitablemente desarrollaron infraestructuras digitales avanzadas porque sus economías postindustriales dependen de servicios e innovación tecnológica.

San Marino lidera el extremo positivo de PC1 con coordenada 4.609, siendo una micro-república de 34,000 habitantes enclavada en Italia con esperanza de vida de \~85 años, PIB per cápita superior a \$50,000 USD, mortalidad infantil menor a 5 por 1,000, y acceso digital prácticamente universal. Malta (3.608) es otro micro-Estado mediterráneo con esperanza de vida de \~83 años que transitó desde economía agraria a hub financiero y tecnológico. Irlanda (3.457) representa el "milagro celta" que transformó una economía de subsistencia agraria en los 1950s hacia hub tecnológico global con esperanza de vida de \~82 años. Suiza (3.444) y Noruega (2.913) completan el quinteto de élite con sus sistemas de salud universales, educación de calidad, estabilidad política, y economías basadas en servicios financieros, manufactura de precisión, tecnología y recursos petroleros.

En el extremo opuesto, Níger encabeza con coordenada -5.599, siendo un país saheliano sin salida al mar donde 85% del territorio es desierto del Sahara, con esperanza de vida apenas de 62 años, mortalidad infantil de 85 por 1,000, uso de internet inferior a 10%, y acceso a electricidad de apenas 18%. Burundi (-4.797), una pequeña nación densamente poblada devastada por conflictos étnicos, muestra esperanza de vida de 61 años y PIB per cápita de apenas \$270 USD. República Democrática del Congo (-4.619) posee recursos naturales valorados en trillones de dólares pero permanece atrapada en pobreza extrema debido a conflictos armados recurrentes y corrupción sistémica, resultando en esperanza de vida de 60 años, mortalidad infantil de 68 por 1,000, y acceso a electricidad inferior a 20%. Sierra Leona (-4.406) y Madagascar (-4.393) completan este quinteto de vulnerabilidad extrema, compartiendo fragilidad institucional, dependencia de agricultura de subsistencia y sistemas de salud colapsados. La brecha cuantitativa es asombrosa: 30 años de diferencia en esperanza de vida, mortalidad infantil 17 veces mayor, acceso digital multiplicado por 10, y riqueza económica 200 veces inferior entre los extremos (Banco Mundial, 2023; PNUD, 2023).

#### Componente Principal 2: "Modelo Económico-Institucional" (13.5% de varianza)

El segundo componente, ortogonal al primero, captura una dimensión más sutil: la estructura económica independiente del nivel absoluto de riqueza. Se define por industria negativa (-0.5145, cos²: 0.2648), crecimiento poblacional negativo (-0.4365, cos²: 0.1906), contrapuestos a remesas (0.3465, cos²: 0.12), gasto en salud (0.3038, cos²: 0.0923), importaciones (0.2842, cos²: 0.0808) y tierra cultivable (0.2415, cos²: 0.0583). Esta estructura revela un contraste profundo: el extremo negativo representa economías industrializadas maduras que han completado transiciones demográficas con capacidad productiva autónoma; el extremo positivo representa economías pequeñas vulnerables dependientes de transferencias externas de población emigrada.

Qatar encabeza el extremo negativo con coordenada -5.768 como pequeño emirato con población de 2.9 millones (90% migrantes temporales) donde la industria petrolera representa 66% del PIB, generando PIB per cápita de \~\$61,000 USD a través de extracción de gas natural licuado. Kuwait (-5.102) y Arabia Saudita (-4.487) presentan patrones similares de economías extractivas con industria petroquímica representando 50-70% del PIB, crecimiento poblacional controlado artificialmente mediante políticas migratorias restrictivas, y no reciben remesas porque funcionan como exportadores netos de trabajadores. Omán (-4.455) e Iraq (-3.224), a pesar de la inestabilidad que afecta a Iraq, mantienen industria petrolera significativa que define sus estructuras económicas.

En el extremo opuesto, Islas Marshall lideran con coordenada 4.210, siendo micro-nación insular del Pacífico con población de 60,000 habitantes donde casi 30% de los marshaleses viven en Estados Unidos, enviando remesas que representan 15-20% del PIB doméstico. Tonga (3.513), pequeña nación polinesia, tiene aproximadamente 50% de sus ciudadanos viviendo en el exterior, generando remesas que constituyen 40% de su PIB—la proporción más alta del mundo. Moldavia (3.041), antigua república soviética sin salida al mar, es una de las naciones más pobres de Europa donde \~25% de su población trabaja en Rusia o Italia, con remesas representando 16% del PIB como principal fuente de divisas. Samoa (2.898) y Líbano (2.750) completan este grupo dependiente de transferencias externas: Samoa recibe remesas principalmente de Australia y Nueva Zelanda, mientras Líbano, devastado por crisis financiera y explosiones, depende críticamente de remesas de su diáspora global (\~\$7 mil millones anuales, representando 15% del PIB). Este componente revela una paradoja fascinante: no todos los países ricos dependen de industrialización, y no todos los países dependientes de transferencias son pobres—reflejando que distintos modelos institucionales pueden coexistir con diferentes resultados de desarrollo (Banco Mundial, 2023; FMI, 2023).

#### Componente Principal 3: "Integración Comercial Global" (9.1% de varianza)

El tercer componente captura la dimensión de apertura e integración en cadenas globales de valor, definida por importaciones (0.5187, cos²: 0.269), exportaciones (0.5084, cos²: 0.2584), inversión extranjera directa (0.3714, cos²: 0.138) y crecimiento del PIB (0.2562, cos²: 0.0657) positivos, contrapuestos a área boscosa (-0.273, cos²: 0.0745) y población (-0.263, cos²: 0.0692) negativos. Esta estructura refleja que la globalización contemporánea ha permitido que economías pequeñas adopten estrategias de hiperespecialización e hiperaperrura insertándose en nichos de cadenas globales, mientras que economías continentales grandes pueden mantener mayor autosuficiencia porque sus mercados internos masivos absorben la mayor parte de la producción doméstica.

Malta lidera el extremo positivo con la coordenada más extrema de todos los componentes (7.072), siendo archipiélago mediterráneo de 500 km² con 530,000 habitantes donde importaciones representan 120% del PIB y exportaciones 140%, sumando comercio total superior a 260% del PIB. Malta funciona como hub financiero offshore, centro de servicios digitales (iGaming, blockchain), y base logística para comercio regional, con inversión extranjera directa representando \~15% del PIB anualmente. Djibouti (5.246), pequeño país del Cuerno de África sin recursos naturales significativos pero posicionado estratégicamente en el Mar Rojo, maneja 95% del comercio exterior de Etiopía (población: 120 millones sin salida al mar), con importaciones y exportaciones combinadas superando 100% del PIB djiboutiano e ingresos de \~\$200 millones anuales de alquiler de bases militares. San Marino (4.819) e Irlanda (2.588) completan el extremo de hiperglobalización: San Marino con comercio total \>300% PIB, Irlanda como hub tecnológico y farmacéutico con exportaciones \>100% PIB.

En el extremo negativo, China encabeza con coordenada -3.651 a pesar de ser la "fábrica del mundo" y mayor exportador global en términos absolutos (\$3.6 billones USD en 2022), porque su economía es tan masiva (\$17.9 billones USD) que el comercio total representa apenas 37% del PIB. India (-2.453), a pesar de exportaciones de \~\$770 mil millones USD, tiene comercio exterior representando apenas 22% de su PIB de \$3.5 billones. Federación Rusa (-2.560), aunque es gran exportadora de petróleo, gas y armamento, tiene comercio total de \~45% del PIB porque su economía continental es relativamente autárquica. Este componente revela la paradoja fundamental de la globalización: los más globalizados son los más pequeños y vulnerables; los más grandes pueden permitirse mayor independencia comercial (Baldwin, 2016; Rodrik, 2011).

#### Componente Principal 4: "Presión Territorial y Recursos Naturales" (7.5% de varianza)

El cuarto componente captura el trade-off fundamental entre conservación ambiental y expansión agrícola, definido por área boscosa (0.5134, cos²: 0.2635) positiva, contrapuesta a tierra cultivable (-0.5539, cos²: 0.3068) y población (-0.4713, cos²: 0.2221) negativas. El extremo positivo representa países con ecosistemas naturales preservados y baja presión demográfica; el extremo negativo representa países con presión demográfica masiva que ha forzado sacrificar bosques por tierra agrícola para seguridad alimentaria.

Timor-Leste encabeza el extremo positivo con coordenada 3.921, siendo joven nación independiente donde \~70% del territorio es bosque tropical montañoso con agricultura limitada a \~10% debido a escarpado terreno, población pequeña (\~1.3 millones) y presión demográfica moderada. Finlandia (1.736) también en este extremo tiene \~73% de cobertura boscosa boreal, uno de los porcentajes más altos de Europa, con población de apenas 5.5 millones en territorio de 338,000 km². Islas Salomón (2.273) y República del Congo (2.259) tienen cobertura boscosa de \~80% y \~65% respectivamente, manteniéndola debido a baja densidad poblacional relativa.

India lidera el extremo negativo con coordenada -5.813, teniendo 1,400 millones de habitantes en 3.3 millones de km² (densidad: \~420 hab/km²), lo que ha convertido \~60% del territorio en tierra cultivable para arroz, trigo, algodón, caña de azúcar, reduciendo bosques a apenas 23%. China (-3.891) y Bangladesh (-3.049) presentan patrones similares: Bangladesh tiene densidad de \~1,250 hab/km² con \~70% tierra cultivable y bosques reducidos a 11%; China, aunque menos densamente poblada (\~145 hab/km²), tiene 1,400 millones de habitantes que han transformado casi toda tierra disponible en agricultura intensiva. Este componente revela el dilema del desarrollo: presión demográfica extrema obliga sacrificar ecosistemas naturales por seguridad alimentaria; solo países con baja densidad pueden permitirse preservar naturaleza (Banco Mundial, 2023).

```{r caracterizacion }
caracterizacion_componentes <- data.frame(
  Componente = c("PC1", "PC2", "PC3", "PC4"),
  Nombre = c("Desarrollo Humano y Conectividad Digital", 
             "Modelo Económico-Institucional", 
             "Integración Comercial Global", 
             "Presión Territorial y Recursos Naturales"),
  Varianza_Explicada = c("24.3%", "13.5%", "9.1%", "7.5%"),
  Variables_Positivas = c(
    "Esperanza de vida (0.413), Uso de internet (0.4126), Acceso a electricidad (0.3709)",
    "Remesas (0.3465), Gasto en salud (0.3038), Importaciones (0.2842), Tierra cultivable (0.2415)",
    "Importaciones (0.5187), Exportaciones (0.5084), Inversión extranjera (0.3714), Crecimiento PIB (0.2562)",
    "Área boscosa (0.5134)"
  ),
  Variables_Negativas = c(
    "Mortalidad infantil (-0.4083)",
    "Industria (-0.5145), Crecimiento poblacional (-0.4365)",
    "Área boscosa (-0.273), Población (-0.263)",
    "Tierra cultivable (-0.5539), Población (-0.4713)"
  ),
  Interpretación = c(
    "Países desarrollados con alta esperanza de vida, conectividad digital e infraestructura vs países en desarrollo con sistemas sanitarios frágiles",
    "Economías industriales maduras vs economías dependientes de transferencias externas y remesas",
    "Economías pequeñas ultra-abiertas (hubs comerciales) vs economías grandes con mercados internos dominantes",
    "Países con ecosistemas preservados vs países con alta presión agrícola y demográfica"
  )
)

tabla_componentes <- caracterizacion_componentes %>%
  gt() %>%
  tab_header(
    title = md("**Caracterización de Componentes Principales**"),
    subtitle = "Análisis de componentes principales de indicadores de desarrollo global"
  ) %>%
  cols_label(
    Componente = md("**Comp.**"),
    Nombre = md("**Dimensión Identificada**"),
    Varianza_Explicada = md("**% Varianza**"),
    Variables_Positivas = md("**Variables Positivas**"),
    Variables_Negativas = md("**Variables Negativas**"),
    Interpretación = md("**Interpretación Conceptual**")
  ) %>%
  cols_align(
    align = "left",
    columns = everything()
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium"),
      cell_fill(color = "white")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "black",
      weight = px(1)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = c(Componente, Nombre))
  ) %>%
  tab_style(
    style = cell_text(size = "small"),
    locations = cells_body(columns = c(Variables_Positivas, Variables_Negativas, Interpretación))
  ) %>%
  tab_options(
    table.font.names = "Times New Roman",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "none",
    column_labels.border.bottom.width = px(2),
    column_labels.border.bottom.color = "black",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    data_row.padding = px(8),
    heading.title.font.size = 14,
    heading.subtitle.font.size = 12,
    heading.padding = px(4)
  ) %>%
  tab_source_note(
    source_note = md("**Fuente:** Elaboración propia con base en análisis PCA de indicadores globales (Banco Mundial, PNUD, FMI)")
  )

tabla_componentes
```

### Prediccion

Tras construir el modelo ACP con aproximadamente 180 países de entrenamiento, se proyectaron cinco países adicionales (Angola, Belice, Jordania, Luxemburgo, Uruguay) sobre el espacio factorial ya definido. La proyección utiliza las medias y varianzas del conjunto de entrenamiento para estandarizar los nuevos datos, evitando que cambien la estructura de componentes. Se calcularon las coordenadas de estos cinco países en los cuatro primeros componentes principales, cuantificando su posición relativa respecto al espacio multidimensional de desarrollo ya identificado (Hastie et al., 2009).

```{r Prediccion}

Prediccion <- read_csv("f36a5086-3311-4b1a-9f0c-bda5cd4718df_Series - Metadata.csv",
                 show_col_types = FALSE) %>%
  select(
    Pais = `Country Name`,
    Codigo = `Country Code`,
    PIB_per = `GDP per capita (current US$) [NY.GDP.PCAP.CD]`,
    Poblacion = `Population, total [SP.POP.TOTL]`,
    `Esperanza vida` = `Life expectancy at birth, total (years) [SP.DYN.LE00.IN]`,
    `Acceso electricidad` = `Access to electricity (% of population) [EG.ELC.ACCS.ZS]`,
    `Area boscosa` = `Forest area (% of land area) [AG.LND.FRST.ZS]`,
    `Suscripciones movil` = `Mobile cellular subscriptions (per 100 people) [IT.CEL.SETS.P2]`,
    `Crecimiento PIB` = `GDP growth (annual %) [NY.GDP.MKTP.KD.ZG]`,
    `Mortalidad infantil` = `Mortality rate, infant (per 1,000 live births) [SP.DYN.IMRT.IN]`,
    `Inversion extranjera` = `Foreign direct investment, net inflows (% of GDP) [BX.KLT.DINV.WD.GD.ZS]`,
    `Gasto salud` = `Current health expenditure (% of GDP) [SH.XPD.CHEX.GD.ZS]`,
    `Uso internet` = `Individuals using the Internet (% of population) [IT.NET.USER.ZS]`,
    Importaciones = `Imports of goods and services (% of GDP) [NE.IMP.GNFS.ZS]`,
    Exportaciones = `Exports of goods and services (% of GDP) [NE.EXP.GNFS.ZS]`,
    `Tierra cultivable` = `Arable land (% of land area) [AG.LND.ARBL.ZS]`,
    `Crecimiento poblacion` = `Population growth (annual %) [SP.POP.GROW]`,
    Industria = `Industry (including construction), value added (% of GDP) [NV.IND.TOTL.ZS]`,
    Remesas = `Personal remittances, received (% of GDP) [BX.TRF.PWKR.DT.GD.ZS]`
  ) %>%
  filter(Pais %in% c("Uruguay","Belize","Luxembourg","Jordan","Angola"))

ind.test <- Prediccion[, 3:19] %>%
  mutate(across(everything(), as.numeric))


ind.test_clean <- ind.test %>%
  mutate(across(everything(), ~ifelse(is.na(.), mean(., na.rm = TRUE), .)))

ind.test.coord <- predict(res.pca, newdata = ind.test_clean)
coordenadas_paises <- data.frame(
  País = Prediccion$Pais,
  `Código País` = Prediccion$Codigo,
  `Dimensión 1 - Desarrollo Humano` = round(ind.test.coord[, 1], 4),
  `Dimensión 2 - Industrialización` = round(ind.test.coord[, 2], 4),
  `Dimensión 3 - Apertura Comercial` = round(ind.test.coord[, 3], 4),
  `Dimensión 4 - Recursos Naturales` = round(ind.test.coord[, 4], 4)
)


tabla_coordenadas <- coordenadas_paises %>%
  gt() %>%
  tab_header(
    title = md("**Tabla 3: Coordenadas de Países en Componentes Principales**"),
    subtitle = "Proyección de países seleccionados en las cuatro dimensiones del Análisis de Componentes Principales"
  ) %>%
  cols_label(
    País = md("**País**"),
    `Código.País` = md("**Código**"),
    `Dimensión.1...Desarrollo.Humano` = md("**Dimensión 1**"),
    `Dimensión.2...Industrialización` = md("**Dimensión 2**"),
    `Dimensión.3...Apertura.Comercial` = md("**Dimensión 3**"),
    `Dimensión.4...Recursos.Naturales` = md("**Dimensión 4**")
  ) %>%
  cols_align(
    align = "center",
    columns = c(`Dimensión.1...Desarrollo.Humano`, `Dimensión.2...Industrialización`,
                `Dimensión.3...Apertura.Comercial`, `Dimensión.4...Recursos.Naturales`)
  ) %>%
  cols_align(
    align = "left",
    columns = c(País, `Código.País`)
  ) %>%
  tab_style(
    style = list(
      cell_text(weight = "bold", size = "medium"),
      cell_fill(color = "white")
    ),
    locations = cells_column_labels()
  ) %>%
  tab_style(
    style = cell_borders(
      sides = c("top", "bottom"),
      color = "black",
      weight = px(1)
    ),
    locations = list(
      cells_column_labels(),
      cells_body()
    )
  ) %>%
  tab_style(
    style = cell_borders(
      sides = "right",
      color = "gray80",
      weight = px(1)
    ),
    locations = cells_body(columns = c(País, `Código.País`, `Dimensión.1...Desarrollo.Humano`, 
                                       `Dimensión.2...Industrialización`, `Dimensión.3...Apertura.Comercial`))
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = País)
  ) %>%
  tab_style(
    style = cell_text(size = "small"),
    locations = cells_body(columns = c(`Código.País`, `Dimensión.1...Desarrollo.Humano`,
                                       `Dimensión.2...Industrialización`, `Dimensión.3...Apertura.Comercial`,
                                       `Dimensión.4...Recursos.Naturales`))
  ) %>%
  tab_options(
    table.font.names = "Times New Roman",
    table.width = pct(100),
    table.border.top.style = "none",
    table.border.bottom.style = "none",
    column_labels.border.top.style = "none",
    column_labels.border.bottom.width = px(2),
    column_labels.border.bottom.color = "black",
    table_body.border.bottom.style = "none",
    table_body.border.top.style = "none",
    data_row.padding = px(8),
    heading.title.font.size = 14,
    heading.subtitle.font.size = 12,
    heading.padding = px(4),
    footnotes.padding = px(4)
  ) %>%
  tab_source_note(
    source_note = md("**Fuente:** Elaboración propia con base en proyección ACP de indicadores del World Bank (2023)")
  ) %>%
  tab_footnote(
    footnote = "Dimensión 1: Desarrollo Humano y Tecnológico (24.3% varianza) | Dimensión 2: Industrialización y Dinámica Demográfica (13.5% varianza)",
    locations = cells_title(groups = "subtitle")
  ) %>%
  tab_footnote(
    footnote = "Dimensión 3: Apertura e Integración Comercial (9.1% varianza) | Dimensión 4: Base Territorial y Recursos Naturales (7.5% varianza)",
    locations = cells_title(groups = "subtitle")
  )

tabla_coordenadas

library(plotly)
coordenadas_originales <- as.data.frame(res.pca$x)
coordenadas_originales$Pais <- rownames(coordenadas_originales)
coordenadas_originales$Tipo <- "Original"

# Las coordenadas de los países predichos ya están en ind.test.coord
coordenadas_predichas <- as.data.frame(ind.test.coord)
coordenadas_predichas$Pais <- Prediccion$Pais
coordenadas_predichas$Tipo <- "Predicho"

# Renombrar las columnas para que coincidan
colnames(coordenadas_originales)[1:4] <- c("PC1", "PC2", "PC3", "PC4")
colnames(coordenadas_predichas)[1:4] <- c("PC1", "PC2", "PC3", "PC4")

# Combinar los datos
datos_completos <- rbind(
  coordenadas_originales[, c("Pais", "PC1", "PC2", "Tipo","Pais", "PC3", "PC4", "Tipo")],
  coordenadas_predichas[, c("Pais", "PC1", "PC2", "Tipo","Pais", "PC3", "PC4", "Tipo")]
)

# Crear el gráfico plotly SIN nombres visibles
p_animado <- plot_ly() %>%
  
  # Países originales (solo puntos, sin texto)
  add_trace(
    data = datos_completos[datos_completos$Tipo == "Original", ],
    x = ~PC1, y = ~PC2,
    type = 'scatter',
    mode = 'markers',
    marker = list(
      color = 'black',
      size = 8,
      opacity = 0.7,
      line = list(width = 1, color = 'white')
    ),
    name = "Países originales",
    hoverinfo = 'text',
    hovertext = ~paste("<b>", Pais, "</b><br>",
                       "Tipo: Original<br>",
                       "Dimensión 1: ", round(PC1, 3), "<br>",
                       "Dimensión 2: ", round(PC2, 3))
  ) %>%
  
  # Países predichos (solo puntos, sin texto)
  add_trace(
    data = datos_completos[datos_completos$Tipo == "Predicho", ],
    x = ~PC1, y = ~PC2,
    type = 'scatter',
    mode = 'markers',
    marker = list(
      color = 'blue',
      size = 12,
      opacity = 0.8,
      symbol = 'star',
      line = list(width = 1.5, color = 'white')
    ),
    name = "Países predichos",
    hoverinfo = 'text',
    hovertext = ~paste("<b>", Pais, "</b><br>",
                       "Tipo: Predicho<br>",
                       "Dimensión 1: ", round(PC1, 3), "<br>",
                       "Dimensión 2: ", round(PC2, 3)),
    visible = FALSE  # Inicialmente ocultos
  ) %>%
  
  layout(
    title = list(
      text = "<b>PCA - Países originales (negro) y países predichos (azul)</b>",
      x = 0.05,
      font = list(size = 16, color = "#2C5F8D")
    ),
    xaxis = list(
      title = "Dimensión 1 - Desarrollo Humano y Tecnológico (24.3%)",
      zeroline = TRUE,
      zerolinecolor = "gray",
      gridcolor = "lightgray"
    ),
    yaxis = list(
      title = "Dimensión 2 - Modelo Económico-Institucional (13.5%)",
      zeroline = TRUE,
      zerolinecolor = "gray",
      gridcolor = "lightgray"
    ),
    hovermode = "closest",
    plot_bgcolor = "white",
    paper_bgcolor = "white",
    showlegend = TRUE,
    legend = list(
      x = 0.02,
      y = 0.98,
      bgcolor = "rgba(255,255,255,0.8)"
    ),
    annotations = list(
      list(
        x = 0.5,
        y = -0.15,
        text = "● Países originales | ★ Países predichos • Pasa el cursor sobre los puntos para ver información",
        showarrow = FALSE,
        xref = "paper",
        yref = "paper",
        font = list(size = 12, color = "gray")
      )
    )
  ) %>%
  
  # Configurar animación con botones
  layout(
    updatemenus = list(
      list(
        type = "buttons",
        direction = "right",
        x = 0.1,
        y = 1.15,
        buttons = list(
          list(
            method = "update",
            args = list(
              list(visible = c(TRUE, FALSE)),
              list(title = "PCA - Solo países originales")
            ),
            label = "Solo Originales"
          ),
          list(
            method = "update",
            args = list(
              list(visible = c(TRUE, TRUE)),
              list(title = "PCA - Países originales (negro) y países predichos (azul)")
            ),
            label = "Mostrar Predichos"
          )
        )
      )
    )
  )

p_animado

p_animado1 <- plot_ly() %>%
  add_trace(
    data = datos_completos[datos_completos$Tipo == "Original", ],
    x = ~PC3, y = ~PC4,
    type = 'scatter',
    mode = 'markers',
    marker = list(
      color = 'black',
      size = 8,
      opacity = 0.7,
      line = list(width = 1, color = 'white')
    ),
    name = "Países originales",
    hoverinfo = 'text',
    hovertext = ~paste("<b>", Pais, "</b><br>",
                       "Tipo: Original<br>",
                       "Dimensión 3: ", round(PC3, 3), "<br>",
                       "Dimensión 4: ", round(PC4, 3))
  ) %>%
  add_trace(
    data = datos_completos[datos_completos$Tipo == "Predicho", ],
    x = ~PC3, y = ~PC4,
    type = 'scatter',
    mode = 'markers',
    marker = list(
      color = 'blue',
      size = 12,
      opacity = 0.8,
      symbol = 'star',
      line = list(width = 1.5, color = 'white')
    ),
    name = "Países predichos",
    hoverinfo = 'text',
    hovertext = ~paste("<b>", Pais, "</b><br>",
                       "Tipo: Predicho<br>",
                       "Dimensión 3: ", round(PC3, 3), "<br>",
                       "Dimensión 4: ", round(PC4, 3)),
    visible = FALSE 
  ) %>%
  
  layout(
    title = list(
      text = "<b>PCA - Países originales (negro) y países predichos (azul)</b>",
      x = 0.05,
      font = list(size = 16, color = "#2C5F8D")
    ),
    xaxis = list(
      title = "Dimensión 1 - Desarrollo Humano y Tecnológico (24.3%)",
      zeroline = TRUE,
      zerolinecolor = "gray",
      gridcolor = "lightgray"
    ),
    yaxis = list(
      title = "Dimensión 2 - Modelo Económico-Institucional (13.5%)",
      zeroline = TRUE,
      zerolinecolor = "gray",
      gridcolor = "lightgray"
    ),
    hovermode = "closest",
    plot_bgcolor = "white",
    paper_bgcolor = "white",
    showlegend = TRUE,
    legend = list(
      x = 0.02,
      y = 0.98,
      bgcolor = "rgba(255,255,255,0.8)"
    ),
    annotations = list(
      list(
        x = 0.5,
        y = -0.15,
        text = "● Países originales | ★ Países predichos • Pasa el cursor sobre los puntos para ver información",
        showarrow = FALSE,
        xref = "paper",
        yref = "paper",
        font = list(size = 12, color = "gray")
      )
    )
  ) %>%
  
  # Configurar animación con botones
  layout(
    updatemenus = list(
      list(
        type = "buttons",
        direction = "right",
        x = 0.1,
        y = 1.15,
        buttons = list(
          list(
            method = "update",
            args = list(
              list(visible = c(TRUE, FALSE)),
              list(title = "PCA - Solo países originales")
            ),
            label = "Solo Originales"
          ),
          list(
            method = "update",
            args = list(
              list(visible = c(TRUE, TRUE)),
              list(title = "PCA - Países originales (negro) y países predichos (azul)")
            ),
            label = "Mostrar Predichos"
          )
        )
      )
    )
  )


# Mostrar el gráfico
p_animado1

```

Luxemburgo obtiene coordenada 2.9075 en PC1 (desarrollo extremo), junto a San Marino en la élite ultra-desarrollada, confirmando su posición como micro-Estado financiero con esperanza de vida de 85 años e hiperconectividad digital. Uruguay (1.4145 en PC1) se posiciona como país emergente latinoamericano con desarrollo humano consolidado. Jordania (0.1673) y Belice (-0.4472) son casos intermedios de ingresos medios con vulnerabilidades persistentes. Angola (-3.6127) lidera el rezago extremo, caracterizada por baja esperanza de vida (61 años), alta mortalidad infantil (56 por 1,000) y acceso limitado a servicios. En Dimensión 2, Luxemburgo (-1.0540) representa industrialización postindustrial consolidada; Angola (-1.7126) representa industrialización petroquímica sin beneficios distributivos. En Dimensión 3, Luxemburgo (-7.6090) es hiperglobalizado (comercio \>300% PIB); Angola (-0.1232) es básicamente cerrada con dependencia petrolera. En Dimensión 4, Luxemburgo (4.9379) tiene escasa presión demográfica; Angola (1.7885) tiene tierra cultivable disponible pero sin transformación agrícola.

# Concluciones

El principal hallazgo es que el desarrollo mundial no funciona de manera lineal ni se puede reducir a una sola característica. Por el contrario, existe un orden invisible que organiza a los países según cuatro dimensiones principales que explican más de la mitad de las diferencias que observamos entre ellos.

Estas cuatro dimensiones son: primero, acceso a salud, educación y tecnología (esperanza de vida, acceso a internet, mortalidad infantil); segundo, tipo de economía que tiene cada país (si depende del petróleo, de la agricultura o de múltiples industrias); tercero, qué tan abierto está el país al comercio internacional; y cuarto, el equilibrio entre población y naturaleza (cuántos bosques quedan, cuánta presión hay sobre los recursos naturales).

El análisis identificó tres grupos claros de países: un grupo de países ricos con indicadores muy buenos en salud, educación y tecnología (Europa, América del Norte, Japón, Corea del Sur); un grupo intermedio de países emergentes que están mejorando pero aún tienen brechas (Brasil, México, Tailandia, Sudáfrica); y un tercer grupo de países con desafíos estructurales profundos, principalmente en África, donde la salud, educación y acceso a tecnología aún son limitados.

Sí, el análisis permitió identificar patrones claros y sorprendentes. Lo más importante es que estos patrones no siguen las líneas geográficas que esperaríamos. Por ejemplo, Uruguay (en Sudamérica) se parece más a países europeos del este como Polonia en cómo está organizado su desarrollo, mientras que Vietnam (en Asia) comparte características similares con Colombia (en Sudamérica). Esto muestra que la geografía no es destino.

Un caso muy revelador es Costa Rica: este país tiene una esperanza de vida de 80 años (igual que Alemania o Japón), pero su PIB per cápita es mucho menor. ¿Cómo es posible? Porque Costa Rica invirtió fuertemente en salud y educación pública aunque no fuera el país más rico. Esto demuestra que no hay una única forma de desarrollarse. Algunos países ricos lo lograron por industria, otros por finanzas, otros por turismo y agricultura sostenible.

También descubrimos que algunos países aparentemente exitosos (como Qatar) tienen una fragilidad oculta: sus economías dependen casi completamente del petróleo. Cuando bajan los precios del petróleo, estos países se hunden. En cambio, países como Singapur o Corea del Sur diversificaron sus economías y por eso son más estables.

El patrón fundamental que emerge es que los países que logran buen desarrollo son aquellos que invierten simultáneamente en tres cosas: salud, educación, y diversificación económica. Puede hacerse en diferentes órdenes y con diferentes estrategias, pero estos tres pilares aparecen una y otra vez en los países exitosos del análisis.

Este tipo de análisis tiene aplicaciones concretas y muy prácticas para los gobiernos y organismos internacionales:

Primero, diseñar políticas adaptadas a cada tipo de país. En lugar de que organismos como el Banco Mundial digan a todos los países lo mismo (por ejemplo "reduzcan el gasto público"), podrían identificar qué tipo de problema tiene cada país específicamente y diseñar soluciones adaptadas. Un país con crisis de salud infantil necesita expandir hospitales, no reducir gasto. Un país que depende solo del petróleo necesita crear nuevas industrias, no seguir extrayendo más petróleo

Segundo, aprender de pares exitosos en tu propia situación. Si Bolivia quiere mejorar su sistema de salud, en lugar de escuchar a expertos europeos, podría estudiar cómo Costa Rica o Cuba lo hicieron con presupuestos similares. Si Sudáfrica quiere reducir la corrupción, podría aprender de Uruguay que lo logró en contexto latinoamericano similar. Este tipo de aprendizaje entre pares funciona mejor que imposiciones externas.

Tercero, identificar riesgos ocultos antes de que se conviertan en crisis. Los gobiernos y bancos multilaterales podrían usar este análisis para detectar que un país se está volviendo muy dependiente de una sola industria, o que aunque tenga números macroeconómicos buenos, su sistema de salud se está colapsando. Con esta información temprana, podrían actuar preventivamente.

Cuarto, priorizar inversiones de forma inteligente. Cuando un país tiene presupuesto limitado, necesita saber dónde invertir para obtener máximos beneficios. Este análisis muestra que invertir en educación y salud simultáneamente genera un efecto multiplicador: gente más sana estudia mejor, gente educada hace mejores decisiones sobre salud. Así que gastar en ambas cosas a la vez genera más impacto que gastar en una sola.

Quinto, monitorear el progreso hacia objetivos globales. Las Naciones Unidas tienen un conjunto de 17 Objetivos de Desarrollo Sostenible que todos los países deberían alcanzar (acabar pobreza, garantizar salud, educación, etc.). Este análisis permite ver objetivamente si un país está avanzando hacia estos objetivos o se está alejando, y cuáles son sus mayores brechas comparado con países similares.


En conclusión, este ejercicio académico prueba que el desarrollo de las naciones es un fenómeno complejo que requiere análisis sofisticados, pero una vez que lo entendemos, podemos actuar de manera mucho más efectiva. No existe una sola receta para el éxito, pero sí existen patrones que se repiten. Los países que tienen éxito son los que invierten equilibradamente en su gente (salud y educación), diversifican su economía, y toman decisiones conscientes sobre cuánto comerciar con el mundo y cómo proteger su ambiente.

Para gobiernos, este análisis es útil porque les muestra en qué están bien y en qué deben mejorar comparados con países similares. Para organismos internacionales, es útil porque permite diseñar ayuda realmente adaptada a necesidades específicas. Y para la sociedad en general, es útil porque explica por qué algunos países prosperan y otros no—no es misterio ni destino, sino resultado de decisiones políticas concretas que otros países ya han tomado exitosamente.

# Bibliografia

Acemoglu, D., & Robinson, J. A. (2012). Why nations fail: The origins of power, prosperity, and poverty. Crown Publishers.

Agencia Presidencial de Cooperación Internacional de Colombia. (2023). Estrategia Nacional de Cooperación Internacional. https://www.apccolombia.gov.co

Andini, M., Ciani, E., de Blasio, G., D'Ignazio, A., & Salvestrini, V. (2018a). Targeting with machine learning: An application to a tax rebate program in Italy. Journal of Economic Behavior & Organization, 156, 86-102.

Andini, M., Ciani, E., de Blasio, G., D'Ignazio, A., & Salvestrini, V. (2018b). Targeting policy with machine learning. VoxEU CEPR. https://voxeu.org/article/targeting-policy-machine-learning

ArcGIS. (2024). Distancia euclidiana: Cómo funciona. Environmental Systems Research Institute. https://pro.arcgis.com

Athey, S. (2017). Beyond prediction: Using big data for policy problems. Science, 355(6324), 483-485.

Athey, S., & Imbens, G. W. (2016). Recursive partitioning for heterogeneous causal effects. Proceedings of the National Academy of Sciences, 113(27), 7353-7360.

Banco Interamericano de Desarrollo. (2022). Informe macroeconómico de América Latina y el Caribe 2022: El sendero hacia la recuperación. BID.

Banco Mundial. (2022). Perspectivas económicas mundiales 2022: Crisis superpuestas. Grupo Banco Mundial.

Behar, A., & Mok, J. (2024). The World Development Indicators database: Structure, coverage, and quality assurance. World Bank Technical Paper.

Brookings Institution. (2016). Making sense of clusters: Regional competitiveness and economic development. Metropolitan Policy Program.

Centro de Documentación de Barcelona. (2022). Economía global 2022: Perspectivas post-pandemia. CIDOB.

Cervellati, M., Esposito, E., Sunde, U., & Valmori, S. (2022). Long-term growth and demographic change. CEPR Discussion Paper, DP17385.

Charrad, M., Ghazzali, N., Boiteau, V., & Niknafs, A. (2014). NbClust: An R package for determining the relevant number of clusters in a data set. Journal of Statistical Software, 61(6), 1-36.

Ciencia de Datos. (2016). Estandarización de variables: Importancia en machine learning. https://www.cienciadedatos.net

Comisión Económica para América Latina y el Caribe. (2023). Balance preliminar de las economías de América Latina y el Caribe 2023. CEPAL.

European Central Bank. (2018). Foreign direct investment and economic growth. ECB Economic Bulletin, Issue 4/2018.

Fondo Monetario Internacional. (2023). Perspectivas de la economía mundial: Resiliencia en tiempos de incertidumbre. FMI.

Fritz, M., & Koch, M. (2016). Economic development and prosperity patterns around the world: Structural challenges for a global steady-state economy. Global Environmental Change, 38, 41-48.

Hastie, T., Tibshirani, R., & Friedman, J. (2009). The elements of statistical learning: Data mining, inference, and prediction (2nd ed.). Springer.

Hidalgo, C. A. (2022). The policy implications of economic complexity. arXiv preprint arXiv:2205.02164.

Jeanty, P. W. (2010). A guide to interpreting the World Development Indicators. World Bank Data Group Working Paper.

Jolliffe, I. T. (2002). Principal component analysis (2nd ed.). Springer.

KeepCoding. (2025). ¿Qué es el análisis de componentes principales (PCA)? https://keepcoding.io/blog/que-es-pca/

Kim, Y. K. (2017). Patterns of economic development: Correlations affecting economic growth. Korean Journal of Policy Studies, 32(2), 1-24.

Kleinberg, J., Ludwig, J., Mullainathan, S., & Obermeyer, Z. (2015). Prediction policy problems. American Economic Review, 105(5), 491-495.

LinkedIn Learning. (2023). Estandarización y normalización en análisis de datos. https://www.linkedin.com/learning

Mullainathan, S., & Spiess, J. (2017). Machine learning: An applied econometric approach. Journal of Economic Perspectives, 31(2), 87-106.

OpenWebinars. (2025). Tutorial de análisis de componentes principales en R. https://openwebinars.net

Organización para la Cooperación y el Desarrollo Económicos. (2024). Health at a Glance 2024: OECD indicators. OECD Publishing.

Piketty, T. (2022). Una breve historia de la igualdad. Editorial Planeta.

Programa de las Naciones Unidas para el Desarrollo. (2023). Informe sobre Desarrollo Humano 2023-2024. PNUD.

Sachs, J. D., Lafortune, G., Fuller, G., & Drumm, E. (2022). Sustainable Development Report 2022. Cambridge University Press.

Saraiva, M. V., Ferreira, F. A., Pais, M. C., & Ferreira, N. C. (2025). Clustering analysis on Sustainable Development Goal indicators for forty-five Asian countries. Sustainability, 15(7), 5728.

Shkolnikov, V. M., Andreev, E. M., McKee, M., & Leon, D. A. (2019). Components and possible determinants of the decrease in Russian mortality in 2004-2010. Demographic Research, 28, 917-950.

TIBCO Software. (2024). Ward's hierarchical clustering method. Statistica Documentation. https://docs.tibco.com

Conferencia de las Naciones Unidas sobre Comercio y Desarrollo. (2021). Technology and Innovation Report 2021: Catching technological waves. UNCTAD.

Universidad de Granada. (2016). Medidas de similitud y distancia en análisis multivariante. Departamento de Estadística e Investigación Operativa.

Ward, J. H. (1963). Hierarchical grouping to optimize an objective function. Journal of the American Statistical Association, 58(301), 236-244.

Wikipedia. (2013). Ward's method. https://en.wikipedia.org/wiki/Ward%27s_method

Wolman, H., & Hincapie, D. (2014). Clusters and cluster-based development policy. Economic Development Quarterly, 29(2), 135-149.

World Bank. (2015). World Development Report 2015: Mind, society, and behavior. World Bank Publications.

World Bank. (2019). World Development Indicators: Methodology and compilation practices. World Bank Data Group.

World Bank. (2023). World Development Indicators 2023. World Bank Open Data. https://data.worldbank.org

World Health Organization. (2020). World Health Statistics 2020: Monitoring health for the SDGs. WHO Press.